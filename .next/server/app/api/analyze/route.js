"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/analyze/route";
exports.ids = ["app/api/analyze/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "node:url":
/*!***************************!*\
  !*** external "node:url" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("node:url");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5Cmercy%5CTOOL%5Cwallet-sentinel%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmercy%5CTOOL%5Cwallet-sentinel&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5Cmercy%5CTOOL%5Cwallet-sentinel%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmercy%5CTOOL%5Cwallet-sentinel&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_mercy_TOOL_wallet_sentinel_src_app_api_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/analyze/route.ts */ \"(rsc)/./src/app/api/analyze/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/analyze/route\",\n        pathname: \"/api/analyze\",\n        filename: \"route\",\n        bundlePath: \"app/api/analyze/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\mercy\\\\TOOL\\\\wallet-sentinel\\\\src\\\\app\\\\api\\\\analyze\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_mercy_TOOL_wallet_sentinel_src_app_api_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/analyze/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhbmFseXplJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhbmFseXplJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYW5hbHl6ZSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNtZXJjeSU1Q1RPT0wlNUN3YWxsZXQtc2VudGluZWwlNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q21lcmN5JTVDVE9PTCU1Q3dhbGxldC1zZW50aW5lbCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUI7QUFDdEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93YWxsZXQtc2VudGluZWwvPzkwMGIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcbWVyY3lcXFxcVE9PTFxcXFx3YWxsZXQtc2VudGluZWxcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYW5hbHl6ZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYW5hbHl6ZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FuYWx5emVcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2FuYWx5emUvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxtZXJjeVxcXFxUT09MXFxcXHdhbGxldC1zZW50aW5lbFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhbmFseXplXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hbmFseXplL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5Cmercy%5CTOOL%5Cwallet-sentinel%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmercy%5CTOOL%5Cwallet-sentinel&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/analyze/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/analyze/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_analyzers_evm_analyzer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/analyzers/evm-analyzer */ \"(rsc)/./src/lib/analyzers/evm-analyzer.ts\");\n/* harmony import */ var _lib_analyzers_solana_analyzer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/analyzers/solana-analyzer */ \"(rsc)/./src/lib/analyzers/solana-analyzer.ts\");\n// ============================================\n// WALLET ANALYSIS API ENDPOINT\n// ============================================\n// POST /api/analyze\n// Analyzes a wallet address for security threats.\n// All operations are READ-ONLY and defensive.\n\n\n\n// Rate limiting (simple in-memory implementation)\nconst requestCounts = new Map();\nconst RATE_LIMIT = 20; // requests per minute\nconst RATE_WINDOW = 60000; // 1 minute in ms\nfunction isRateLimited(ip) {\n    const now = Date.now();\n    const record = requestCounts.get(ip);\n    if (!record || now > record.resetTime) {\n        requestCounts.set(ip, {\n            count: 1,\n            resetTime: now + RATE_WINDOW\n        });\n        return false;\n    }\n    if (record.count >= RATE_LIMIT) {\n        return true;\n    }\n    record.count++;\n    return false;\n}\n// Validate chain parameter\nfunction isValidChain(chain) {\n    return [\n        \"ethereum\",\n        \"base\",\n        \"bnb\",\n        \"solana\"\n    ].includes(chain);\n}\n// Validate EVM address format\nfunction isValidEvmAddress(address) {\n    return /^0x[a-fA-F0-9]{40}$/.test(address);\n}\n// Validate Solana address format\nfunction isValidSolanaAddress(address) {\n    return /^[1-9A-HJ-NP-Za-km-z]{32,44}$/.test(address);\n}\n// Validate address format based on chain\nfunction isValidAddress(address, chain) {\n    if (chain === \"solana\") {\n        return isValidSolanaAddress(address);\n    }\n    return isValidEvmAddress(address);\n}\nasync function POST(request) {\n    const startTime = Date.now();\n    try {\n        // Get client IP for rate limiting\n        const ip = request.headers.get(\"x-forwarded-for\") || request.headers.get(\"x-real-ip\") || \"unknown\";\n        if (isRateLimited(ip)) {\n            console.log(`[RATE_LIMITED] IP: ${ip}`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    code: \"RATE_LIMITED\",\n                    message: \"Too many requests. Please wait a moment and try again.\"\n                },\n                timestamp: new Date().toISOString()\n            }, {\n                status: 429\n            });\n        }\n        // Parse request body\n        let body;\n        try {\n            body = await request.json();\n        } catch  {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    code: \"INVALID_JSON\",\n                    message: \"Invalid request body\"\n                },\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        const { address, chain } = body;\n        // Validate inputs\n        if (!address || typeof address !== \"string\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    code: \"INVALID_ADDRESS\",\n                    message: \"Wallet address is required\"\n                },\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        if (!chain || !isValidChain(chain)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    code: \"INVALID_CHAIN\",\n                    message: \"Valid chain is required (ethereum, base, bnb, solana)\"\n                },\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        const trimmedAddress = address.trim();\n        if (!isValidAddress(trimmedAddress, chain)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    code: \"INVALID_ADDRESS_FORMAT\",\n                    message: `Invalid ${chain} address format. ${chain === \"solana\" ? \"Solana addresses are base58 encoded.\" : \"EVM addresses start with 0x followed by 40 hex characters.\"}`\n                },\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        console.log(`[ANALYZE] Starting analysis for ${trimmedAddress} on ${chain}`);\n        // Perform analysis\n        let result;\n        try {\n            if (chain === \"solana\") {\n                const analyzer = new _lib_analyzers_solana_analyzer__WEBPACK_IMPORTED_MODULE_2__.SolanaAnalyzer();\n                result = await analyzer.analyzeWallet(trimmedAddress);\n            } else {\n                const analyzer = new _lib_analyzers_evm_analyzer__WEBPACK_IMPORTED_MODULE_1__.EVMAnalyzer(chain);\n                result = await analyzer.analyzeWallet(trimmedAddress);\n            }\n        } catch (analysisError) {\n            console.error(`[ANALYZE_ERROR] Failed to analyze ${trimmedAddress}:`, analysisError);\n            // Return a meaningful error instead of failing\n            const errorMessage = analysisError instanceof Error ? analysisError.message : \"Unknown error\";\n            // Check if it's a network/API issue\n            if (errorMessage.includes(\"timeout\") || errorMessage.includes(\"TIMEOUT\")) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: {\n                        code: \"NETWORK_TIMEOUT\",\n                        message: \"Network timeout while fetching blockchain data. Please try again.\",\n                        details: \"The blockchain API is slow to respond. This is usually temporary.\"\n                    },\n                    timestamp: new Date().toISOString()\n                }, {\n                    status: 503\n                });\n            }\n            if (errorMessage.includes(\"RPC\") || errorMessage.includes(\"network\")) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: {\n                        code: \"RPC_ERROR\",\n                        message: \"Unable to connect to blockchain. Please try again.\",\n                        details: errorMessage\n                    },\n                    timestamp: new Date().toISOString()\n                }, {\n                    status: 503\n                });\n            }\n            throw analysisError;\n        }\n        const duration = Date.now() - startTime;\n        console.log(`[ANALYZE] Completed in ${duration}ms. Status: ${result.securityStatus}, Score: ${result.riskScore}, Threats: ${result.detectedThreats.length}`);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: result,\n            timestamp: new Date().toISOString()\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        const duration = Date.now() - startTime;\n        console.error(`[ANALYZE_FATAL] Error after ${duration}ms:`, error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: {\n                code: \"ANALYSIS_ERROR\",\n                message: \"An unexpected error occurred during analysis. Please try again.\",\n                details: error instanceof Error ? error.message : \"Unknown error\"\n            },\n            timestamp: new Date().toISOString()\n        }, {\n            status: 500\n        });\n    }\n}\n// Health check endpoint\nasync function GET() {\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n        status: \"healthy\",\n        service: \"wallet-sentinel\",\n        version: \"1.0.0\",\n        timestamp: new Date().toISOString(),\n        supportedChains: [\n            \"ethereum\",\n            \"base\",\n            \"bnb\",\n            \"solana\"\n        ],\n        disclaimer: \"This service provides security analysis for educational purposes. No wallet custody, no guarantees, no offensive actions. All operations are read-only.\"\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUE0QixFQUFFZ0IsU0FBUyxHQUFHLENBQUMsRUFBRWhCO1FBRTVELE9BQU9oQyxxREFBWUEsQ0FBQzhCLElBQUksQ0FDdEI7WUFDRUMsU0FBUztZQUNUQyxPQUFPO2dCQUNMQyxNQUFNO2dCQUNOQyxTQUFTO2dCQUNUYSxTQUFTZixpQkFBaUJjLFFBQVFkLE1BQU1FLE9BQU8sR0FBRztZQUNwRDtZQUNBQyxXQUFXLElBQUl6QixPQUFPMEIsV0FBVztRQUNuQyxHQUNBO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRUEsd0JBQXdCO0FBQ2pCLGVBQWVpQjtJQUNwQixPQUFPdEQscURBQVlBLENBQUM4QixJQUFJLENBQUM7UUFDdkJPLFFBQVE7UUFDUmtCLFNBQVM7UUFDVEMsU0FBUztRQUNUckIsV0FBVyxJQUFJekIsT0FBTzBCLFdBQVc7UUFDakNxQixpQkFBaUI7WUFBQztZQUFZO1lBQVE7WUFBTztTQUFTO1FBQ3REQyxZQUFZO0lBQ2Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3dhbGxldC1zZW50aW5lbC8uL3NyYy9hcHAvYXBpL2FuYWx5emUvcm91dGUudHM/MDdkYiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gV0FMTEVUIEFOQUxZU0lTIEFQSSBFTkRQT0lOVFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBPU1QgL2FwaS9hbmFseXplXG4vLyBBbmFseXplcyBhIHdhbGxldCBhZGRyZXNzIGZvciBzZWN1cml0eSB0aHJlYXRzLlxuLy8gQWxsIG9wZXJhdGlvbnMgYXJlIFJFQUQtT05MWSBhbmQgZGVmZW5zaXZlLlxuXG5pbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgRVZNQW5hbHl6ZXIgfSBmcm9tICdAL2xpYi9hbmFseXplcnMvZXZtLWFuYWx5emVyJztcbmltcG9ydCB7IFNvbGFuYUFuYWx5emVyIH0gZnJvbSAnQC9saWIvYW5hbHl6ZXJzL3NvbGFuYS1hbmFseXplcic7XG5pbXBvcnQgeyBDaGFpbiwgV2FsbGV0QW5hbHlzaXNSZXF1ZXN0LCBBcGlSZXNwb25zZSwgV2FsbGV0QW5hbHlzaXNSZXN1bHQgfSBmcm9tICdAL3R5cGVzJztcblxuLy8gUmF0ZSBsaW1pdGluZyAoc2ltcGxlIGluLW1lbW9yeSBpbXBsZW1lbnRhdGlvbilcbmNvbnN0IHJlcXVlc3RDb3VudHMgPSBuZXcgTWFwPHN0cmluZywgeyBjb3VudDogbnVtYmVyOyByZXNldFRpbWU6IG51bWJlciB9PigpO1xuY29uc3QgUkFURV9MSU1JVCA9IDIwOyAvLyByZXF1ZXN0cyBwZXIgbWludXRlXG5jb25zdCBSQVRFX1dJTkRPVyA9IDYwMDAwOyAvLyAxIG1pbnV0ZSBpbiBtc1xuXG5mdW5jdGlvbiBpc1JhdGVMaW1pdGVkKGlwOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgcmVjb3JkID0gcmVxdWVzdENvdW50cy5nZXQoaXApO1xuXG4gIGlmICghcmVjb3JkIHx8IG5vdyA+IHJlY29yZC5yZXNldFRpbWUpIHtcbiAgICByZXF1ZXN0Q291bnRzLnNldChpcCwgeyBjb3VudDogMSwgcmVzZXRUaW1lOiBub3cgKyBSQVRFX1dJTkRPVyB9KTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAocmVjb3JkLmNvdW50ID49IFJBVEVfTElNSVQpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJlY29yZC5jb3VudCsrO1xuICByZXR1cm4gZmFsc2U7XG59XG5cbi8vIFZhbGlkYXRlIGNoYWluIHBhcmFtZXRlclxuZnVuY3Rpb24gaXNWYWxpZENoYWluKGNoYWluOiBzdHJpbmcpOiBjaGFpbiBpcyBDaGFpbiB7XG4gIHJldHVybiBbJ2V0aGVyZXVtJywgJ2Jhc2UnLCAnYm5iJywgJ3NvbGFuYSddLmluY2x1ZGVzKGNoYWluKTtcbn1cblxuLy8gVmFsaWRhdGUgRVZNIGFkZHJlc3MgZm9ybWF0XG5mdW5jdGlvbiBpc1ZhbGlkRXZtQWRkcmVzcyhhZGRyZXNzOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIC9eMHhbYS1mQS1GMC05XXs0MH0kLy50ZXN0KGFkZHJlc3MpO1xufVxuXG4vLyBWYWxpZGF0ZSBTb2xhbmEgYWRkcmVzcyBmb3JtYXRcbmZ1bmN0aW9uIGlzVmFsaWRTb2xhbmFBZGRyZXNzKGFkZHJlc3M6IHN0cmluZyk6IGJvb2xlYW4ge1xuICByZXR1cm4gL15bMS05QS1ISi1OUC1aYS1rbS16XXszMiw0NH0kLy50ZXN0KGFkZHJlc3MpO1xufVxuXG4vLyBWYWxpZGF0ZSBhZGRyZXNzIGZvcm1hdCBiYXNlZCBvbiBjaGFpblxuZnVuY3Rpb24gaXNWYWxpZEFkZHJlc3MoYWRkcmVzczogc3RyaW5nLCBjaGFpbjogQ2hhaW4pOiBib29sZWFuIHtcbiAgaWYgKGNoYWluID09PSAnc29sYW5hJykge1xuICAgIHJldHVybiBpc1ZhbGlkU29sYW5hQWRkcmVzcyhhZGRyZXNzKTtcbiAgfVxuICByZXR1cm4gaXNWYWxpZEV2bUFkZHJlc3MoYWRkcmVzcyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gIFxuICB0cnkge1xuICAgIC8vIEdldCBjbGllbnQgSVAgZm9yIHJhdGUgbGltaXRpbmdcbiAgICBjb25zdCBpcCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ3gtZm9yd2FyZGVkLWZvcicpIHx8IFxuICAgICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmdldCgneC1yZWFsLWlwJykgfHwgXG4gICAgICAgICAgICAgICAndW5rbm93bic7XG5cbiAgICBpZiAoaXNSYXRlTGltaXRlZChpcCkpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBbUkFURV9MSU1JVEVEXSBJUDogJHtpcH1gKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbjxBcGlSZXNwb25zZTxudWxsPj4oXG4gICAgICAgIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgY29kZTogJ1JBVEVfTElNSVRFRCcsXG4gICAgICAgICAgICBtZXNzYWdlOiAnVG9vIG1hbnkgcmVxdWVzdHMuIFBsZWFzZSB3YWl0IGEgbW9tZW50IGFuZCB0cnkgYWdhaW4uJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNDI5IH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgcmVxdWVzdCBib2R5XG4gICAgbGV0IGJvZHk6IFdhbGxldEFuYWx5c2lzUmVxdWVzdDtcbiAgICB0cnkge1xuICAgICAgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFwaVJlc3BvbnNlPG51bGw+PihcbiAgICAgICAge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnSU5WQUxJRF9KU09OJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIHJlcXVlc3QgYm9keScsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHsgYWRkcmVzcywgY2hhaW4gfSA9IGJvZHk7XG5cbiAgICAvLyBWYWxpZGF0ZSBpbnB1dHNcbiAgICBpZiAoIWFkZHJlc3MgfHwgdHlwZW9mIGFkZHJlc3MgIT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb248QXBpUmVzcG9uc2U8bnVsbD4+KFxuICAgICAgICB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IHtcbiAgICAgICAgICAgIGNvZGU6ICdJTlZBTElEX0FERFJFU1MnLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1dhbGxldCBhZGRyZXNzIGlzIHJlcXVpcmVkJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKCFjaGFpbiB8fCAhaXNWYWxpZENoYWluKGNoYWluKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFwaVJlc3BvbnNlPG51bGw+PihcbiAgICAgICAge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnSU5WQUxJRF9DSEFJTicsXG4gICAgICAgICAgICBtZXNzYWdlOiAnVmFsaWQgY2hhaW4gaXMgcmVxdWlyZWQgKGV0aGVyZXVtLCBiYXNlLCBibmIsIHNvbGFuYSknLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCB0cmltbWVkQWRkcmVzcyA9IGFkZHJlc3MudHJpbSgpO1xuICAgIFxuICAgIGlmICghaXNWYWxpZEFkZHJlc3ModHJpbW1lZEFkZHJlc3MsIGNoYWluKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFwaVJlc3BvbnNlPG51bGw+PihcbiAgICAgICAge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICBjb2RlOiAnSU5WQUxJRF9BRERSRVNTX0ZPUk1BVCcsXG4gICAgICAgICAgICBtZXNzYWdlOiBgSW52YWxpZCAke2NoYWlufSBhZGRyZXNzIGZvcm1hdC4gJHtjaGFpbiA9PT0gJ3NvbGFuYScgPyAnU29sYW5hIGFkZHJlc3NlcyBhcmUgYmFzZTU4IGVuY29kZWQuJyA6ICdFVk0gYWRkcmVzc2VzIHN0YXJ0IHdpdGggMHggZm9sbG93ZWQgYnkgNDAgaGV4IGNoYXJhY3RlcnMuJ31gLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgW0FOQUxZWkVdIFN0YXJ0aW5nIGFuYWx5c2lzIGZvciAke3RyaW1tZWRBZGRyZXNzfSBvbiAke2NoYWlufWApO1xuXG4gICAgLy8gUGVyZm9ybSBhbmFseXNpc1xuICAgIGxldCByZXN1bHQ6IFdhbGxldEFuYWx5c2lzUmVzdWx0O1xuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChjaGFpbiA9PT0gJ3NvbGFuYScpIHtcbiAgICAgICAgY29uc3QgYW5hbHl6ZXIgPSBuZXcgU29sYW5hQW5hbHl6ZXIoKTtcbiAgICAgICAgcmVzdWx0ID0gYXdhaXQgYW5hbHl6ZXIuYW5hbHl6ZVdhbGxldCh0cmltbWVkQWRkcmVzcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBhbmFseXplciA9IG5ldyBFVk1BbmFseXplcihjaGFpbik7XG4gICAgICAgIHJlc3VsdCA9IGF3YWl0IGFuYWx5emVyLmFuYWx5emVXYWxsZXQodHJpbW1lZEFkZHJlc3MpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGFuYWx5c2lzRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtBTkFMWVpFX0VSUk9SXSBGYWlsZWQgdG8gYW5hbHl6ZSAke3RyaW1tZWRBZGRyZXNzfTpgLCBhbmFseXNpc0Vycm9yKTtcbiAgICAgIFxuICAgICAgLy8gUmV0dXJuIGEgbWVhbmluZ2Z1bCBlcnJvciBpbnN0ZWFkIG9mIGZhaWxpbmdcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGFuYWx5c2lzRXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGFuYWx5c2lzRXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJztcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhIG5ldHdvcmsvQVBJIGlzc3VlXG4gICAgICBpZiAoZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCd0aW1lb3V0JykgfHwgZXJyb3JNZXNzYWdlLmluY2x1ZGVzKCdUSU1FT1VUJykpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFwaVJlc3BvbnNlPG51bGw+PihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgICAgIGNvZGU6ICdORVRXT1JLX1RJTUVPVVQnLFxuICAgICAgICAgICAgICBtZXNzYWdlOiAnTmV0d29yayB0aW1lb3V0IHdoaWxlIGZldGNoaW5nIGJsb2NrY2hhaW4gZGF0YS4gUGxlYXNlIHRyeSBhZ2Fpbi4nLFxuICAgICAgICAgICAgICBkZXRhaWxzOiAnVGhlIGJsb2NrY2hhaW4gQVBJIGlzIHNsb3cgdG8gcmVzcG9uZC4gVGhpcyBpcyB1c3VhbGx5IHRlbXBvcmFyeS4nLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDUwMyB9XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChlcnJvck1lc3NhZ2UuaW5jbHVkZXMoJ1JQQycpIHx8IGVycm9yTWVzc2FnZS5pbmNsdWRlcygnbmV0d29yaycpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbjxBcGlSZXNwb25zZTxudWxsPj4oXG4gICAgICAgICAge1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvcjoge1xuICAgICAgICAgICAgICBjb2RlOiAnUlBDX0VSUk9SJyxcbiAgICAgICAgICAgICAgbWVzc2FnZTogJ1VuYWJsZSB0byBjb25uZWN0IHRvIGJsb2NrY2hhaW4uIFBsZWFzZSB0cnkgYWdhaW4uJyxcbiAgICAgICAgICAgICAgZGV0YWlsczogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgeyBzdGF0dXM6IDUwMyB9XG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHRocm93IGFuYWx5c2lzRXJyb3I7XG4gICAgfVxuXG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIGNvbnNvbGUubG9nKGBbQU5BTFlaRV0gQ29tcGxldGVkIGluICR7ZHVyYXRpb259bXMuIFN0YXR1czogJHtyZXN1bHQuc2VjdXJpdHlTdGF0dXN9LCBTY29yZTogJHtyZXN1bHQucmlza1Njb3JlfSwgVGhyZWF0czogJHtyZXN1bHQuZGV0ZWN0ZWRUaHJlYXRzLmxlbmd0aH1gKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbjxBcGlSZXNwb25zZTxXYWxsZXRBbmFseXNpc1Jlc3VsdD4+KFxuICAgICAge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiByZXN1bHQsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiAyMDAgfVxuICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIGNvbnNvbGUuZXJyb3IoYFtBTkFMWVpFX0ZBVEFMXSBFcnJvciBhZnRlciAke2R1cmF0aW9ufW1zOmAsIGVycm9yKTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbjxBcGlSZXNwb25zZTxudWxsPj4oXG4gICAgICB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjoge1xuICAgICAgICAgIGNvZGU6ICdBTkFMWVNJU19FUlJPUicsXG4gICAgICAgICAgbWVzc2FnZTogJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGFuYWx5c2lzLiBQbGVhc2UgdHJ5IGFnYWluLicsXG4gICAgICAgICAgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICAgIH0sXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuLy8gSGVhbHRoIGNoZWNrIGVuZHBvaW50XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgIHN0YXR1czogJ2hlYWx0aHknLFxuICAgIHNlcnZpY2U6ICd3YWxsZXQtc2VudGluZWwnLFxuICAgIHZlcnNpb246ICcxLjAuMCcsXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgc3VwcG9ydGVkQ2hhaW5zOiBbJ2V0aGVyZXVtJywgJ2Jhc2UnLCAnYm5iJywgJ3NvbGFuYSddLFxuICAgIGRpc2NsYWltZXI6ICdUaGlzIHNlcnZpY2UgcHJvdmlkZXMgc2VjdXJpdHkgYW5hbHlzaXMgZm9yIGVkdWNhdGlvbmFsIHB1cnBvc2VzLiBObyB3YWxsZXQgY3VzdG9keSwgbm8gZ3VhcmFudGVlcywgbm8gb2ZmZW5zaXZlIGFjdGlvbnMuIEFsbCBvcGVyYXRpb25zIGFyZSByZWFkLW9ubHkuJyxcbiAgfSk7XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiRVZNQW5hbHl6ZXIiLCJTb2xhbmFBbmFseXplciIsInJlcXVlc3RDb3VudHMiLCJNYXAiLCJSQVRFX0xJTUlUIiwiUkFURV9XSU5ET1ciLCJpc1JhdGVMaW1pdGVkIiwiaXAiLCJub3ciLCJEYXRlIiwicmVjb3JkIiwiZ2V0IiwicmVzZXRUaW1lIiwic2V0IiwiY291bnQiLCJpc1ZhbGlkQ2hhaW4iLCJjaGFpbiIsImluY2x1ZGVzIiwiaXNWYWxpZEV2bUFkZHJlc3MiLCJhZGRyZXNzIiwidGVzdCIsImlzVmFsaWRTb2xhbmFBZGRyZXNzIiwiaXNWYWxpZEFkZHJlc3MiLCJQT1NUIiwicmVxdWVzdCIsInN0YXJ0VGltZSIsImhlYWRlcnMiLCJjb25zb2xlIiwibG9nIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsImNvZGUiLCJtZXNzYWdlIiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJzdGF0dXMiLCJib2R5IiwidHJpbW1lZEFkZHJlc3MiLCJ0cmltIiwicmVzdWx0IiwiYW5hbHl6ZXIiLCJhbmFseXplV2FsbGV0IiwiYW5hbHlzaXNFcnJvciIsImVycm9yTWVzc2FnZSIsIkVycm9yIiwiZGV0YWlscyIsImR1cmF0aW9uIiwic2VjdXJpdHlTdGF0dXMiLCJyaXNrU2NvcmUiLCJkZXRlY3RlZFRocmVhdHMiLCJsZW5ndGgiLCJkYXRhIiwiR0VUIiwic2VydmljZSIsInZlcnNpb24iLCJzdXBwb3J0ZWRDaGFpbnMiLCJkaXNjbGFpbWVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/analyze/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/analyzers/evm-analyzer.ts":
/*!*******************************************!*\
  !*** ./src/lib/analyzers/evm-analyzer.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EVMAnalyzer: () => (/* binding */ EVMAnalyzer)\n/* harmony export */ });\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ethers */ \"(rsc)/./node_modules/ethers/lib.esm/providers/provider-jsonrpc.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ethers */ \"(rsc)/./node_modules/ethers/lib.esm/address/checks.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ethers */ \"(rsc)/./node_modules/ethers/lib.esm/utils/units.js\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ethers */ \"(rsc)/./node_modules/ethers/lib.esm/abi/interface.js\");\n/* harmony import */ var _detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../detection/malicious-database */ \"(rsc)/./src/lib/detection/malicious-database.ts\");\n// ============================================\n// EVM CHAIN ANALYZER (Ethereum, Base, BNB)\n// ============================================\n// Enhanced detection for wallet compromise, drainers, and approval abuse.\n// All operations are READ-ONLY.\n\n\n// ============================================\n// EVM ANALYZER CLASS\n// ============================================\nclass EVMAnalyzer {\n    constructor(chain){\n        this.provider = null;\n        this.currentRpcIndex = 0;\n        if (chain === \"solana\") {\n            throw new Error(\"EVMAnalyzer does not support Solana. Use SolanaAnalyzer instead.\");\n        }\n        this.chain = chain;\n        const config = _detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.CHAIN_RPC_CONFIG[chain];\n        this.rpcUrls = config.rpcUrls;\n        this.explorerApiUrl = config.explorerApi;\n        this.explorerApiKey = process.env[`${chain.toUpperCase()}_EXPLORER_API_KEY`] || \"\";\n    }\n    async getProvider() {\n        for(let i = 0; i < this.rpcUrls.length; i++){\n            const rpcIndex = (this.currentRpcIndex + i) % this.rpcUrls.length;\n            const rpcUrl = this.rpcUrls[rpcIndex];\n            try {\n                const provider = new ethers__WEBPACK_IMPORTED_MODULE_1__.JsonRpcProvider(rpcUrl, undefined, {\n                    staticNetwork: true,\n                    batchMaxCount: 1\n                });\n                await Promise.race([\n                    provider.getBlockNumber(),\n                    new Promise((_, reject)=>setTimeout(()=>reject(new Error(\"timeout\")), 5000))\n                ]);\n                this.currentRpcIndex = rpcIndex;\n                this.provider = provider;\n                return provider;\n            } catch (error) {\n                continue;\n            }\n        }\n        throw new Error(\"All RPC endpoints failed\");\n    }\n    async analyzeWallet(address) {\n        if (!ethers__WEBPACK_IMPORTED_MODULE_2__.isAddress(address)) {\n            throw new Error(\"Invalid Ethereum address\");\n        }\n        const normalizedAddress = address.toLowerCase();\n        const threats = [];\n        // Fetch all data in parallel\n        const [transactions, tokenTransfers, approvalEvents, currentBalance] = await Promise.all([\n            this.fetchTransactionHistory(normalizedAddress),\n            this.fetchTokenTransfers(normalizedAddress),\n            this.fetchApprovalEvents(normalizedAddress),\n            this.fetchCurrentBalance(normalizedAddress)\n        ]);\n        console.log(`[ANALYZE] ${normalizedAddress}: ${transactions.length} txs, ${tokenTransfers.length} transfers, ${approvalEvents.length} approvals, balance: ${currentBalance}`);\n        // ============================================\n        // COMPREHENSIVE THREAT DETECTION\n        // ============================================\n        // 1. DETECT COMPLETE WALLET DRAIN (Private Key Compromise or Drainer)\n        const drainThreat = this.detectWalletDrain(transactions, tokenTransfers, currentBalance, normalizedAddress);\n        if (drainThreat) threats.push(drainThreat);\n        // 2. DETECT KNOWN MALICIOUS INTERACTIONS\n        const maliciousThreats = this.detectMaliciousInteractions(transactions, tokenTransfers, normalizedAddress);\n        threats.push(...maliciousThreats);\n        // 3. DETECT SUSPICIOUS APPROVAL PATTERNS\n        const approvalThreats = this.detectApprovalAbuse(approvalEvents, tokenTransfers, normalizedAddress);\n        threats.push(...approvalThreats);\n        // ============================================\n        // ANALYZE CURRENT APPROVALS\n        // ============================================\n        const analyzedApprovals = this.analyzeApprovals(approvalEvents);\n        // Flag active malicious approvals\n        for (const approval of analyzedApprovals){\n            if (approval.isMalicious) {\n                threats.push({\n                    id: `active-malicious-approval-${approval.id}`,\n                    type: \"APPROVAL_HIJACK\",\n                    severity: \"CRITICAL\",\n                    title: \"Active Approval to Malicious Contract\",\n                    description: `You have an active approval allowing a known malicious contract to spend your ${approval.token.symbol} tokens.`,\n                    technicalDetails: `Spender: ${approval.spender}`,\n                    detectedAt: new Date().toISOString(),\n                    relatedAddresses: [\n                        approval.spender\n                    ],\n                    relatedTransactions: [],\n                    ongoingRisk: true\n                });\n            }\n        }\n        // ============================================\n        // CALCULATE RESULTS\n        // ============================================\n        const riskScore = this.calculateRiskScore(threats, analyzedApprovals);\n        const securityStatus = this.determineSecurityStatus(riskScore, threats);\n        const suspiciousTransactions = this.buildSuspiciousTransactions(transactions, threats);\n        const recommendations = this.generateRecommendations(threats, analyzedApprovals, securityStatus);\n        const recoveryPlan = securityStatus !== \"SAFE\" ? this.generateRecoveryPlan(threats, analyzedApprovals) : undefined;\n        console.log(`[ANALYZE] Completed. Status: ${securityStatus}, Score: ${riskScore}, Threats: ${threats.length}`);\n        return {\n            address: normalizedAddress,\n            chain: this.chain,\n            timestamp: new Date().toISOString(),\n            securityStatus,\n            riskScore,\n            summary: this.generateSummary(securityStatus, threats, analyzedApprovals),\n            detectedThreats: threats,\n            approvals: analyzedApprovals,\n            suspiciousTransactions,\n            recommendations,\n            recoveryPlan,\n            educationalContent: this.generateEducationalContent(threats)\n        };\n    }\n    // ============================================\n    // CORE DETECTION: WALLET DRAIN\n    // ============================================\n    detectWalletDrain(transactions, tokenTransfers, currentBalance, userAddress) {\n        // Skip if no activity\n        if (transactions.length === 0 && tokenTransfers.length === 0) return null;\n        // Parse current balance\n        let balanceWei;\n        try {\n            balanceWei = BigInt(currentBalance || \"0\");\n        } catch  {\n            balanceWei = BigInt(0);\n        }\n        // Collect all outbound transfers\n        const outboundTransfers = [];\n        // Native ETH transfers\n        for (const tx of transactions){\n            if (!tx?.from || !tx?.to) continue;\n            if (tx.from.toLowerCase() === userAddress) {\n                const value = BigInt(tx.value || \"0\");\n                if (value > BigInt(0)) {\n                    outboundTransfers.push({\n                        to: tx.to.toLowerCase(),\n                        hash: tx.hash,\n                        timestamp: tx.timestamp,\n                        type: \"native\",\n                        value: tx.value\n                    });\n                }\n            }\n        }\n        // Token transfers\n        for (const transfer of tokenTransfers){\n            if (!transfer?.from || !transfer?.to) continue;\n            if (transfer.from.toLowerCase() === userAddress) {\n                outboundTransfers.push({\n                    to: transfer.to.toLowerCase(),\n                    hash: transfer.hash,\n                    timestamp: transfer.timestamp,\n                    type: `token:${transfer.tokenSymbol}`,\n                    value: transfer.value\n                });\n            }\n        }\n        if (outboundTransfers.length === 0) return null;\n        // Check if wallet is currently empty (defined here so it's available throughout the function)\n        const isCurrentlyEmpty = balanceWei < BigInt(\"1000000000000000\"); // < 0.001 ETH\n        // Analyze outbound pattern\n        const destinationCounts = {};\n        for (const transfer of outboundTransfers){\n            if (!destinationCounts[transfer.to]) {\n                destinationCounts[transfer.to] = {\n                    count: 0,\n                    types: new Set(),\n                    hashes: [],\n                    timestamps: []\n                };\n            }\n            destinationCounts[transfer.to].count++;\n            destinationCounts[transfer.to].types.add(transfer.type);\n            destinationCounts[transfer.to].hashes.push(transfer.hash);\n            destinationCounts[transfer.to].timestamps.push(transfer.timestamp);\n        }\n        // Find suspicious patterns\n        for (const [destination, data] of Object.entries(destinationCounts)){\n            // Skip known legitimate contracts\n            if ((0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isLegitimateContract)(destination)) continue;\n            // Check for known drainer\n            const isMalicious = (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isMaliciousAddress)(destination, this.chain) || (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isDrainerRecipient)(destination);\n            // PATTERN 1: Multiple different asset types to same address\n            // This is a strong indicator of drain (native + multiple tokens to same address)\n            const hasMultipleAssetTypes = data.types.size >= 2;\n            const hasNativeAndTokens = data.types.has(\"native\") && Array.from(data.types).some((t)=>t.startsWith(\"token:\"));\n            // PATTERN 2: Check time clustering (all within 30 minutes)\n            const timestamps = data.timestamps.sort((a, b)=>a - b);\n            const timeSpan = timestamps.length > 1 ? timestamps[timestamps.length - 1] - timestamps[0] : 0;\n            const isRapid = timeSpan <= 30 * 60; // 30 minutes\n            // Determine threat level\n            if (isMalicious) {\n                // CONFIRMED: Transfers to known drainer\n                return {\n                    id: `drain-confirmed-${Date.now()}`,\n                    type: \"WALLET_DRAINER\",\n                    severity: \"CRITICAL\",\n                    title: \"Assets Sent to Known Drainer Address\",\n                    description: `${data.count} transfer(s) were made to a known drainer/scam address (${destination.slice(0, 10)}...). Your assets have likely been stolen.`,\n                    technicalDetails: `Drainer: ${destination}, Transfers: ${data.count}, Asset types: ${Array.from(data.types).join(\", \")}`,\n                    detectedAt: new Date().toISOString(),\n                    relatedAddresses: [\n                        destination\n                    ],\n                    relatedTransactions: data.hashes.slice(0, 10),\n                    ongoingRisk: true\n                };\n            }\n            if (hasNativeAndTokens && isRapid && data.count >= 2) {\n                // LIKELY DRAIN: Native + tokens to same unknown address quickly\n                const severity = isCurrentlyEmpty ? \"CRITICAL\" : \"HIGH\";\n                const threatType = isCurrentlyEmpty ? \"PRIVATE_KEY_LEAK\" : \"WALLET_DRAINER\";\n                return {\n                    id: `drain-pattern-${Date.now()}`,\n                    type: threatType,\n                    severity,\n                    title: isCurrentlyEmpty ? \"Wallet Appears Drained - Possible Key Compromise\" : \"Suspicious Asset Transfer Pattern\",\n                    description: `${data.count} different assets (ETH + tokens) were sent to the same address (${destination.slice(0, 10)}...) within ${Math.ceil(timeSpan / 60)} minutes.${isCurrentlyEmpty ? \" Your wallet balance is now nearly zero.\" : \"\"} This pattern is consistent with wallet drainer activity or private key compromise.`,\n                    technicalDetails: `Destination: ${destination}, Time span: ${Math.ceil(timeSpan / 60)} minutes, Assets: ${Array.from(data.types).join(\", \")}`,\n                    detectedAt: new Date().toISOString(),\n                    relatedAddresses: [\n                        destination\n                    ],\n                    relatedTransactions: data.hashes.slice(0, 10),\n                    ongoingRisk: isCurrentlyEmpty\n                };\n            }\n            if (data.count >= 5 && isRapid) {\n                // SUSPICIOUS: Many transfers to same address quickly\n                return {\n                    id: `suspicious-outflow-${Date.now()}`,\n                    type: \"WALLET_DRAINER\",\n                    severity: \"HIGH\",\n                    title: \"Rapid Asset Outflow Detected\",\n                    description: `${data.count} transfers to the same address (${destination.slice(0, 10)}...) within a short time period. Review these transactions carefully.`,\n                    technicalDetails: `Destination: ${destination}, Transfers: ${data.count}`,\n                    detectedAt: new Date().toISOString(),\n                    relatedAddresses: [\n                        destination\n                    ],\n                    relatedTransactions: data.hashes.slice(0, 10),\n                    ongoingRisk: false\n                };\n            }\n        }\n        // PATTERN 4: Check if wallet was funded and is now empty (general drain indicator)\n        if (isCurrentlyEmpty && transactions.length > 5) {\n            // Calculate total received\n            let totalReceived = BigInt(0);\n            for (const tx of transactions){\n                if (!tx?.to) continue;\n                if (tx.to.toLowerCase() === userAddress) {\n                    totalReceived += BigInt(tx.value || \"0\");\n                }\n            }\n            // If wallet received significant funds but is now empty\n            if (totalReceived > BigInt(\"100000000000000000\")) {\n                // Find the main destination\n                const sortedDests = Object.entries(destinationCounts).filter(([addr])=>!(0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isLegitimateContract)(addr)).sort((a, b)=>b[1].count - a[1].count);\n                if (sortedDests.length > 0) {\n                    const [topDest, topData] = sortedDests[0];\n                    return {\n                        id: `wallet-emptied-${Date.now()}`,\n                        type: \"WALLET_DRAINER\",\n                        severity: \"HIGH\",\n                        title: \"Wallet Has Been Emptied\",\n                        description: `This wallet received ${ethers__WEBPACK_IMPORTED_MODULE_3__.formatEther(totalReceived)} ETH but is now nearly empty. Most assets were sent to ${topDest.slice(0, 10)}...`,\n                        technicalDetails: `Primary destination: ${topDest}, Transfers: ${topData.count}`,\n                        detectedAt: new Date().toISOString(),\n                        relatedAddresses: [\n                            topDest\n                        ],\n                        relatedTransactions: topData.hashes.slice(0, 10),\n                        ongoingRisk: false\n                    };\n                }\n            }\n        }\n        return null;\n    }\n    // ============================================\n    // DETECTION: MALICIOUS CONTRACT INTERACTIONS\n    // ============================================\n    detectMaliciousInteractions(transactions, tokenTransfers, userAddress) {\n        const threats = [];\n        const flaggedAddresses = new Set();\n        // Check transactions\n        for (const tx of transactions){\n            if (!tx?.to || !tx?.from || !tx?.hash) continue;\n            const interactedWith = tx.from.toLowerCase() === userAddress ? tx.to : tx.from;\n            const malicious = (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isMaliciousAddress)(interactedWith, this.chain);\n            if (malicious && !flaggedAddresses.has(interactedWith.toLowerCase())) {\n                flaggedAddresses.add(interactedWith.toLowerCase());\n                threats.push({\n                    id: `malicious-tx-${tx.hash}`,\n                    type: malicious.type || \"WALLET_DRAINER\",\n                    severity: \"CRITICAL\",\n                    title: `Interaction with ${malicious.name || \"Known Malicious Contract\"}`,\n                    description: `This wallet interacted with \"${malicious.name || \"a known malicious contract\"}\". This is a confirmed threat.`,\n                    technicalDetails: `Contract: ${interactedWith}, TX: ${tx.hash}`,\n                    detectedAt: new Date().toISOString(),\n                    relatedAddresses: [\n                        interactedWith\n                    ],\n                    relatedTransactions: [\n                        tx.hash\n                    ],\n                    ongoingRisk: true\n                });\n            }\n        }\n        // Check token transfers\n        for (const transfer of tokenTransfers){\n            if (!transfer?.to || !transfer?.from || !transfer?.hash) continue;\n            const destination = transfer.to.toLowerCase();\n            if (flaggedAddresses.has(destination)) continue;\n            if (transfer.from.toLowerCase() === userAddress) {\n                const isMalicious = (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isMaliciousAddress)(destination, this.chain) || (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isDrainerRecipient)(destination);\n                if (isMalicious) {\n                    flaggedAddresses.add(destination);\n                    threats.push({\n                        id: `malicious-transfer-${transfer.hash}`,\n                        type: \"WALLET_DRAINER\",\n                        severity: \"CRITICAL\",\n                        title: \"Tokens Sent to Known Malicious Address\",\n                        description: `${transfer.tokenSymbol} tokens were sent to a known drainer address.`,\n                        technicalDetails: `Destination: ${destination}, Token: ${transfer.tokenSymbol}`,\n                        detectedAt: new Date().toISOString(),\n                        relatedAddresses: [\n                            destination\n                        ],\n                        relatedTransactions: [\n                            transfer.hash\n                        ],\n                        ongoingRisk: true\n                    });\n                }\n            }\n        }\n        return threats;\n    }\n    // ============================================\n    // DETECTION: APPROVAL ABUSE\n    // ============================================\n    detectApprovalAbuse(approvalEvents, tokenTransfers, userAddress) {\n        const threats = [];\n        for (const approval of approvalEvents){\n            if (!approval?.spender) continue;\n            const spenderMalicious = (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isMaliciousAddress)(approval.spender, this.chain) || (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isDrainerRecipient)(approval.spender);\n            if (spenderMalicious) {\n                threats.push({\n                    id: `approval-abuse-${approval.transactionHash}`,\n                    type: \"APPROVAL_HIJACK\",\n                    severity: \"CRITICAL\",\n                    title: \"Approval Granted to Malicious Contract\",\n                    description: `You approved a known malicious contract to spend your ${approval.tokenSymbol || \"tokens\"}. This may have been used to drain your assets.`,\n                    technicalDetails: `Spender: ${approval.spender}, Token: ${approval.token}`,\n                    detectedAt: new Date().toISOString(),\n                    relatedAddresses: [\n                        approval.spender\n                    ],\n                    relatedTransactions: [\n                        approval.transactionHash\n                    ],\n                    ongoingRisk: true\n                });\n            }\n        }\n        return threats;\n    }\n    // ============================================\n    // DATA FETCHING\n    // ============================================\n    async fetchTransactionHistory(address) {\n        const sources = [\n            ()=>this.fetchFromBlockscout(address),\n            ()=>this.fetchFromEtherscan(address)\n        ];\n        for (const fetchFn of sources){\n            try {\n                const result = await fetchFn();\n                if (result.length > 0) {\n                    console.log(`[FETCH] Got ${result.length} transactions`);\n                    return result;\n                }\n            } catch (error) {\n                console.log(\"[FETCH] Source failed, trying next...\");\n            }\n        }\n        console.log(\"[FETCH] All sources failed for transactions\");\n        return [];\n    }\n    async fetchFromEtherscan(address) {\n        const url = `${this.explorerApiUrl}?module=account&action=txlist&address=${address}&startblock=0&endblock=99999999&sort=desc&apikey=${this.explorerApiKey}`;\n        const response = await fetch(url, {\n            signal: AbortSignal.timeout(15000),\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n        });\n        const data = await response.json();\n        if (data.status !== \"1\" || !Array.isArray(data.result)) {\n            throw new Error(data.message || \"API error\");\n        }\n        return data.result.slice(0, 200).filter((tx)=>tx?.hash).map((tx)=>({\n                hash: tx.hash,\n                from: (tx.from || \"\").toLowerCase(),\n                to: (tx.to || \"\").toLowerCase(),\n                value: tx.value || \"0\",\n                input: tx.input || \"0x\",\n                timestamp: parseInt(tx.timeStamp) || 0,\n                blockNumber: parseInt(tx.blockNumber) || 0,\n                methodId: (tx.input || \"\").slice(0, 10) || \"0x\",\n                isError: tx.isError === \"1\",\n                gasUsed: tx.gasUsed\n            }));\n    }\n    async fetchFromBlockscout(address) {\n        let baseUrl = \"\";\n        if (this.chain === \"ethereum\") {\n            baseUrl = \"https://eth.blockscout.com/api/v2\";\n        } else if (this.chain === \"base\") {\n            baseUrl = \"https://base.blockscout.com/api/v2\";\n        } else if (this.chain === \"bnb\") {\n            baseUrl = \"https://bsc.blockscout.com/api/v2\";\n        } else {\n            throw new Error(\"Chain not supported\");\n        }\n        const url = `${baseUrl}/addresses/${address}/transactions`;\n        console.log(`[FETCH] Trying Blockscout: ${url}`);\n        const response = await fetch(url, {\n            signal: AbortSignal.timeout(20000),\n            headers: {\n                \"Accept\": \"application/json\",\n                \"User-Agent\": \"WalletSentinel/1.0\"\n            }\n        });\n        if (!response.ok) throw new Error(`Blockscout error: ${response.status}`);\n        const data = await response.json();\n        console.log(`[FETCH] Blockscout returned ${data.items?.length || 0} items`);\n        if (!data.items || !Array.isArray(data.items)) {\n            throw new Error(\"No items\");\n        }\n        return data.items.slice(0, 200).filter((tx)=>tx?.hash).map((tx)=>{\n            const fromAddr = typeof tx.from === \"object\" ? tx.from?.hash : tx.from;\n            const toAddr = typeof tx.to === \"object\" ? tx.to?.hash : tx.to;\n            return {\n                hash: tx.hash,\n                from: (fromAddr || \"\").toLowerCase(),\n                to: (toAddr || \"\").toLowerCase(),\n                value: tx.value || \"0\",\n                input: tx.raw_input || tx.input || \"0x\",\n                timestamp: tx.timestamp ? Math.floor(new Date(tx.timestamp).getTime() / 1000) : 0,\n                blockNumber: tx.block_number || tx.block || 0,\n                methodId: tx.method || tx.raw_input?.slice(0, 10) || \"0x\",\n                isError: tx.status === \"error\",\n                gasUsed: tx.gas_used?.toString() || \"0\"\n            };\n        });\n    }\n    async fetchTokenTransfers(address) {\n        const sources = [\n            ()=>this.fetchTokensFromBlockscout(address),\n            ()=>this.fetchTokensFromEtherscan(address)\n        ];\n        for (const fetchFn of sources){\n            try {\n                const result = await fetchFn();\n                if (result.length > 0) {\n                    console.log(`[FETCH] Got ${result.length} token transfers`);\n                    return result;\n                }\n            } catch (error) {\n                console.log(\"[FETCH] Token source failed, trying next...\");\n            }\n        }\n        console.log(\"[FETCH] All token sources exhausted\");\n        return [];\n    }\n    async fetchTokensFromEtherscan(address) {\n        const url = `${this.explorerApiUrl}?module=account&action=tokentx&address=${address}&startblock=0&endblock=99999999&sort=desc&apikey=${this.explorerApiKey}`;\n        const response = await fetch(url, {\n            signal: AbortSignal.timeout(15000),\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n        });\n        const data = await response.json();\n        if (data.status !== \"1\" || !Array.isArray(data.result)) {\n            throw new Error(\"No token transfers\");\n        }\n        return data.result.slice(0, 200).filter((tx)=>tx?.hash).map((tx)=>({\n                from: (tx.from || \"\").toLowerCase(),\n                to: (tx.to || \"\").toLowerCase(),\n                value: tx.value || \"0\",\n                hash: tx.hash,\n                timestamp: parseInt(tx.timeStamp) || 0,\n                tokenSymbol: tx.tokenSymbol || \"UNKNOWN\",\n                tokenAddress: (tx.contractAddress || \"\").toLowerCase()\n            }));\n    }\n    async fetchTokensFromBlockscout(address) {\n        let baseUrl = \"\";\n        if (this.chain === \"ethereum\") {\n            baseUrl = \"https://eth.blockscout.com/api/v2\";\n        } else if (this.chain === \"base\") {\n            baseUrl = \"https://base.blockscout.com/api/v2\";\n        } else if (this.chain === \"bnb\") {\n            baseUrl = \"https://bsc.blockscout.com/api/v2\";\n        } else {\n            throw new Error(\"Chain not supported\");\n        }\n        const url = `${baseUrl}/addresses/${address}/token-transfers`;\n        const response = await fetch(url, {\n            signal: AbortSignal.timeout(15000),\n            headers: {\n                \"Accept\": \"application/json\",\n                \"User-Agent\": \"WalletSentinel/1.0\"\n            }\n        });\n        if (!response.ok) throw new Error(`Blockscout error: ${response.status}`);\n        const data = await response.json();\n        if (!data.items || !Array.isArray(data.items)) return [];\n        return data.items.slice(0, 200).filter((tx)=>tx?.tx_hash).map((tx)=>({\n                from: (tx.from?.hash || \"\").toLowerCase(),\n                to: (tx.to?.hash || \"\").toLowerCase(),\n                value: tx.total?.value || \"0\",\n                hash: tx.tx_hash,\n                timestamp: tx.timestamp ? Math.floor(new Date(tx.timestamp).getTime() / 1000) : 0,\n                tokenSymbol: tx.token?.symbol || \"UNKNOWN\",\n                tokenAddress: (tx.token?.address || \"\").toLowerCase()\n            }));\n    }\n    async fetchCurrentBalance(address) {\n        try {\n            let baseUrl = \"\";\n            if (this.chain === \"ethereum\") baseUrl = \"https://eth.blockscout.com/api/v2\";\n            else if (this.chain === \"base\") baseUrl = \"https://base.blockscout.com/api/v2\";\n            else if (this.chain === \"bnb\") baseUrl = \"https://bsc.blockscout.com/api/v2\";\n            if (baseUrl) {\n                const response = await fetch(`${baseUrl}/addresses/${address}`, {\n                    signal: AbortSignal.timeout(10000),\n                    headers: {\n                        \"Accept\": \"application/json\",\n                        \"User-Agent\": \"WalletSentinel/1.0\"\n                    }\n                });\n                if (response.ok) {\n                    const data = await response.json();\n                    if (data.coin_balance) return data.coin_balance;\n                }\n            }\n        } catch  {}\n        try {\n            const url = `${this.explorerApiUrl}?module=account&action=balance&address=${address}&tag=latest&apikey=${this.explorerApiKey}`;\n            const response = await fetch(url, {\n                signal: AbortSignal.timeout(10000)\n            });\n            const data = await response.json();\n            if (data.status === \"1\" && data.result) return data.result;\n        } catch  {}\n        return \"0\";\n    }\n    async fetchApprovalEvents(address) {\n        try {\n            let baseUrl = \"\";\n            if (this.chain === \"ethereum\") baseUrl = \"https://eth.blockscout.com/api/v2\";\n            else if (this.chain === \"base\") baseUrl = \"https://base.blockscout.com/api/v2\";\n            else if (this.chain === \"bnb\") baseUrl = \"https://bsc.blockscout.com/api/v2\";\n            if (baseUrl) {\n                const response = await fetch(`${baseUrl}/addresses/${address}/transactions`, {\n                    signal: AbortSignal.timeout(15000),\n                    headers: {\n                        \"Accept\": \"application/json\",\n                        \"User-Agent\": \"WalletSentinel/1.0\"\n                    }\n                });\n                if (response.ok) {\n                    const data = await response.json();\n                    const approvals = [];\n                    if (data.items && Array.isArray(data.items)) {\n                        for (const tx of data.items){\n                            const input = tx.raw_input || \"\";\n                            if (input.startsWith(\"0x095ea7b3\") || input.startsWith(\"0xa22cb465\")) {\n                                const spender = input.length >= 74 ? \"0x\" + input.slice(34, 74) : \"\";\n                                const toAddr = typeof tx.to === \"object\" ? tx.to?.hash : tx.to;\n                                approvals.push({\n                                    token: (toAddr || \"\").toLowerCase(),\n                                    tokenName: \"Unknown\",\n                                    tokenSymbol: \"UNK\",\n                                    spender: spender.toLowerCase(),\n                                    owner: address.toLowerCase(),\n                                    amount: input.length >= 138 ? \"0x\" + input.slice(74, 138) : \"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\",\n                                    timestamp: tx.timestamp ? Math.floor(new Date(tx.timestamp).getTime() / 1000) : 0,\n                                    transactionHash: tx.hash,\n                                    blockNumber: tx.block || 0\n                                });\n                            }\n                        }\n                    }\n                    if (approvals.length > 0) return approvals;\n                }\n            }\n        } catch  {}\n        return [];\n    }\n    // ============================================\n    // APPROVAL ANALYSIS\n    // ============================================\n    analyzeApprovals(approvalEvents) {\n        const approvals = [];\n        const processed = new Set();\n        for (const event of approvalEvents){\n            const key = `${event.token}-${event.spender}`;\n            if (processed.has(key)) continue;\n            processed.add(key);\n            let amount;\n            try {\n                amount = BigInt(event.amount).toString();\n                if (amount === \"0\") continue;\n            } catch  {\n                continue;\n            }\n            const isUnlimited = (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isInfiniteApproval)(amount);\n            const maliciousSpender = (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isMaliciousAddress)(event.spender, this.chain);\n            const legitimateSpender = (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isLegitimateContract)(event.spender);\n            const drainerRecipient = (0,_detection_malicious_database__WEBPACK_IMPORTED_MODULE_0__.isDrainerRecipient)(event.spender);\n            let riskLevel = \"LOW\";\n            let riskReason;\n            if (maliciousSpender || drainerRecipient) {\n                riskLevel = \"CRITICAL\";\n                riskReason = \"Approved to known malicious address\";\n            } else if (isUnlimited && !legitimateSpender) {\n                riskLevel = \"HIGH\";\n                riskReason = \"Unlimited approval to unverified contract\";\n            } else if (isUnlimited) {\n                riskLevel = \"MEDIUM\";\n                riskReason = `Unlimited approval to ${legitimateSpender}`;\n            }\n            approvals.push({\n                id: `approval-${event.transactionHash}-${event.spender}`,\n                token: {\n                    address: event.token,\n                    symbol: event.tokenSymbol || \"UNK\",\n                    name: event.tokenName || \"Unknown\",\n                    decimals: 18,\n                    standard: \"ERC20\",\n                    verified: false\n                },\n                spender: event.spender,\n                spenderLabel: legitimateSpender || maliciousSpender?.name,\n                amount,\n                isUnlimited,\n                riskLevel,\n                riskReason,\n                grantedAt: new Date(event.timestamp * 1000).toISOString(),\n                isMalicious: !!(maliciousSpender || drainerRecipient)\n            });\n        }\n        return approvals.sort((a, b)=>{\n            const order = {\n                CRITICAL: 0,\n                HIGH: 1,\n                MEDIUM: 2,\n                LOW: 3\n            };\n            return order[a.riskLevel] - order[b.riskLevel];\n        });\n    }\n    // ============================================\n    // SCORING & STATUS\n    // ============================================\n    calculateRiskScore(threats, approvals) {\n        let score = 0;\n        for (const threat of threats){\n            switch(threat.severity){\n                case \"CRITICAL\":\n                    score += threat.ongoingRisk ? 40 : 25;\n                    break;\n                case \"HIGH\":\n                    score += threat.ongoingRisk ? 25 : 15;\n                    break;\n                case \"MEDIUM\":\n                    score += 10;\n                    break;\n                case \"LOW\":\n                    score += 5;\n                    break;\n            }\n        }\n        for (const approval of approvals){\n            if (approval.isMalicious) score += 30;\n            else if (approval.riskLevel === \"CRITICAL\") score += 20;\n            else if (approval.riskLevel === \"HIGH\") score += 10;\n        }\n        return Math.min(100, score);\n    }\n    determineSecurityStatus(riskScore, threats) {\n        const hasCritical = threats.some((t)=>t.severity === \"CRITICAL\" && t.ongoingRisk);\n        const hasKeyCompromise = threats.some((t)=>t.type === \"PRIVATE_KEY_LEAK\");\n        const hasDrainer = threats.some((t)=>t.type === \"WALLET_DRAINER\");\n        if (hasCritical || hasKeyCompromise || hasDrainer || riskScore >= 50) {\n            return \"COMPROMISED\";\n        }\n        if (riskScore >= 20 || threats.length > 0) {\n            return \"AT_RISK\";\n        }\n        return \"SAFE\";\n    }\n    // ============================================\n    // OUTPUT GENERATION\n    // ============================================\n    buildSuspiciousTransactions(transactions, threats) {\n        const suspicious = [];\n        for (const threat of threats){\n            for (const txHash of threat.relatedTransactions){\n                if (!txHash) continue;\n                const tx = transactions.find((t)=>t?.hash?.toLowerCase() === txHash.toLowerCase());\n                if (tx) {\n                    suspicious.push({\n                        hash: tx.hash,\n                        timestamp: new Date(tx.timestamp * 1000).toISOString(),\n                        type: threat.type,\n                        from: tx.from,\n                        to: tx.to,\n                        value: tx.value,\n                        riskLevel: threat.severity,\n                        flags: [\n                            threat.title\n                        ],\n                        description: threat.description\n                    });\n                }\n            }\n        }\n        return suspicious;\n    }\n    generateSummary(status, threats, approvals) {\n        if (status === \"SAFE\") {\n            return \"No significant security threats detected. Your wallet appears to be in good standing.\";\n        }\n        if (status === \"AT_RISK\") {\n            return `${threats.length} potential security concern(s) detected. Review the identified risks and consider taking action.`;\n        }\n        const drainerThreats = threats.filter((t)=>t.type === \"WALLET_DRAINER\" || t.type === \"PRIVATE_KEY_LEAK\");\n        if (drainerThreats.length > 0) {\n            return ` CRITICAL: This wallet shows signs of compromise. ${drainerThreats.length} drainer/key compromise incident(s) detected. Immediate action required.`;\n        }\n        return ` CRITICAL: ${threats.length} critical security threat(s) detected. Review immediately.`;\n    }\n    generateRecommendations(threats, approvals, status) {\n        const recommendations = [];\n        const maliciousApprovals = approvals.filter((a)=>a.isMalicious);\n        if (maliciousApprovals.length > 0) {\n            recommendations.push({\n                id: \"revoke-malicious\",\n                priority: \"CRITICAL\",\n                category: \"IMMEDIATE\",\n                title: \"Revoke Malicious Approvals IMMEDIATELY\",\n                description: `You have ${maliciousApprovals.length} approval(s) to known malicious contracts.`,\n                actionable: true,\n                actionType: \"REVOKE_APPROVAL\"\n            });\n        }\n        if (threats.some((t)=>t.type === \"WALLET_DRAINER\" || t.type === \"PRIVATE_KEY_LEAK\")) {\n            recommendations.push({\n                id: \"move-assets\",\n                priority: \"CRITICAL\",\n                category: \"IMMEDIATE\",\n                title: \"Transfer Remaining Assets to Fresh Wallet\",\n                description: \"This wallet may be compromised. Move any remaining assets to a NEW wallet immediately.\",\n                actionable: true,\n                actionType: \"TRANSFER_ASSETS\"\n            });\n        }\n        recommendations.push({\n            id: \"regular-audit\",\n            priority: \"LOW\",\n            category: \"LONG_TERM\",\n            title: \"Regular Security Audits\",\n            description: \"Review your wallet approvals and transactions regularly.\",\n            actionable: false\n        });\n        return recommendations;\n    }\n    generateRecoveryPlan(threats, approvals) {\n        const steps = [];\n        let order = 1;\n        const maliciousApprovals = approvals.filter((a)=>a.isMalicious);\n        if (maliciousApprovals.length > 0) {\n            steps.push({\n                order: order++,\n                title: \"Revoke Malicious Approvals\",\n                description: `Immediately revoke ${maliciousApprovals.length} approval(s) to known malicious contracts.`,\n                action: {\n                    type: \"REVOKE_APPROVAL\"\n                },\n                priority: \"IMMEDIATE\"\n            });\n        }\n        const isCompromised = threats.some((t)=>t.type === \"WALLET_DRAINER\" || t.type === \"PRIVATE_KEY_LEAK\" || t.severity === \"CRITICAL\" && t.ongoingRisk);\n        if (isCompromised) {\n            steps.push({\n                order: order++,\n                title: \"Transfer All Remaining Assets\",\n                description: \"Move ALL remaining assets to a new wallet with a fresh seed phrase.\",\n                action: {\n                    type: \"TRANSFER_ASSETS\"\n                },\n                priority: \"IMMEDIATE\"\n            });\n            steps.push({\n                order: order++,\n                title: \"Create New Secure Wallet\",\n                description: \"Generate a completely new wallet. NEVER reuse the old seed phrase.\",\n                action: {\n                    type: \"MANUAL\"\n                },\n                priority: \"HIGH\"\n            });\n        }\n        return {\n            urgencyLevel: isCompromised ? \"CRITICAL\" : \"HIGH\",\n            estimatedTimeMinutes: steps.length * 5,\n            steps,\n            warnings: [\n                \"Never share your seed phrase with anyone\",\n                \"Verify all transaction details before signing\",\n                'Be cautious of \"recovery services\" - they are often scams'\n            ],\n            safeWalletRequired: isCompromised\n        };\n    }\n    generateEducationalContent(threats) {\n        const primaryType = threats[0]?.type || \"UNKNOWN\";\n        const explanations = {\n            WALLET_DRAINER: {\n                whatHappened: \"Your wallet was targeted by a wallet drainer - malicious software designed to steal cryptocurrency.\",\n                howItWorks: \"Drainers work by tricking you into signing malicious transactions or approvals, then using those permissions to transfer your assets.\",\n                ongoingDamage: \"If the attacker has your private key, they can drain any new funds deposited.\",\n                recoverableInfo: \"Assets already stolen cannot be recovered. Focus on protecting remaining assets.\"\n            },\n            PRIVATE_KEY_LEAK: {\n                whatHappened: \"Your private key or seed phrase was likely compromised, giving the attacker full control.\",\n                howItWorks: \"Key leaks happen through phishing, malware, fake wallet apps, or accidentally exposing your key.\",\n                ongoingDamage: \"The attacker has COMPLETE control. Any funds deposited can be stolen instantly.\",\n                recoverableInfo: \"This wallet is permanently compromised. NEVER use it again.\"\n            },\n            APPROVAL_HIJACK: {\n                whatHappened: \"A malicious actor gained permission to spend your tokens through a token approval.\",\n                howItWorks: \"Attackers create fake dApps that request approvals, then use them to steal assets.\",\n                ongoingDamage: \"The attacker can drain approved tokens until you revoke the approval.\",\n                recoverableInfo: \"Revoke the malicious approval immediately.\"\n            }\n        };\n        return {\n            attackExplanation: explanations[primaryType] || {\n                whatHappened: \"Suspicious activity was detected on your wallet.\",\n                howItWorks: \"The specific attack pattern could not be determined.\",\n                ongoingDamage: \"Monitor your wallet closely.\",\n                recoverableInfo: \"Consider moving assets to a fresh wallet.\"\n            },\n            preventionTips: [\n                {\n                    title: \"Never share your seed phrase\",\n                    description: \"No legitimate service will ever ask for it.\",\n                    importance: \"CRITICAL\"\n                },\n                {\n                    title: \"Verify before signing\",\n                    description: \"Read transaction details carefully.\",\n                    importance: \"HIGH\"\n                },\n                {\n                    title: \"Use hardware wallets\",\n                    description: \"Keep high-value assets in cold storage.\",\n                    importance: \"HIGH\"\n                }\n            ],\n            securityChecklist: [\n                {\n                    id: \"1\",\n                    category: \"Wallet\",\n                    item: \"Use hardware wallet\",\n                    completed: false\n                },\n                {\n                    id: \"2\",\n                    category: \"Wallet\",\n                    item: \"Backup seed phrase securely\",\n                    completed: false\n                },\n                {\n                    id: \"3\",\n                    category: \"Approvals\",\n                    item: \"Review approvals regularly\",\n                    completed: false\n                }\n            ]\n        };\n    }\n    generateRevokeTransaction(tokenAddress, spenderAddress) {\n        const iface = new ethers__WEBPACK_IMPORTED_MODULE_4__.Interface([\n            \"function approve(address spender, uint256 amount)\"\n        ]);\n        const data = iface.encodeFunctionData(\"approve\", [\n            spenderAddress,\n            0\n        ]);\n        return {\n            to: tokenAddress,\n            data\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUJBQWlCO1lBQ25CO1lBQ0FJLGdCQUFnQjtnQkFDZDtvQkFBRXZMLE9BQU87b0JBQWdDQyxhQUFhO29CQUErQ3VMLFlBQVk7Z0JBQXdCO2dCQUN6STtvQkFBRXhMLE9BQU87b0JBQXlCQyxhQUFhO29CQUF1Q3VMLFlBQVk7Z0JBQW9CO2dCQUN0SDtvQkFBRXhMLE9BQU87b0JBQXdCQyxhQUFhO29CQUEyQ3VMLFlBQVk7Z0JBQW9CO2FBQzFIO1lBQ0RDLG1CQUFtQjtnQkFDakI7b0JBQUU1TCxJQUFJO29CQUFLc0ssVUFBVTtvQkFBVXVCLE1BQU07b0JBQXVCQyxXQUFXO2dCQUFNO2dCQUM3RTtvQkFBRTlMLElBQUk7b0JBQUtzSyxVQUFVO29CQUFVdUIsTUFBTTtvQkFBK0JDLFdBQVc7Z0JBQU07Z0JBQ3JGO29CQUFFOUwsSUFBSTtvQkFBS3NLLFVBQVU7b0JBQWF1QixNQUFNO29CQUE4QkMsV0FBVztnQkFBTTthQUN4RjtRQUNIO0lBQ0Y7SUFFQUMsMEJBQTBCakUsWUFBb0IsRUFBRWtFLGNBQXNCLEVBQWdDO1FBQ3BHLE1BQU1DLFFBQVEsSUFBSWpRLDZDQUFnQixDQUFDO1lBQUM7U0FBb0Q7UUFDeEYsTUFBTW9ILE9BQU82SSxNQUFNRSxrQkFBa0IsQ0FBQyxXQUFXO1lBQUNIO1lBQWdCO1NBQUU7UUFDcEUsT0FBTztZQUFFMUosSUFBSXdGO1lBQWMxRTtRQUFLO0lBQ2xDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93YWxsZXQtc2VudGluZWwvLi9zcmMvbGliL2FuYWx5emVycy9ldm0tYW5hbHl6ZXIudHM/NGM0ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRVZNIENIQUlOIEFOQUxZWkVSIChFdGhlcmV1bSwgQmFzZSwgQk5CKVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEVuaGFuY2VkIGRldGVjdGlvbiBmb3Igd2FsbGV0IGNvbXByb21pc2UsIGRyYWluZXJzLCBhbmQgYXBwcm92YWwgYWJ1c2UuXG4vLyBBbGwgb3BlcmF0aW9ucyBhcmUgUkVBRC1PTkxZLlxuXG5pbXBvcnQgeyBldGhlcnMgfSBmcm9tICdldGhlcnMnO1xuaW1wb3J0IHtcbiAgQ2hhaW4sXG4gIERldGVjdGVkVGhyZWF0LFxuICBUb2tlbkFwcHJvdmFsLFxuICBTdXNwaWNpb3VzVHJhbnNhY3Rpb24sXG4gIFJpc2tMZXZlbCxcbiAgV2FsbGV0QW5hbHlzaXNSZXN1bHQsXG4gIFNlY3VyaXR5UmVjb21tZW5kYXRpb24sXG4gIFJlY292ZXJ5UGxhbixcbiAgUmVjb3ZlcnlTdGVwLFxuICBBdHRhY2tUeXBlLFxufSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7XG4gIENIQUlOX1JQQ19DT05GSUcsXG4gIGlzTWFsaWNpb3VzQWRkcmVzcyxcbiAgaXNEcmFpbmVyUmVjaXBpZW50LFxuICBpc0luZmluaXRlQXBwcm92YWwsXG4gIGlzTGVnaXRpbWF0ZUNvbnRyYWN0LFxufSBmcm9tICcuLi9kZXRlY3Rpb24vbWFsaWNpb3VzLWRhdGFiYXNlJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIElOVEVSRkFDRVNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmludGVyZmFjZSBUcmFuc2FjdGlvbkRhdGEge1xuICBoYXNoOiBzdHJpbmc7XG4gIGZyb206IHN0cmluZztcbiAgdG86IHN0cmluZztcbiAgdmFsdWU6IHN0cmluZztcbiAgaW5wdXQ6IHN0cmluZztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIGJsb2NrTnVtYmVyOiBudW1iZXI7XG4gIG1ldGhvZElkOiBzdHJpbmc7XG4gIGlzRXJyb3I6IGJvb2xlYW47XG4gIGdhc1VzZWQ/OiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBUb2tlblRyYW5zZmVyIHtcbiAgZnJvbTogc3RyaW5nO1xuICB0bzogc3RyaW5nO1xuICB2YWx1ZTogc3RyaW5nO1xuICBoYXNoOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICB0b2tlblN5bWJvbDogc3RyaW5nO1xuICB0b2tlbkFkZHJlc3M6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEFwcHJvdmFsRXZlbnQge1xuICB0b2tlbjogc3RyaW5nO1xuICB0b2tlbk5hbWU6IHN0cmluZztcbiAgdG9rZW5TeW1ib2w6IHN0cmluZztcbiAgc3BlbmRlcjogc3RyaW5nO1xuICBvd25lcjogc3RyaW5nO1xuICBhbW91bnQ6IHN0cmluZztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG4gIHRyYW5zYWN0aW9uSGFzaDogc3RyaW5nO1xuICBibG9ja051bWJlcjogbnVtYmVyO1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRVZNIEFOQUxZWkVSIENMQVNTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY2xhc3MgRVZNQW5hbHl6ZXIge1xuICBwcml2YXRlIGNoYWluOiBDaGFpbjtcbiAgcHJpdmF0ZSBwcm92aWRlcjogZXRoZXJzLkpzb25ScGNQcm92aWRlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGV4cGxvcmVyQXBpVXJsOiBzdHJpbmc7XG4gIHByaXZhdGUgZXhwbG9yZXJBcGlLZXk6IHN0cmluZztcbiAgcHJpdmF0ZSBycGNVcmxzOiBzdHJpbmdbXTtcbiAgcHJpdmF0ZSBjdXJyZW50UnBjSW5kZXg6IG51bWJlciA9IDA7XG5cbiAgY29uc3RydWN0b3IoY2hhaW46IENoYWluKSB7XG4gICAgaWYgKGNoYWluID09PSAnc29sYW5hJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFVk1BbmFseXplciBkb2VzIG5vdCBzdXBwb3J0IFNvbGFuYS4gVXNlIFNvbGFuYUFuYWx5emVyIGluc3RlYWQuJyk7XG4gICAgfVxuXG4gICAgdGhpcy5jaGFpbiA9IGNoYWluO1xuICAgIGNvbnN0IGNvbmZpZyA9IENIQUlOX1JQQ19DT05GSUdbY2hhaW5dO1xuICAgIHRoaXMucnBjVXJscyA9IGNvbmZpZy5ycGNVcmxzO1xuICAgIHRoaXMuZXhwbG9yZXJBcGlVcmwgPSBjb25maWcuZXhwbG9yZXJBcGk7XG4gICAgdGhpcy5leHBsb3JlckFwaUtleSA9IHByb2Nlc3MuZW52W2Ake2NoYWluLnRvVXBwZXJDYXNlKCl9X0VYUExPUkVSX0FQSV9LRVlgXSB8fCAnJztcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2V0UHJvdmlkZXIoKTogUHJvbWlzZTxldGhlcnMuSnNvblJwY1Byb3ZpZGVyPiB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnJwY1VybHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHJwY0luZGV4ID0gKHRoaXMuY3VycmVudFJwY0luZGV4ICsgaSkgJSB0aGlzLnJwY1VybHMubGVuZ3RoO1xuICAgICAgY29uc3QgcnBjVXJsID0gdGhpcy5ycGNVcmxzW3JwY0luZGV4XTtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgZXRoZXJzLkpzb25ScGNQcm92aWRlcihycGNVcmwsIHVuZGVmaW5lZCwge1xuICAgICAgICAgIHN0YXRpY05ldHdvcms6IHRydWUsXG4gICAgICAgICAgYmF0Y2hNYXhDb3VudDogMSxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBhd2FpdCBQcm9taXNlLnJhY2UoW1xuICAgICAgICAgIHByb3ZpZGVyLmdldEJsb2NrTnVtYmVyKCksXG4gICAgICAgICAgbmV3IFByb21pc2UoKF8sIHJlamVjdCkgPT4gc2V0VGltZW91dCgoKSA9PiByZWplY3QobmV3IEVycm9yKCd0aW1lb3V0JykpLCA1MDAwKSksXG4gICAgICAgIF0pO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jdXJyZW50UnBjSW5kZXggPSBycGNJbmRleDtcbiAgICAgICAgdGhpcy5wcm92aWRlciA9IHByb3ZpZGVyO1xuICAgICAgICByZXR1cm4gcHJvdmlkZXI7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgdGhyb3cgbmV3IEVycm9yKCdBbGwgUlBDIGVuZHBvaW50cyBmYWlsZWQnKTtcbiAgfVxuXG4gIGFzeW5jIGFuYWx5emVXYWxsZXQoYWRkcmVzczogc3RyaW5nKTogUHJvbWlzZTxXYWxsZXRBbmFseXNpc1Jlc3VsdD4ge1xuICAgIGlmICghZXRoZXJzLmlzQWRkcmVzcyhhZGRyZXNzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIEV0aGVyZXVtIGFkZHJlc3MnKTtcbiAgICB9XG5cbiAgICBjb25zdCBub3JtYWxpemVkQWRkcmVzcyA9IGFkZHJlc3MudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCB0aHJlYXRzOiBEZXRlY3RlZFRocmVhdFtdID0gW107XG5cbiAgICAvLyBGZXRjaCBhbGwgZGF0YSBpbiBwYXJhbGxlbFxuICAgIGNvbnN0IFt0cmFuc2FjdGlvbnMsIHRva2VuVHJhbnNmZXJzLCBhcHByb3ZhbEV2ZW50cywgY3VycmVudEJhbGFuY2VdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5mZXRjaFRyYW5zYWN0aW9uSGlzdG9yeShub3JtYWxpemVkQWRkcmVzcyksXG4gICAgICB0aGlzLmZldGNoVG9rZW5UcmFuc2ZlcnMobm9ybWFsaXplZEFkZHJlc3MpLFxuICAgICAgdGhpcy5mZXRjaEFwcHJvdmFsRXZlbnRzKG5vcm1hbGl6ZWRBZGRyZXNzKSxcbiAgICAgIHRoaXMuZmV0Y2hDdXJyZW50QmFsYW5jZShub3JtYWxpemVkQWRkcmVzcyksXG4gICAgXSk7XG5cbiAgICBjb25zb2xlLmxvZyhgW0FOQUxZWkVdICR7bm9ybWFsaXplZEFkZHJlc3N9OiAke3RyYW5zYWN0aW9ucy5sZW5ndGh9IHR4cywgJHt0b2tlblRyYW5zZmVycy5sZW5ndGh9IHRyYW5zZmVycywgJHthcHByb3ZhbEV2ZW50cy5sZW5ndGh9IGFwcHJvdmFscywgYmFsYW5jZTogJHtjdXJyZW50QmFsYW5jZX1gKTtcblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy8gQ09NUFJFSEVOU0lWRSBUSFJFQVQgREVURUNUSU9OXG4gICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICAgIC8vIDEuIERFVEVDVCBDT01QTEVURSBXQUxMRVQgRFJBSU4gKFByaXZhdGUgS2V5IENvbXByb21pc2Ugb3IgRHJhaW5lcilcbiAgICBjb25zdCBkcmFpblRocmVhdCA9IHRoaXMuZGV0ZWN0V2FsbGV0RHJhaW4odHJhbnNhY3Rpb25zLCB0b2tlblRyYW5zZmVycywgY3VycmVudEJhbGFuY2UsIG5vcm1hbGl6ZWRBZGRyZXNzKTtcbiAgICBpZiAoZHJhaW5UaHJlYXQpIHRocmVhdHMucHVzaChkcmFpblRocmVhdCk7XG5cbiAgICAvLyAyLiBERVRFQ1QgS05PV04gTUFMSUNJT1VTIElOVEVSQUNUSU9OU1xuICAgIGNvbnN0IG1hbGljaW91c1RocmVhdHMgPSB0aGlzLmRldGVjdE1hbGljaW91c0ludGVyYWN0aW9ucyh0cmFuc2FjdGlvbnMsIHRva2VuVHJhbnNmZXJzLCBub3JtYWxpemVkQWRkcmVzcyk7XG4gICAgdGhyZWF0cy5wdXNoKC4uLm1hbGljaW91c1RocmVhdHMpO1xuXG4gICAgLy8gMy4gREVURUNUIFNVU1BJQ0lPVVMgQVBQUk9WQUwgUEFUVEVSTlNcbiAgICBjb25zdCBhcHByb3ZhbFRocmVhdHMgPSB0aGlzLmRldGVjdEFwcHJvdmFsQWJ1c2UoYXBwcm92YWxFdmVudHMsIHRva2VuVHJhbnNmZXJzLCBub3JtYWxpemVkQWRkcmVzcyk7XG4gICAgdGhyZWF0cy5wdXNoKC4uLmFwcHJvdmFsVGhyZWF0cyk7XG5cbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIEFOQUxZWkUgQ1VSUkVOVCBBUFBST1ZBTFNcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIFxuICAgIGNvbnN0IGFuYWx5emVkQXBwcm92YWxzID0gdGhpcy5hbmFseXplQXBwcm92YWxzKGFwcHJvdmFsRXZlbnRzKTtcblxuICAgIC8vIEZsYWcgYWN0aXZlIG1hbGljaW91cyBhcHByb3ZhbHNcbiAgICBmb3IgKGNvbnN0IGFwcHJvdmFsIG9mIGFuYWx5emVkQXBwcm92YWxzKSB7XG4gICAgICBpZiAoYXBwcm92YWwuaXNNYWxpY2lvdXMpIHtcbiAgICAgICAgdGhyZWF0cy5wdXNoKHtcbiAgICAgICAgICBpZDogYGFjdGl2ZS1tYWxpY2lvdXMtYXBwcm92YWwtJHthcHByb3ZhbC5pZH1gLFxuICAgICAgICAgIHR5cGU6ICdBUFBST1ZBTF9ISUpBQ0snLFxuICAgICAgICAgIHNldmVyaXR5OiAnQ1JJVElDQUwnLFxuICAgICAgICAgIHRpdGxlOiAnQWN0aXZlIEFwcHJvdmFsIHRvIE1hbGljaW91cyBDb250cmFjdCcsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGBZb3UgaGF2ZSBhbiBhY3RpdmUgYXBwcm92YWwgYWxsb3dpbmcgYSBrbm93biBtYWxpY2lvdXMgY29udHJhY3QgdG8gc3BlbmQgeW91ciAke2FwcHJvdmFsLnRva2VuLnN5bWJvbH0gdG9rZW5zLmAsXG4gICAgICAgICAgdGVjaG5pY2FsRGV0YWlsczogYFNwZW5kZXI6ICR7YXBwcm92YWwuc3BlbmRlcn1gLFxuICAgICAgICAgIGRldGVjdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICByZWxhdGVkQWRkcmVzc2VzOiBbYXBwcm92YWwuc3BlbmRlcl0sXG4gICAgICAgICAgcmVsYXRlZFRyYW5zYWN0aW9uczogW10sXG4gICAgICAgICAgb25nb2luZ1Jpc2s6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy8gQ0FMQ1VMQVRFIFJFU1VMVFNcbiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgY29uc3Qgcmlza1Njb3JlID0gdGhpcy5jYWxjdWxhdGVSaXNrU2NvcmUodGhyZWF0cywgYW5hbHl6ZWRBcHByb3ZhbHMpO1xuICAgIGNvbnN0IHNlY3VyaXR5U3RhdHVzID0gdGhpcy5kZXRlcm1pbmVTZWN1cml0eVN0YXR1cyhyaXNrU2NvcmUsIHRocmVhdHMpO1xuICAgIGNvbnN0IHN1c3BpY2lvdXNUcmFuc2FjdGlvbnMgPSB0aGlzLmJ1aWxkU3VzcGljaW91c1RyYW5zYWN0aW9ucyh0cmFuc2FjdGlvbnMsIHRocmVhdHMpO1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IHRoaXMuZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnModGhyZWF0cywgYW5hbHl6ZWRBcHByb3ZhbHMsIHNlY3VyaXR5U3RhdHVzKTtcbiAgICBjb25zdCByZWNvdmVyeVBsYW4gPSBzZWN1cml0eVN0YXR1cyAhPT0gJ1NBRkUnID8gdGhpcy5nZW5lcmF0ZVJlY292ZXJ5UGxhbih0aHJlYXRzLCBhbmFseXplZEFwcHJvdmFscykgOiB1bmRlZmluZWQ7XG5cbiAgICBjb25zb2xlLmxvZyhgW0FOQUxZWkVdIENvbXBsZXRlZC4gU3RhdHVzOiAke3NlY3VyaXR5U3RhdHVzfSwgU2NvcmU6ICR7cmlza1Njb3JlfSwgVGhyZWF0czogJHt0aHJlYXRzLmxlbmd0aH1gKTtcblxuICAgIHJldHVybiB7XG4gICAgICBhZGRyZXNzOiBub3JtYWxpemVkQWRkcmVzcyxcbiAgICAgIGNoYWluOiB0aGlzLmNoYWluLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBzZWN1cml0eVN0YXR1cyxcbiAgICAgIHJpc2tTY29yZSxcbiAgICAgIHN1bW1hcnk6IHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KHNlY3VyaXR5U3RhdHVzLCB0aHJlYXRzLCBhbmFseXplZEFwcHJvdmFscyksXG4gICAgICBkZXRlY3RlZFRocmVhdHM6IHRocmVhdHMsXG4gICAgICBhcHByb3ZhbHM6IGFuYWx5emVkQXBwcm92YWxzLFxuICAgICAgc3VzcGljaW91c1RyYW5zYWN0aW9ucyxcbiAgICAgIHJlY29tbWVuZGF0aW9ucyxcbiAgICAgIHJlY292ZXJ5UGxhbixcbiAgICAgIGVkdWNhdGlvbmFsQ29udGVudDogdGhpcy5nZW5lcmF0ZUVkdWNhdGlvbmFsQ29udGVudCh0aHJlYXRzKSxcbiAgICB9O1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gQ09SRSBERVRFQ1RJT046IFdBTExFVCBEUkFJTlxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgZGV0ZWN0V2FsbGV0RHJhaW4oXG4gICAgdHJhbnNhY3Rpb25zOiBUcmFuc2FjdGlvbkRhdGFbXSxcbiAgICB0b2tlblRyYW5zZmVyczogVG9rZW5UcmFuc2ZlcltdLFxuICAgIGN1cnJlbnRCYWxhbmNlOiBzdHJpbmcsXG4gICAgdXNlckFkZHJlc3M6IHN0cmluZ1xuICApOiBEZXRlY3RlZFRocmVhdCB8IG51bGwge1xuICAgIC8vIFNraXAgaWYgbm8gYWN0aXZpdHlcbiAgICBpZiAodHJhbnNhY3Rpb25zLmxlbmd0aCA9PT0gMCAmJiB0b2tlblRyYW5zZmVycy5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgLy8gUGFyc2UgY3VycmVudCBiYWxhbmNlXG4gICAgbGV0IGJhbGFuY2VXZWk6IGJpZ2ludDtcbiAgICB0cnkge1xuICAgICAgYmFsYW5jZVdlaSA9IEJpZ0ludChjdXJyZW50QmFsYW5jZSB8fCAnMCcpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgYmFsYW5jZVdlaSA9IEJpZ0ludCgwKTtcbiAgICB9XG5cbiAgICAvLyBDb2xsZWN0IGFsbCBvdXRib3VuZCB0cmFuc2ZlcnNcbiAgICBjb25zdCBvdXRib3VuZFRyYW5zZmVyczogeyB0bzogc3RyaW5nOyBoYXNoOiBzdHJpbmc7IHRpbWVzdGFtcDogbnVtYmVyOyB0eXBlOiBzdHJpbmc7IHZhbHVlOiBzdHJpbmcgfVtdID0gW107XG5cbiAgICAvLyBOYXRpdmUgRVRIIHRyYW5zZmVyc1xuICAgIGZvciAoY29uc3QgdHggb2YgdHJhbnNhY3Rpb25zKSB7XG4gICAgICBpZiAoIXR4Py5mcm9tIHx8ICF0eD8udG8pIGNvbnRpbnVlO1xuICAgICAgaWYgKHR4LmZyb20udG9Mb3dlckNhc2UoKSA9PT0gdXNlckFkZHJlc3MpIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBCaWdJbnQodHgudmFsdWUgfHwgJzAnKTtcbiAgICAgICAgaWYgKHZhbHVlID4gQmlnSW50KDApKSB7XG4gICAgICAgICAgb3V0Ym91bmRUcmFuc2ZlcnMucHVzaCh7XG4gICAgICAgICAgICB0bzogdHgudG8udG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICAgIGhhc2g6IHR4Lmhhc2gsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IHR4LnRpbWVzdGFtcCxcbiAgICAgICAgICAgIHR5cGU6ICduYXRpdmUnLFxuICAgICAgICAgICAgdmFsdWU6IHR4LnZhbHVlLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVG9rZW4gdHJhbnNmZXJzXG4gICAgZm9yIChjb25zdCB0cmFuc2ZlciBvZiB0b2tlblRyYW5zZmVycykge1xuICAgICAgaWYgKCF0cmFuc2Zlcj8uZnJvbSB8fCAhdHJhbnNmZXI/LnRvKSBjb250aW51ZTtcbiAgICAgIGlmICh0cmFuc2Zlci5mcm9tLnRvTG93ZXJDYXNlKCkgPT09IHVzZXJBZGRyZXNzKSB7XG4gICAgICAgIG91dGJvdW5kVHJhbnNmZXJzLnB1c2goe1xuICAgICAgICAgIHRvOiB0cmFuc2Zlci50by50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgIGhhc2g6IHRyYW5zZmVyLmhhc2gsXG4gICAgICAgICAgdGltZXN0YW1wOiB0cmFuc2Zlci50aW1lc3RhbXAsXG4gICAgICAgICAgdHlwZTogYHRva2VuOiR7dHJhbnNmZXIudG9rZW5TeW1ib2x9YCxcbiAgICAgICAgICB2YWx1ZTogdHJhbnNmZXIudmFsdWUsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvdXRib3VuZFRyYW5zZmVycy5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgLy8gQ2hlY2sgaWYgd2FsbGV0IGlzIGN1cnJlbnRseSBlbXB0eSAoZGVmaW5lZCBoZXJlIHNvIGl0J3MgYXZhaWxhYmxlIHRocm91Z2hvdXQgdGhlIGZ1bmN0aW9uKVxuICAgIGNvbnN0IGlzQ3VycmVudGx5RW1wdHkgPSBiYWxhbmNlV2VpIDwgQmlnSW50KCcxMDAwMDAwMDAwMDAwMDAwJyk7IC8vIDwgMC4wMDEgRVRIXG5cbiAgICAvLyBBbmFseXplIG91dGJvdW5kIHBhdHRlcm5cbiAgICBjb25zdCBkZXN0aW5hdGlvbkNvdW50czogUmVjb3JkPHN0cmluZywgeyBjb3VudDogbnVtYmVyOyB0eXBlczogU2V0PHN0cmluZz47IGhhc2hlczogc3RyaW5nW107IHRpbWVzdGFtcHM6IG51bWJlcltdIH0+ID0ge307XG4gICAgXG4gICAgZm9yIChjb25zdCB0cmFuc2ZlciBvZiBvdXRib3VuZFRyYW5zZmVycykge1xuICAgICAgaWYgKCFkZXN0aW5hdGlvbkNvdW50c1t0cmFuc2Zlci50b10pIHtcbiAgICAgICAgZGVzdGluYXRpb25Db3VudHNbdHJhbnNmZXIudG9dID0geyBjb3VudDogMCwgdHlwZXM6IG5ldyBTZXQoKSwgaGFzaGVzOiBbXSwgdGltZXN0YW1wczogW10gfTtcbiAgICAgIH1cbiAgICAgIGRlc3RpbmF0aW9uQ291bnRzW3RyYW5zZmVyLnRvXS5jb3VudCsrO1xuICAgICAgZGVzdGluYXRpb25Db3VudHNbdHJhbnNmZXIudG9dLnR5cGVzLmFkZCh0cmFuc2Zlci50eXBlKTtcbiAgICAgIGRlc3RpbmF0aW9uQ291bnRzW3RyYW5zZmVyLnRvXS5oYXNoZXMucHVzaCh0cmFuc2Zlci5oYXNoKTtcbiAgICAgIGRlc3RpbmF0aW9uQ291bnRzW3RyYW5zZmVyLnRvXS50aW1lc3RhbXBzLnB1c2godHJhbnNmZXIudGltZXN0YW1wKTtcbiAgICB9XG5cbiAgICAvLyBGaW5kIHN1c3BpY2lvdXMgcGF0dGVybnNcbiAgICBmb3IgKGNvbnN0IFtkZXN0aW5hdGlvbiwgZGF0YV0gb2YgT2JqZWN0LmVudHJpZXMoZGVzdGluYXRpb25Db3VudHMpKSB7XG4gICAgICAvLyBTa2lwIGtub3duIGxlZ2l0aW1hdGUgY29udHJhY3RzXG4gICAgICBpZiAoaXNMZWdpdGltYXRlQ29udHJhY3QoZGVzdGluYXRpb24pKSBjb250aW51ZTtcblxuICAgICAgLy8gQ2hlY2sgZm9yIGtub3duIGRyYWluZXJcbiAgICAgIGNvbnN0IGlzTWFsaWNpb3VzID0gaXNNYWxpY2lvdXNBZGRyZXNzKGRlc3RpbmF0aW9uLCB0aGlzLmNoYWluKSB8fCBpc0RyYWluZXJSZWNpcGllbnQoZGVzdGluYXRpb24pO1xuICAgICAgXG4gICAgICAvLyBQQVRURVJOIDE6IE11bHRpcGxlIGRpZmZlcmVudCBhc3NldCB0eXBlcyB0byBzYW1lIGFkZHJlc3NcbiAgICAgIC8vIFRoaXMgaXMgYSBzdHJvbmcgaW5kaWNhdG9yIG9mIGRyYWluIChuYXRpdmUgKyBtdWx0aXBsZSB0b2tlbnMgdG8gc2FtZSBhZGRyZXNzKVxuICAgICAgY29uc3QgaGFzTXVsdGlwbGVBc3NldFR5cGVzID0gZGF0YS50eXBlcy5zaXplID49IDI7XG4gICAgICBjb25zdCBoYXNOYXRpdmVBbmRUb2tlbnMgPSBkYXRhLnR5cGVzLmhhcygnbmF0aXZlJykgJiYgXG4gICAgICAgIEFycmF5LmZyb20oZGF0YS50eXBlcykuc29tZSh0ID0+IHQuc3RhcnRzV2l0aCgndG9rZW46JykpO1xuXG4gICAgICAvLyBQQVRURVJOIDI6IENoZWNrIHRpbWUgY2x1c3RlcmluZyAoYWxsIHdpdGhpbiAzMCBtaW51dGVzKVxuICAgICAgY29uc3QgdGltZXN0YW1wcyA9IGRhdGEudGltZXN0YW1wcy5zb3J0KChhLCBiKSA9PiBhIC0gYik7XG4gICAgICBjb25zdCB0aW1lU3BhbiA9IHRpbWVzdGFtcHMubGVuZ3RoID4gMSA/ICh0aW1lc3RhbXBzW3RpbWVzdGFtcHMubGVuZ3RoIC0gMV0gLSB0aW1lc3RhbXBzWzBdKSA6IDA7XG4gICAgICBjb25zdCBpc1JhcGlkID0gdGltZVNwYW4gPD0gMzAgKiA2MDsgLy8gMzAgbWludXRlc1xuXG4gICAgICAvLyBEZXRlcm1pbmUgdGhyZWF0IGxldmVsXG4gICAgICBpZiAoaXNNYWxpY2lvdXMpIHtcbiAgICAgICAgLy8gQ09ORklSTUVEOiBUcmFuc2ZlcnMgdG8ga25vd24gZHJhaW5lclxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBgZHJhaW4tY29uZmlybWVkLSR7RGF0ZS5ub3coKX1gLFxuICAgICAgICAgIHR5cGU6ICdXQUxMRVRfRFJBSU5FUicsXG4gICAgICAgICAgc2V2ZXJpdHk6ICdDUklUSUNBTCcsXG4gICAgICAgICAgdGl0bGU6ICdBc3NldHMgU2VudCB0byBLbm93biBEcmFpbmVyIEFkZHJlc3MnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHtkYXRhLmNvdW50fSB0cmFuc2ZlcihzKSB3ZXJlIG1hZGUgdG8gYSBrbm93biBkcmFpbmVyL3NjYW0gYWRkcmVzcyAoJHtkZXN0aW5hdGlvbi5zbGljZSgwLCAxMCl9Li4uKS4gWW91ciBhc3NldHMgaGF2ZSBsaWtlbHkgYmVlbiBzdG9sZW4uYCxcbiAgICAgICAgICB0ZWNobmljYWxEZXRhaWxzOiBgRHJhaW5lcjogJHtkZXN0aW5hdGlvbn0sIFRyYW5zZmVyczogJHtkYXRhLmNvdW50fSwgQXNzZXQgdHlwZXM6ICR7QXJyYXkuZnJvbShkYXRhLnR5cGVzKS5qb2luKCcsICcpfWAsXG4gICAgICAgICAgZGV0ZWN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHJlbGF0ZWRBZGRyZXNzZXM6IFtkZXN0aW5hdGlvbl0sXG4gICAgICAgICAgcmVsYXRlZFRyYW5zYWN0aW9uczogZGF0YS5oYXNoZXMuc2xpY2UoMCwgMTApLFxuICAgICAgICAgIG9uZ29pbmdSaXNrOiB0cnVlLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICBpZiAoaGFzTmF0aXZlQW5kVG9rZW5zICYmIGlzUmFwaWQgJiYgZGF0YS5jb3VudCA+PSAyKSB7XG4gICAgICAgIC8vIExJS0VMWSBEUkFJTjogTmF0aXZlICsgdG9rZW5zIHRvIHNhbWUgdW5rbm93biBhZGRyZXNzIHF1aWNrbHlcbiAgICAgICAgY29uc3Qgc2V2ZXJpdHk6IFJpc2tMZXZlbCA9IGlzQ3VycmVudGx5RW1wdHkgPyAnQ1JJVElDQUwnIDogJ0hJR0gnO1xuICAgICAgICBjb25zdCB0aHJlYXRUeXBlOiBBdHRhY2tUeXBlID0gaXNDdXJyZW50bHlFbXB0eSA/ICdQUklWQVRFX0tFWV9MRUFLJyA6ICdXQUxMRVRfRFJBSU5FUic7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBgZHJhaW4tcGF0dGVybi0ke0RhdGUubm93KCl9YCxcbiAgICAgICAgICB0eXBlOiB0aHJlYXRUeXBlLFxuICAgICAgICAgIHNldmVyaXR5LFxuICAgICAgICAgIHRpdGxlOiBpc0N1cnJlbnRseUVtcHR5ID8gJ1dhbGxldCBBcHBlYXJzIERyYWluZWQgLSBQb3NzaWJsZSBLZXkgQ29tcHJvbWlzZScgOiAnU3VzcGljaW91cyBBc3NldCBUcmFuc2ZlciBQYXR0ZXJuJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7ZGF0YS5jb3VudH0gZGlmZmVyZW50IGFzc2V0cyAoRVRIICsgdG9rZW5zKSB3ZXJlIHNlbnQgdG8gdGhlIHNhbWUgYWRkcmVzcyAoJHtkZXN0aW5hdGlvbi5zbGljZSgwLCAxMCl9Li4uKSB3aXRoaW4gJHtNYXRoLmNlaWwodGltZVNwYW4gLyA2MCl9IG1pbnV0ZXMuJHtpc0N1cnJlbnRseUVtcHR5ID8gJyBZb3VyIHdhbGxldCBiYWxhbmNlIGlzIG5vdyBuZWFybHkgemVyby4nIDogJyd9IFRoaXMgcGF0dGVybiBpcyBjb25zaXN0ZW50IHdpdGggd2FsbGV0IGRyYWluZXIgYWN0aXZpdHkgb3IgcHJpdmF0ZSBrZXkgY29tcHJvbWlzZS5gLFxuICAgICAgICAgIHRlY2huaWNhbERldGFpbHM6IGBEZXN0aW5hdGlvbjogJHtkZXN0aW5hdGlvbn0sIFRpbWUgc3BhbjogJHtNYXRoLmNlaWwodGltZVNwYW4gLyA2MCl9IG1pbnV0ZXMsIEFzc2V0czogJHtBcnJheS5mcm9tKGRhdGEudHlwZXMpLmpvaW4oJywgJyl9YCxcbiAgICAgICAgICBkZXRlY3RlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgcmVsYXRlZEFkZHJlc3NlczogW2Rlc3RpbmF0aW9uXSxcbiAgICAgICAgICByZWxhdGVkVHJhbnNhY3Rpb25zOiBkYXRhLmhhc2hlcy5zbGljZSgwLCAxMCksXG4gICAgICAgICAgb25nb2luZ1Jpc2s6IGlzQ3VycmVudGx5RW1wdHksXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGlmIChkYXRhLmNvdW50ID49IDUgJiYgaXNSYXBpZCkge1xuICAgICAgICAvLyBTVVNQSUNJT1VTOiBNYW55IHRyYW5zZmVycyB0byBzYW1lIGFkZHJlc3MgcXVpY2tseVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBgc3VzcGljaW91cy1vdXRmbG93LSR7RGF0ZS5ub3coKX1gLFxuICAgICAgICAgIHR5cGU6ICdXQUxMRVRfRFJBSU5FUicsXG4gICAgICAgICAgc2V2ZXJpdHk6ICdISUdIJyxcbiAgICAgICAgICB0aXRsZTogJ1JhcGlkIEFzc2V0IE91dGZsb3cgRGV0ZWN0ZWQnLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHtkYXRhLmNvdW50fSB0cmFuc2ZlcnMgdG8gdGhlIHNhbWUgYWRkcmVzcyAoJHtkZXN0aW5hdGlvbi5zbGljZSgwLCAxMCl9Li4uKSB3aXRoaW4gYSBzaG9ydCB0aW1lIHBlcmlvZC4gUmV2aWV3IHRoZXNlIHRyYW5zYWN0aW9ucyBjYXJlZnVsbHkuYCxcbiAgICAgICAgICB0ZWNobmljYWxEZXRhaWxzOiBgRGVzdGluYXRpb246ICR7ZGVzdGluYXRpb259LCBUcmFuc2ZlcnM6ICR7ZGF0YS5jb3VudH1gLFxuICAgICAgICAgIGRldGVjdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICByZWxhdGVkQWRkcmVzc2VzOiBbZGVzdGluYXRpb25dLFxuICAgICAgICAgIHJlbGF0ZWRUcmFuc2FjdGlvbnM6IGRhdGEuaGFzaGVzLnNsaWNlKDAsIDEwKSxcbiAgICAgICAgICBvbmdvaW5nUmlzazogZmFsc2UsXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUEFUVEVSTiA0OiBDaGVjayBpZiB3YWxsZXQgd2FzIGZ1bmRlZCBhbmQgaXMgbm93IGVtcHR5IChnZW5lcmFsIGRyYWluIGluZGljYXRvcilcbiAgICBpZiAoaXNDdXJyZW50bHlFbXB0eSAmJiB0cmFuc2FjdGlvbnMubGVuZ3RoID4gNSkge1xuICAgICAgLy8gQ2FsY3VsYXRlIHRvdGFsIHJlY2VpdmVkXG4gICAgICBsZXQgdG90YWxSZWNlaXZlZCA9IEJpZ0ludCgwKTtcbiAgICAgIGZvciAoY29uc3QgdHggb2YgdHJhbnNhY3Rpb25zKSB7XG4gICAgICAgIGlmICghdHg/LnRvKSBjb250aW51ZTtcbiAgICAgICAgaWYgKHR4LnRvLnRvTG93ZXJDYXNlKCkgPT09IHVzZXJBZGRyZXNzKSB7XG4gICAgICAgICAgdG90YWxSZWNlaXZlZCArPSBCaWdJbnQodHgudmFsdWUgfHwgJzAnKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBJZiB3YWxsZXQgcmVjZWl2ZWQgc2lnbmlmaWNhbnQgZnVuZHMgYnV0IGlzIG5vdyBlbXB0eVxuICAgICAgaWYgKHRvdGFsUmVjZWl2ZWQgPiBCaWdJbnQoJzEwMDAwMDAwMDAwMDAwMDAwMCcpKSB7IC8vID4gMC4xIEVUSCByZWNlaXZlZFxuICAgICAgICAvLyBGaW5kIHRoZSBtYWluIGRlc3RpbmF0aW9uXG4gICAgICAgIGNvbnN0IHNvcnRlZERlc3RzID0gT2JqZWN0LmVudHJpZXMoZGVzdGluYXRpb25Db3VudHMpXG4gICAgICAgICAgLmZpbHRlcigoW2FkZHJdKSA9PiAhaXNMZWdpdGltYXRlQ29udHJhY3QoYWRkcikpXG4gICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGJbMV0uY291bnQgLSBhWzFdLmNvdW50KTtcblxuICAgICAgICBpZiAoc29ydGVkRGVzdHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IFt0b3BEZXN0LCB0b3BEYXRhXSA9IHNvcnRlZERlc3RzWzBdO1xuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogYHdhbGxldC1lbXB0aWVkLSR7RGF0ZS5ub3coKX1gLFxuICAgICAgICAgICAgdHlwZTogJ1dBTExFVF9EUkFJTkVSJyxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnSElHSCcsXG4gICAgICAgICAgICB0aXRsZTogJ1dhbGxldCBIYXMgQmVlbiBFbXB0aWVkJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgVGhpcyB3YWxsZXQgcmVjZWl2ZWQgJHtldGhlcnMuZm9ybWF0RXRoZXIodG90YWxSZWNlaXZlZCl9IEVUSCBidXQgaXMgbm93IG5lYXJseSBlbXB0eS4gTW9zdCBhc3NldHMgd2VyZSBzZW50IHRvICR7dG9wRGVzdC5zbGljZSgwLCAxMCl9Li4uYCxcbiAgICAgICAgICAgIHRlY2huaWNhbERldGFpbHM6IGBQcmltYXJ5IGRlc3RpbmF0aW9uOiAke3RvcERlc3R9LCBUcmFuc2ZlcnM6ICR7dG9wRGF0YS5jb3VudH1gLFxuICAgICAgICAgICAgZGV0ZWN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgcmVsYXRlZEFkZHJlc3NlczogW3RvcERlc3RdLFxuICAgICAgICAgICAgcmVsYXRlZFRyYW5zYWN0aW9uczogdG9wRGF0YS5oYXNoZXMuc2xpY2UoMCwgMTApLFxuICAgICAgICAgICAgb25nb2luZ1Jpc2s6IGZhbHNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIERFVEVDVElPTjogTUFMSUNJT1VTIENPTlRSQUNUIElOVEVSQUNUSU9OU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgZGV0ZWN0TWFsaWNpb3VzSW50ZXJhY3Rpb25zKFxuICAgIHRyYW5zYWN0aW9uczogVHJhbnNhY3Rpb25EYXRhW10sXG4gICAgdG9rZW5UcmFuc2ZlcnM6IFRva2VuVHJhbnNmZXJbXSxcbiAgICB1c2VyQWRkcmVzczogc3RyaW5nXG4gICk6IERldGVjdGVkVGhyZWF0W10ge1xuICAgIGNvbnN0IHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10gPSBbXTtcbiAgICBjb25zdCBmbGFnZ2VkQWRkcmVzc2VzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cbiAgICAvLyBDaGVjayB0cmFuc2FjdGlvbnNcbiAgICBmb3IgKGNvbnN0IHR4IG9mIHRyYW5zYWN0aW9ucykge1xuICAgICAgaWYgKCF0eD8udG8gfHwgIXR4Py5mcm9tIHx8ICF0eD8uaGFzaCkgY29udGludWU7XG4gICAgICBcbiAgICAgIGNvbnN0IGludGVyYWN0ZWRXaXRoID0gdHguZnJvbS50b0xvd2VyQ2FzZSgpID09PSB1c2VyQWRkcmVzcyA/IHR4LnRvIDogdHguZnJvbTtcbiAgICAgIGNvbnN0IG1hbGljaW91cyA9IGlzTWFsaWNpb3VzQWRkcmVzcyhpbnRlcmFjdGVkV2l0aCwgdGhpcy5jaGFpbik7XG4gICAgICBcbiAgICAgIGlmIChtYWxpY2lvdXMgJiYgIWZsYWdnZWRBZGRyZXNzZXMuaGFzKGludGVyYWN0ZWRXaXRoLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgIGZsYWdnZWRBZGRyZXNzZXMuYWRkKGludGVyYWN0ZWRXaXRoLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICB0aHJlYXRzLnB1c2goe1xuICAgICAgICAgIGlkOiBgbWFsaWNpb3VzLXR4LSR7dHguaGFzaH1gLFxuICAgICAgICAgIHR5cGU6IG1hbGljaW91cy50eXBlIHx8ICdXQUxMRVRfRFJBSU5FUicsXG4gICAgICAgICAgc2V2ZXJpdHk6ICdDUklUSUNBTCcsXG4gICAgICAgICAgdGl0bGU6IGBJbnRlcmFjdGlvbiB3aXRoICR7bWFsaWNpb3VzLm5hbWUgfHwgJ0tub3duIE1hbGljaW91cyBDb250cmFjdCd9YCxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogYFRoaXMgd2FsbGV0IGludGVyYWN0ZWQgd2l0aCBcIiR7bWFsaWNpb3VzLm5hbWUgfHwgJ2Ega25vd24gbWFsaWNpb3VzIGNvbnRyYWN0J31cIi4gVGhpcyBpcyBhIGNvbmZpcm1lZCB0aHJlYXQuYCxcbiAgICAgICAgICB0ZWNobmljYWxEZXRhaWxzOiBgQ29udHJhY3Q6ICR7aW50ZXJhY3RlZFdpdGh9LCBUWDogJHt0eC5oYXNofWAsXG4gICAgICAgICAgZGV0ZWN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIHJlbGF0ZWRBZGRyZXNzZXM6IFtpbnRlcmFjdGVkV2l0aF0sXG4gICAgICAgICAgcmVsYXRlZFRyYW5zYWN0aW9uczogW3R4Lmhhc2hdLFxuICAgICAgICAgIG9uZ29pbmdSaXNrOiB0cnVlLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDaGVjayB0b2tlbiB0cmFuc2ZlcnNcbiAgICBmb3IgKGNvbnN0IHRyYW5zZmVyIG9mIHRva2VuVHJhbnNmZXJzKSB7XG4gICAgICBpZiAoIXRyYW5zZmVyPy50byB8fCAhdHJhbnNmZXI/LmZyb20gfHwgIXRyYW5zZmVyPy5oYXNoKSBjb250aW51ZTtcbiAgICAgIFxuICAgICAgY29uc3QgZGVzdGluYXRpb24gPSB0cmFuc2Zlci50by50b0xvd2VyQ2FzZSgpO1xuICAgICAgaWYgKGZsYWdnZWRBZGRyZXNzZXMuaGFzKGRlc3RpbmF0aW9uKSkgY29udGludWU7XG4gICAgICBcbiAgICAgIGlmICh0cmFuc2Zlci5mcm9tLnRvTG93ZXJDYXNlKCkgPT09IHVzZXJBZGRyZXNzKSB7XG4gICAgICAgIGNvbnN0IGlzTWFsaWNpb3VzID0gaXNNYWxpY2lvdXNBZGRyZXNzKGRlc3RpbmF0aW9uLCB0aGlzLmNoYWluKSB8fCBpc0RyYWluZXJSZWNpcGllbnQoZGVzdGluYXRpb24pO1xuICAgICAgICBpZiAoaXNNYWxpY2lvdXMpIHtcbiAgICAgICAgICBmbGFnZ2VkQWRkcmVzc2VzLmFkZChkZXN0aW5hdGlvbik7XG4gICAgICAgICAgdGhyZWF0cy5wdXNoKHtcbiAgICAgICAgICAgIGlkOiBgbWFsaWNpb3VzLXRyYW5zZmVyLSR7dHJhbnNmZXIuaGFzaH1gLFxuICAgICAgICAgICAgdHlwZTogJ1dBTExFVF9EUkFJTkVSJyxcbiAgICAgICAgICAgIHNldmVyaXR5OiAnQ1JJVElDQUwnLFxuICAgICAgICAgICAgdGl0bGU6ICdUb2tlbnMgU2VudCB0byBLbm93biBNYWxpY2lvdXMgQWRkcmVzcycsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYCR7dHJhbnNmZXIudG9rZW5TeW1ib2x9IHRva2VucyB3ZXJlIHNlbnQgdG8gYSBrbm93biBkcmFpbmVyIGFkZHJlc3MuYCxcbiAgICAgICAgICAgIHRlY2huaWNhbERldGFpbHM6IGBEZXN0aW5hdGlvbjogJHtkZXN0aW5hdGlvbn0sIFRva2VuOiAke3RyYW5zZmVyLnRva2VuU3ltYm9sfWAsXG4gICAgICAgICAgICBkZXRlY3RlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICAgICAgICByZWxhdGVkQWRkcmVzc2VzOiBbZGVzdGluYXRpb25dLFxuICAgICAgICAgICAgcmVsYXRlZFRyYW5zYWN0aW9uczogW3RyYW5zZmVyLmhhc2hdLFxuICAgICAgICAgICAgb25nb2luZ1Jpc2s6IHRydWUsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhyZWF0cztcbiAgfVxuXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIERFVEVDVElPTjogQVBQUk9WQUwgQUJVU0VcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBwcml2YXRlIGRldGVjdEFwcHJvdmFsQWJ1c2UoXG4gICAgYXBwcm92YWxFdmVudHM6IEFwcHJvdmFsRXZlbnRbXSxcbiAgICB0b2tlblRyYW5zZmVyczogVG9rZW5UcmFuc2ZlcltdLFxuICAgIHVzZXJBZGRyZXNzOiBzdHJpbmdcbiAgKTogRGV0ZWN0ZWRUaHJlYXRbXSB7XG4gICAgY29uc3QgdGhyZWF0czogRGV0ZWN0ZWRUaHJlYXRbXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBhcHByb3ZhbCBvZiBhcHByb3ZhbEV2ZW50cykge1xuICAgICAgaWYgKCFhcHByb3ZhbD8uc3BlbmRlcikgY29udGludWU7XG5cbiAgICAgIGNvbnN0IHNwZW5kZXJNYWxpY2lvdXMgPSBpc01hbGljaW91c0FkZHJlc3MoYXBwcm92YWwuc3BlbmRlciwgdGhpcy5jaGFpbikgfHwgaXNEcmFpbmVyUmVjaXBpZW50KGFwcHJvdmFsLnNwZW5kZXIpO1xuICAgICAgXG4gICAgICBpZiAoc3BlbmRlck1hbGljaW91cykge1xuICAgICAgICB0aHJlYXRzLnB1c2goe1xuICAgICAgICAgIGlkOiBgYXBwcm92YWwtYWJ1c2UtJHthcHByb3ZhbC50cmFuc2FjdGlvbkhhc2h9YCxcbiAgICAgICAgICB0eXBlOiAnQVBQUk9WQUxfSElKQUNLJyxcbiAgICAgICAgICBzZXZlcml0eTogJ0NSSVRJQ0FMJyxcbiAgICAgICAgICB0aXRsZTogJ0FwcHJvdmFsIEdyYW50ZWQgdG8gTWFsaWNpb3VzIENvbnRyYWN0JyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogYFlvdSBhcHByb3ZlZCBhIGtub3duIG1hbGljaW91cyBjb250cmFjdCB0byBzcGVuZCB5b3VyICR7YXBwcm92YWwudG9rZW5TeW1ib2wgfHwgJ3Rva2Vucyd9LiBUaGlzIG1heSBoYXZlIGJlZW4gdXNlZCB0byBkcmFpbiB5b3VyIGFzc2V0cy5gLFxuICAgICAgICAgIHRlY2huaWNhbERldGFpbHM6IGBTcGVuZGVyOiAke2FwcHJvdmFsLnNwZW5kZXJ9LCBUb2tlbjogJHthcHByb3ZhbC50b2tlbn1gLFxuICAgICAgICAgIGRldGVjdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICByZWxhdGVkQWRkcmVzc2VzOiBbYXBwcm92YWwuc3BlbmRlcl0sXG4gICAgICAgICAgcmVsYXRlZFRyYW5zYWN0aW9uczogW2FwcHJvdmFsLnRyYW5zYWN0aW9uSGFzaF0sXG4gICAgICAgICAgb25nb2luZ1Jpc2s6IHRydWUsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aHJlYXRzO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gREFUQSBGRVRDSElOR1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hUcmFuc2FjdGlvbkhpc3RvcnkoYWRkcmVzczogc3RyaW5nKTogUHJvbWlzZTxUcmFuc2FjdGlvbkRhdGFbXT4ge1xuICAgIGNvbnN0IHNvdXJjZXMgPSBbXG4gICAgICAoKSA9PiB0aGlzLmZldGNoRnJvbUJsb2Nrc2NvdXQoYWRkcmVzcyksXG4gICAgICAoKSA9PiB0aGlzLmZldGNoRnJvbUV0aGVyc2NhbihhZGRyZXNzKSxcbiAgICBdO1xuXG4gICAgZm9yIChjb25zdCBmZXRjaEZuIG9mIHNvdXJjZXMpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZldGNoRm4oKTtcbiAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFtGRVRDSF0gR290ICR7cmVzdWx0Lmxlbmd0aH0gdHJhbnNhY3Rpb25zYCk7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1tGRVRDSF0gU291cmNlIGZhaWxlZCwgdHJ5aW5nIG5leHQuLi4nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnW0ZFVENIXSBBbGwgc291cmNlcyBmYWlsZWQgZm9yIHRyYW5zYWN0aW9ucycpO1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hGcm9tRXRoZXJzY2FuKGFkZHJlc3M6IHN0cmluZyk6IFByb21pc2U8VHJhbnNhY3Rpb25EYXRhW10+IHtcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmV4cGxvcmVyQXBpVXJsfT9tb2R1bGU9YWNjb3VudCZhY3Rpb249dHhsaXN0JmFkZHJlc3M9JHthZGRyZXNzfSZzdGFydGJsb2NrPTAmZW5kYmxvY2s9OTk5OTk5OTkmc29ydD1kZXNjJmFwaWtleT0ke3RoaXMuZXhwbG9yZXJBcGlLZXl9YDtcbiAgICBcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgeyBcbiAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCgxNTAwMCksXG4gICAgICBoZWFkZXJzOiB7ICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicgfVxuICAgIH0pO1xuICAgIFxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICBpZiAoZGF0YS5zdGF0dXMgIT09ICcxJyB8fCAhQXJyYXkuaXNBcnJheShkYXRhLnJlc3VsdCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihkYXRhLm1lc3NhZ2UgfHwgJ0FQSSBlcnJvcicpO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhLnJlc3VsdC5zbGljZSgwLCAyMDApLmZpbHRlcigodHg6IGFueSkgPT4gdHg/Lmhhc2gpLm1hcCgodHg6IGFueSkgPT4gKHtcbiAgICAgIGhhc2g6IHR4Lmhhc2gsXG4gICAgICBmcm9tOiAodHguZnJvbSB8fCAnJykudG9Mb3dlckNhc2UoKSxcbiAgICAgIHRvOiAodHgudG8gfHwgJycpLnRvTG93ZXJDYXNlKCksXG4gICAgICB2YWx1ZTogdHgudmFsdWUgfHwgJzAnLFxuICAgICAgaW5wdXQ6IHR4LmlucHV0IHx8ICcweCcsXG4gICAgICB0aW1lc3RhbXA6IHBhcnNlSW50KHR4LnRpbWVTdGFtcCkgfHwgMCxcbiAgICAgIGJsb2NrTnVtYmVyOiBwYXJzZUludCh0eC5ibG9ja051bWJlcikgfHwgMCxcbiAgICAgIG1ldGhvZElkOiAodHguaW5wdXQgfHwgJycpLnNsaWNlKDAsIDEwKSB8fCAnMHgnLFxuICAgICAgaXNFcnJvcjogdHguaXNFcnJvciA9PT0gJzEnLFxuICAgICAgZ2FzVXNlZDogdHguZ2FzVXNlZCxcbiAgICB9KSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGZldGNoRnJvbUJsb2Nrc2NvdXQoYWRkcmVzczogc3RyaW5nKTogUHJvbWlzZTxUcmFuc2FjdGlvbkRhdGFbXT4ge1xuICAgIGxldCBiYXNlVXJsID0gJyc7XG4gICAgXG4gICAgaWYgKHRoaXMuY2hhaW4gPT09ICdldGhlcmV1bScpIHtcbiAgICAgIGJhc2VVcmwgPSAnaHR0cHM6Ly9ldGguYmxvY2tzY291dC5jb20vYXBpL3YyJztcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2hhaW4gPT09ICdiYXNlJykge1xuICAgICAgYmFzZVVybCA9ICdodHRwczovL2Jhc2UuYmxvY2tzY291dC5jb20vYXBpL3YyJztcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2hhaW4gPT09ICdibmInKSB7XG4gICAgICBiYXNlVXJsID0gJ2h0dHBzOi8vYnNjLmJsb2Nrc2NvdXQuY29tL2FwaS92Mic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2hhaW4gbm90IHN1cHBvcnRlZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHVybCA9IGAke2Jhc2VVcmx9L2FkZHJlc3Nlcy8ke2FkZHJlc3N9L3RyYW5zYWN0aW9uc2A7XG4gICAgY29uc29sZS5sb2coYFtGRVRDSF0gVHJ5aW5nIEJsb2Nrc2NvdXQ6ICR7dXJsfWApO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7IFxuICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDIwMDAwKSxcbiAgICAgIGhlYWRlcnM6IHsgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJywgJ1VzZXItQWdlbnQnOiAnV2FsbGV0U2VudGluZWwvMS4wJyB9XG4gICAgfSk7XG4gICAgXG4gICAgaWYgKCFyZXNwb25zZS5vaykgdGhyb3cgbmV3IEVycm9yKGBCbG9ja3Njb3V0IGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICBcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnNvbGUubG9nKGBbRkVUQ0hdIEJsb2Nrc2NvdXQgcmV0dXJuZWQgJHtkYXRhLml0ZW1zPy5sZW5ndGggfHwgMH0gaXRlbXNgKTtcblxuICAgIGlmICghZGF0YS5pdGVtcyB8fCAhQXJyYXkuaXNBcnJheShkYXRhLml0ZW1zKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBpdGVtcycpO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhLml0ZW1zLnNsaWNlKDAsIDIwMCkuZmlsdGVyKCh0eDogYW55KSA9PiB0eD8uaGFzaCkubWFwKCh0eDogYW55KSA9PiB7XG4gICAgICBjb25zdCBmcm9tQWRkciA9IHR5cGVvZiB0eC5mcm9tID09PSAnb2JqZWN0JyA/IHR4LmZyb20/Lmhhc2ggOiB0eC5mcm9tO1xuICAgICAgY29uc3QgdG9BZGRyID0gdHlwZW9mIHR4LnRvID09PSAnb2JqZWN0JyA/IHR4LnRvPy5oYXNoIDogdHgudG87XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGhhc2g6IHR4Lmhhc2gsXG4gICAgICAgIGZyb206IChmcm9tQWRkciB8fCAnJykudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgdG86ICh0b0FkZHIgfHwgJycpLnRvTG93ZXJDYXNlKCksXG4gICAgICAgIHZhbHVlOiB0eC52YWx1ZSB8fCAnMCcsXG4gICAgICAgIGlucHV0OiB0eC5yYXdfaW5wdXQgfHwgdHguaW5wdXQgfHwgJzB4JyxcbiAgICAgICAgdGltZXN0YW1wOiB0eC50aW1lc3RhbXAgPyBNYXRoLmZsb29yKG5ldyBEYXRlKHR4LnRpbWVzdGFtcCkuZ2V0VGltZSgpIC8gMTAwMCkgOiAwLFxuICAgICAgICBibG9ja051bWJlcjogdHguYmxvY2tfbnVtYmVyIHx8IHR4LmJsb2NrIHx8IDAsXG4gICAgICAgIG1ldGhvZElkOiB0eC5tZXRob2QgfHwgKHR4LnJhd19pbnB1dD8uc2xpY2UoMCwgMTApIHx8ICcweCcpLFxuICAgICAgICBpc0Vycm9yOiB0eC5zdGF0dXMgPT09ICdlcnJvcicsXG4gICAgICAgIGdhc1VzZWQ6IHR4Lmdhc191c2VkPy50b1N0cmluZygpIHx8ICcwJyxcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGZldGNoVG9rZW5UcmFuc2ZlcnMoYWRkcmVzczogc3RyaW5nKTogUHJvbWlzZTxUb2tlblRyYW5zZmVyW10+IHtcbiAgICBjb25zdCBzb3VyY2VzID0gW1xuICAgICAgKCkgPT4gdGhpcy5mZXRjaFRva2Vuc0Zyb21CbG9ja3Njb3V0KGFkZHJlc3MpLFxuICAgICAgKCkgPT4gdGhpcy5mZXRjaFRva2Vuc0Zyb21FdGhlcnNjYW4oYWRkcmVzcyksXG4gICAgXTtcblxuICAgIGZvciAoY29uc3QgZmV0Y2hGbiBvZiBzb3VyY2VzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmZXRjaEZuKCk7XG4gICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGBbRkVUQ0hdIEdvdCAke3Jlc3VsdC5sZW5ndGh9IHRva2VuIHRyYW5zZmVyc2ApO1xuICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdbRkVUQ0hdIFRva2VuIHNvdXJjZSBmYWlsZWQsIHRyeWluZyBuZXh0Li4uJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ1tGRVRDSF0gQWxsIHRva2VuIHNvdXJjZXMgZXhoYXVzdGVkJyk7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaFRva2Vuc0Zyb21FdGhlcnNjYW4oYWRkcmVzczogc3RyaW5nKTogUHJvbWlzZTxUb2tlblRyYW5zZmVyW10+IHtcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmV4cGxvcmVyQXBpVXJsfT9tb2R1bGU9YWNjb3VudCZhY3Rpb249dG9rZW50eCZhZGRyZXNzPSR7YWRkcmVzc30mc3RhcnRibG9jaz0wJmVuZGJsb2NrPTk5OTk5OTk5JnNvcnQ9ZGVzYyZhcGlrZXk9JHt0aGlzLmV4cGxvcmVyQXBpS2V5fWA7XG4gICAgXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHsgXG4gICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQoMTUwMDApLFxuICAgICAgaGVhZGVyczogeyAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cbiAgICB9KTtcbiAgICBcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgaWYgKGRhdGEuc3RhdHVzICE9PSAnMScgfHwgIUFycmF5LmlzQXJyYXkoZGF0YS5yZXN1bHQpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHRva2VuIHRyYW5zZmVycycpO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhLnJlc3VsdC5zbGljZSgwLCAyMDApLmZpbHRlcigodHg6IGFueSkgPT4gdHg/Lmhhc2gpLm1hcCgodHg6IGFueSkgPT4gKHtcbiAgICAgIGZyb206ICh0eC5mcm9tIHx8ICcnKS50b0xvd2VyQ2FzZSgpLFxuICAgICAgdG86ICh0eC50byB8fCAnJykudG9Mb3dlckNhc2UoKSxcbiAgICAgIHZhbHVlOiB0eC52YWx1ZSB8fCAnMCcsXG4gICAgICBoYXNoOiB0eC5oYXNoLFxuICAgICAgdGltZXN0YW1wOiBwYXJzZUludCh0eC50aW1lU3RhbXApIHx8IDAsXG4gICAgICB0b2tlblN5bWJvbDogdHgudG9rZW5TeW1ib2wgfHwgJ1VOS05PV04nLFxuICAgICAgdG9rZW5BZGRyZXNzOiAodHguY29udHJhY3RBZGRyZXNzIHx8ICcnKS50b0xvd2VyQ2FzZSgpLFxuICAgIH0pKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hUb2tlbnNGcm9tQmxvY2tzY291dChhZGRyZXNzOiBzdHJpbmcpOiBQcm9taXNlPFRva2VuVHJhbnNmZXJbXT4ge1xuICAgIGxldCBiYXNlVXJsID0gJyc7XG4gICAgXG4gICAgaWYgKHRoaXMuY2hhaW4gPT09ICdldGhlcmV1bScpIHtcbiAgICAgIGJhc2VVcmwgPSAnaHR0cHM6Ly9ldGguYmxvY2tzY291dC5jb20vYXBpL3YyJztcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2hhaW4gPT09ICdiYXNlJykge1xuICAgICAgYmFzZVVybCA9ICdodHRwczovL2Jhc2UuYmxvY2tzY291dC5jb20vYXBpL3YyJztcbiAgICB9IGVsc2UgaWYgKHRoaXMuY2hhaW4gPT09ICdibmInKSB7XG4gICAgICBiYXNlVXJsID0gJ2h0dHBzOi8vYnNjLmJsb2Nrc2NvdXQuY29tL2FwaS92Mic7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2hhaW4gbm90IHN1cHBvcnRlZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHVybCA9IGAke2Jhc2VVcmx9L2FkZHJlc3Nlcy8ke2FkZHJlc3N9L3Rva2VuLXRyYW5zZmVyc2A7XG4gICAgXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHsgXG4gICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQoMTUwMDApLFxuICAgICAgaGVhZGVyczogeyAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLCAnVXNlci1BZ2VudCc6ICdXYWxsZXRTZW50aW5lbC8xLjAnIH1cbiAgICB9KTtcbiAgICBcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB0aHJvdyBuZXcgRXJyb3IoYEJsb2Nrc2NvdXQgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgIFxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG5cbiAgICBpZiAoIWRhdGEuaXRlbXMgfHwgIUFycmF5LmlzQXJyYXkoZGF0YS5pdGVtcykpIHJldHVybiBbXTtcblxuICAgIHJldHVybiBkYXRhLml0ZW1zLnNsaWNlKDAsIDIwMCkuZmlsdGVyKCh0eDogYW55KSA9PiB0eD8udHhfaGFzaCkubWFwKCh0eDogYW55KSA9PiAoe1xuICAgICAgZnJvbTogKHR4LmZyb20/Lmhhc2ggfHwgJycpLnRvTG93ZXJDYXNlKCksXG4gICAgICB0bzogKHR4LnRvPy5oYXNoIHx8ICcnKS50b0xvd2VyQ2FzZSgpLFxuICAgICAgdmFsdWU6IHR4LnRvdGFsPy52YWx1ZSB8fCAnMCcsXG4gICAgICBoYXNoOiB0eC50eF9oYXNoLFxuICAgICAgdGltZXN0YW1wOiB0eC50aW1lc3RhbXAgPyBNYXRoLmZsb29yKG5ldyBEYXRlKHR4LnRpbWVzdGFtcCkuZ2V0VGltZSgpIC8gMTAwMCkgOiAwLFxuICAgICAgdG9rZW5TeW1ib2w6IHR4LnRva2VuPy5zeW1ib2wgfHwgJ1VOS05PV04nLFxuICAgICAgdG9rZW5BZGRyZXNzOiAodHgudG9rZW4/LmFkZHJlc3MgfHwgJycpLnRvTG93ZXJDYXNlKCksXG4gICAgfSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaEN1cnJlbnRCYWxhbmNlKGFkZHJlc3M6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBiYXNlVXJsID0gJyc7XG4gICAgICBpZiAodGhpcy5jaGFpbiA9PT0gJ2V0aGVyZXVtJykgYmFzZVVybCA9ICdodHRwczovL2V0aC5ibG9ja3Njb3V0LmNvbS9hcGkvdjInO1xuICAgICAgZWxzZSBpZiAodGhpcy5jaGFpbiA9PT0gJ2Jhc2UnKSBiYXNlVXJsID0gJ2h0dHBzOi8vYmFzZS5ibG9ja3Njb3V0LmNvbS9hcGkvdjInO1xuICAgICAgZWxzZSBpZiAodGhpcy5jaGFpbiA9PT0gJ2JuYicpIGJhc2VVcmwgPSAnaHR0cHM6Ly9ic2MuYmxvY2tzY291dC5jb20vYXBpL3YyJztcblxuICAgICAgaWYgKGJhc2VVcmwpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hZGRyZXNzZXMvJHthZGRyZXNzfWAsIHsgXG4gICAgICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDEwMDAwKSxcbiAgICAgICAgICBoZWFkZXJzOiB7ICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsICdVc2VyLUFnZW50JzogJ1dhbGxldFNlbnRpbmVsLzEuMCcgfVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgaWYgKGRhdGEuY29pbl9iYWxhbmNlKSByZXR1cm4gZGF0YS5jb2luX2JhbGFuY2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIHt9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5leHBsb3JlckFwaVVybH0/bW9kdWxlPWFjY291bnQmYWN0aW9uPWJhbGFuY2UmYWRkcmVzcz0ke2FkZHJlc3N9JnRhZz1sYXRlc3QmYXBpa2V5PSR7dGhpcy5leHBsb3JlckFwaUtleX1gO1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHsgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDEwMDAwKSB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBpZiAoZGF0YS5zdGF0dXMgPT09ICcxJyAmJiBkYXRhLnJlc3VsdCkgcmV0dXJuIGRhdGEucmVzdWx0O1xuICAgIH0gY2F0Y2gge31cbiAgICBcbiAgICByZXR1cm4gJzAnO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBmZXRjaEFwcHJvdmFsRXZlbnRzKGFkZHJlc3M6IHN0cmluZyk6IFByb21pc2U8QXBwcm92YWxFdmVudFtdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBiYXNlVXJsID0gJyc7XG4gICAgICBpZiAodGhpcy5jaGFpbiA9PT0gJ2V0aGVyZXVtJykgYmFzZVVybCA9ICdodHRwczovL2V0aC5ibG9ja3Njb3V0LmNvbS9hcGkvdjInO1xuICAgICAgZWxzZSBpZiAodGhpcy5jaGFpbiA9PT0gJ2Jhc2UnKSBiYXNlVXJsID0gJ2h0dHBzOi8vYmFzZS5ibG9ja3Njb3V0LmNvbS9hcGkvdjInO1xuICAgICAgZWxzZSBpZiAodGhpcy5jaGFpbiA9PT0gJ2JuYicpIGJhc2VVcmwgPSAnaHR0cHM6Ly9ic2MuYmxvY2tzY291dC5jb20vYXBpL3YyJztcblxuICAgICAgaWYgKGJhc2VVcmwpIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS9hZGRyZXNzZXMvJHthZGRyZXNzfS90cmFuc2FjdGlvbnNgLCB7IFxuICAgICAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCgxNTAwMCksXG4gICAgICAgICAgaGVhZGVyczogeyAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLCAnVXNlci1BZ2VudCc6ICdXYWxsZXRTZW50aW5lbC8xLjAnIH1cbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgIGNvbnN0IGFwcHJvdmFsczogQXBwcm92YWxFdmVudFtdID0gW107XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGRhdGEuaXRlbXMgJiYgQXJyYXkuaXNBcnJheShkYXRhLml0ZW1zKSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCB0eCBvZiBkYXRhLml0ZW1zKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gdHgucmF3X2lucHV0IHx8ICcnO1xuICAgICAgICAgICAgICBpZiAoaW5wdXQuc3RhcnRzV2l0aCgnMHgwOTVlYTdiMycpIHx8IGlucHV0LnN0YXJ0c1dpdGgoJzB4YTIyY2I0NjUnKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNwZW5kZXIgPSBpbnB1dC5sZW5ndGggPj0gNzQgPyAnMHgnICsgaW5wdXQuc2xpY2UoMzQsIDc0KSA6ICcnO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRvQWRkciA9IHR5cGVvZiB0eC50byA9PT0gJ29iamVjdCcgPyB0eC50bz8uaGFzaCA6IHR4LnRvO1xuICAgICAgICAgICAgICAgIGFwcHJvdmFscy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgIHRva2VuOiAodG9BZGRyIHx8ICcnKS50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgICAgdG9rZW5OYW1lOiAnVW5rbm93bicsXG4gICAgICAgICAgICAgICAgICB0b2tlblN5bWJvbDogJ1VOSycsXG4gICAgICAgICAgICAgICAgICBzcGVuZGVyOiBzcGVuZGVyLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICAgICAgICBvd25lcjogYWRkcmVzcy50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgICAgYW1vdW50OiBpbnB1dC5sZW5ndGggPj0gMTM4ID8gJzB4JyArIGlucHV0LnNsaWNlKDc0LCAxMzgpIDogJzB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZicsXG4gICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHR4LnRpbWVzdGFtcCA/IE1hdGguZmxvb3IobmV3IERhdGUodHgudGltZXN0YW1wKS5nZXRUaW1lKCkgLyAxMDAwKSA6IDAsXG4gICAgICAgICAgICAgICAgICB0cmFuc2FjdGlvbkhhc2g6IHR4Lmhhc2gsXG4gICAgICAgICAgICAgICAgICBibG9ja051bWJlcjogdHguYmxvY2sgfHwgMCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoYXBwcm92YWxzLmxlbmd0aCA+IDApIHJldHVybiBhcHByb3ZhbHM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIHt9XG5cbiAgICByZXR1cm4gW107XG4gIH1cblxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBBUFBST1ZBTCBBTkFMWVNJU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgYW5hbHl6ZUFwcHJvdmFscyhhcHByb3ZhbEV2ZW50czogQXBwcm92YWxFdmVudFtdKTogVG9rZW5BcHByb3ZhbFtdIHtcbiAgICBjb25zdCBhcHByb3ZhbHM6IFRva2VuQXBwcm92YWxbXSA9IFtdO1xuICAgIGNvbnN0IHByb2Nlc3NlZCA9IG5ldyBTZXQ8c3RyaW5nPigpO1xuXG4gICAgZm9yIChjb25zdCBldmVudCBvZiBhcHByb3ZhbEV2ZW50cykge1xuICAgICAgY29uc3Qga2V5ID0gYCR7ZXZlbnQudG9rZW59LSR7ZXZlbnQuc3BlbmRlcn1gO1xuICAgICAgaWYgKHByb2Nlc3NlZC5oYXMoa2V5KSkgY29udGludWU7XG4gICAgICBwcm9jZXNzZWQuYWRkKGtleSk7XG5cbiAgICAgIGxldCBhbW91bnQ6IHN0cmluZztcbiAgICAgIHRyeSB7XG4gICAgICAgIGFtb3VudCA9IEJpZ0ludChldmVudC5hbW91bnQpLnRvU3RyaW5nKCk7XG4gICAgICAgIGlmIChhbW91bnQgPT09ICcwJykgY29udGludWU7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGlzVW5saW1pdGVkID0gaXNJbmZpbml0ZUFwcHJvdmFsKGFtb3VudCk7XG4gICAgICBjb25zdCBtYWxpY2lvdXNTcGVuZGVyID0gaXNNYWxpY2lvdXNBZGRyZXNzKGV2ZW50LnNwZW5kZXIsIHRoaXMuY2hhaW4pO1xuICAgICAgY29uc3QgbGVnaXRpbWF0ZVNwZW5kZXIgPSBpc0xlZ2l0aW1hdGVDb250cmFjdChldmVudC5zcGVuZGVyKTtcbiAgICAgIGNvbnN0IGRyYWluZXJSZWNpcGllbnQgPSBpc0RyYWluZXJSZWNpcGllbnQoZXZlbnQuc3BlbmRlcik7XG5cbiAgICAgIGxldCByaXNrTGV2ZWw6IFJpc2tMZXZlbCA9ICdMT1cnO1xuICAgICAgbGV0IHJpc2tSZWFzb246IHN0cmluZyB8IHVuZGVmaW5lZDtcblxuICAgICAgaWYgKG1hbGljaW91c1NwZW5kZXIgfHwgZHJhaW5lclJlY2lwaWVudCkge1xuICAgICAgICByaXNrTGV2ZWwgPSAnQ1JJVElDQUwnO1xuICAgICAgICByaXNrUmVhc29uID0gJ0FwcHJvdmVkIHRvIGtub3duIG1hbGljaW91cyBhZGRyZXNzJztcbiAgICAgIH0gZWxzZSBpZiAoaXNVbmxpbWl0ZWQgJiYgIWxlZ2l0aW1hdGVTcGVuZGVyKSB7XG4gICAgICAgIHJpc2tMZXZlbCA9ICdISUdIJztcbiAgICAgICAgcmlza1JlYXNvbiA9ICdVbmxpbWl0ZWQgYXBwcm92YWwgdG8gdW52ZXJpZmllZCBjb250cmFjdCc7XG4gICAgICB9IGVsc2UgaWYgKGlzVW5saW1pdGVkKSB7XG4gICAgICAgIHJpc2tMZXZlbCA9ICdNRURJVU0nO1xuICAgICAgICByaXNrUmVhc29uID0gYFVubGltaXRlZCBhcHByb3ZhbCB0byAke2xlZ2l0aW1hdGVTcGVuZGVyfWA7XG4gICAgICB9XG5cbiAgICAgIGFwcHJvdmFscy5wdXNoKHtcbiAgICAgICAgaWQ6IGBhcHByb3ZhbC0ke2V2ZW50LnRyYW5zYWN0aW9uSGFzaH0tJHtldmVudC5zcGVuZGVyfWAsXG4gICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgYWRkcmVzczogZXZlbnQudG9rZW4sXG4gICAgICAgICAgc3ltYm9sOiBldmVudC50b2tlblN5bWJvbCB8fCAnVU5LJyxcbiAgICAgICAgICBuYW1lOiBldmVudC50b2tlbk5hbWUgfHwgJ1Vua25vd24nLFxuICAgICAgICAgIGRlY2ltYWxzOiAxOCxcbiAgICAgICAgICBzdGFuZGFyZDogJ0VSQzIwJyxcbiAgICAgICAgICB2ZXJpZmllZDogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIHNwZW5kZXI6IGV2ZW50LnNwZW5kZXIsXG4gICAgICAgIHNwZW5kZXJMYWJlbDogbGVnaXRpbWF0ZVNwZW5kZXIgfHwgbWFsaWNpb3VzU3BlbmRlcj8ubmFtZSxcbiAgICAgICAgYW1vdW50LFxuICAgICAgICBpc1VubGltaXRlZCxcbiAgICAgICAgcmlza0xldmVsLFxuICAgICAgICByaXNrUmVhc29uLFxuICAgICAgICBncmFudGVkQXQ6IG5ldyBEYXRlKGV2ZW50LnRpbWVzdGFtcCAqIDEwMDApLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGlzTWFsaWNpb3VzOiAhIShtYWxpY2lvdXNTcGVuZGVyIHx8IGRyYWluZXJSZWNpcGllbnQpLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGFwcHJvdmFscy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBjb25zdCBvcmRlcjogUmVjb3JkPFJpc2tMZXZlbCwgbnVtYmVyPiA9IHsgQ1JJVElDQUw6IDAsIEhJR0g6IDEsIE1FRElVTTogMiwgTE9XOiAzIH07XG4gICAgICByZXR1cm4gb3JkZXJbYS5yaXNrTGV2ZWxdIC0gb3JkZXJbYi5yaXNrTGV2ZWxdO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gU0NPUklORyAmIFNUQVRVU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gIHByaXZhdGUgY2FsY3VsYXRlUmlza1Njb3JlKHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10sIGFwcHJvdmFsczogVG9rZW5BcHByb3ZhbFtdKTogbnVtYmVyIHtcbiAgICBsZXQgc2NvcmUgPSAwO1xuXG4gICAgZm9yIChjb25zdCB0aHJlYXQgb2YgdGhyZWF0cykge1xuICAgICAgc3dpdGNoICh0aHJlYXQuc2V2ZXJpdHkpIHtcbiAgICAgICAgY2FzZSAnQ1JJVElDQUwnOiBzY29yZSArPSB0aHJlYXQub25nb2luZ1Jpc2sgPyA0MCA6IDI1OyBicmVhaztcbiAgICAgICAgY2FzZSAnSElHSCc6IHNjb3JlICs9IHRocmVhdC5vbmdvaW5nUmlzayA/IDI1IDogMTU7IGJyZWFrO1xuICAgICAgICBjYXNlICdNRURJVU0nOiBzY29yZSArPSAxMDsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0xPVyc6IHNjb3JlICs9IDU7IGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgYXBwcm92YWwgb2YgYXBwcm92YWxzKSB7XG4gICAgICBpZiAoYXBwcm92YWwuaXNNYWxpY2lvdXMpIHNjb3JlICs9IDMwO1xuICAgICAgZWxzZSBpZiAoYXBwcm92YWwucmlza0xldmVsID09PSAnQ1JJVElDQUwnKSBzY29yZSArPSAyMDtcbiAgICAgIGVsc2UgaWYgKGFwcHJvdmFsLnJpc2tMZXZlbCA9PT0gJ0hJR0gnKSBzY29yZSArPSAxMDtcbiAgICB9XG5cbiAgICByZXR1cm4gTWF0aC5taW4oMTAwLCBzY29yZSk7XG4gIH1cblxuICBwcml2YXRlIGRldGVybWluZVNlY3VyaXR5U3RhdHVzKHJpc2tTY29yZTogbnVtYmVyLCB0aHJlYXRzOiBEZXRlY3RlZFRocmVhdFtdKTogJ1NBRkUnIHwgJ0FUX1JJU0snIHwgJ0NPTVBST01JU0VEJyB7XG4gICAgY29uc3QgaGFzQ3JpdGljYWwgPSB0aHJlYXRzLnNvbWUodCA9PiB0LnNldmVyaXR5ID09PSAnQ1JJVElDQUwnICYmIHQub25nb2luZ1Jpc2spO1xuICAgIGNvbnN0IGhhc0tleUNvbXByb21pc2UgPSB0aHJlYXRzLnNvbWUodCA9PiB0LnR5cGUgPT09ICdQUklWQVRFX0tFWV9MRUFLJyk7XG4gICAgY29uc3QgaGFzRHJhaW5lciA9IHRocmVhdHMuc29tZSh0ID0+IHQudHlwZSA9PT0gJ1dBTExFVF9EUkFJTkVSJyk7XG5cbiAgICBpZiAoaGFzQ3JpdGljYWwgfHwgaGFzS2V5Q29tcHJvbWlzZSB8fCBoYXNEcmFpbmVyIHx8IHJpc2tTY29yZSA+PSA1MCkge1xuICAgICAgcmV0dXJuICdDT01QUk9NSVNFRCc7XG4gICAgfVxuICAgIGlmIChyaXNrU2NvcmUgPj0gMjAgfHwgdGhyZWF0cy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gJ0FUX1JJU0snO1xuICAgIH1cbiAgICByZXR1cm4gJ1NBRkUnO1xuICB9XG5cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gT1VUUFVUIEdFTkVSQVRJT05cbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuICBwcml2YXRlIGJ1aWxkU3VzcGljaW91c1RyYW5zYWN0aW9ucyh0cmFuc2FjdGlvbnM6IFRyYW5zYWN0aW9uRGF0YVtdLCB0aHJlYXRzOiBEZXRlY3RlZFRocmVhdFtdKTogU3VzcGljaW91c1RyYW5zYWN0aW9uW10ge1xuICAgIGNvbnN0IHN1c3BpY2lvdXM6IFN1c3BpY2lvdXNUcmFuc2FjdGlvbltdID0gW107XG4gICAgXG4gICAgZm9yIChjb25zdCB0aHJlYXQgb2YgdGhyZWF0cykge1xuICAgICAgZm9yIChjb25zdCB0eEhhc2ggb2YgdGhyZWF0LnJlbGF0ZWRUcmFuc2FjdGlvbnMpIHtcbiAgICAgICAgaWYgKCF0eEhhc2gpIGNvbnRpbnVlO1xuICAgICAgICBjb25zdCB0eCA9IHRyYW5zYWN0aW9ucy5maW5kKHQgPT4gdD8uaGFzaD8udG9Mb3dlckNhc2UoKSA9PT0gdHhIYXNoLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICBpZiAodHgpIHtcbiAgICAgICAgICBzdXNwaWNpb3VzLnB1c2goe1xuICAgICAgICAgICAgaGFzaDogdHguaGFzaCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUodHgudGltZXN0YW1wICogMTAwMCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIHR5cGU6IHRocmVhdC50eXBlLFxuICAgICAgICAgICAgZnJvbTogdHguZnJvbSxcbiAgICAgICAgICAgIHRvOiB0eC50byxcbiAgICAgICAgICAgIHZhbHVlOiB0eC52YWx1ZSxcbiAgICAgICAgICAgIHJpc2tMZXZlbDogdGhyZWF0LnNldmVyaXR5LFxuICAgICAgICAgICAgZmxhZ3M6IFt0aHJlYXQudGl0bGVdLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246IHRocmVhdC5kZXNjcmlwdGlvbixcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzdXNwaWNpb3VzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZW5lcmF0ZVN1bW1hcnkoc3RhdHVzOiAnU0FGRScgfCAnQVRfUklTSycgfCAnQ09NUFJPTUlTRUQnLCB0aHJlYXRzOiBEZXRlY3RlZFRocmVhdFtdLCBhcHByb3ZhbHM6IFRva2VuQXBwcm92YWxbXSk6IHN0cmluZyB7XG4gICAgaWYgKHN0YXR1cyA9PT0gJ1NBRkUnKSB7XG4gICAgICByZXR1cm4gJ05vIHNpZ25pZmljYW50IHNlY3VyaXR5IHRocmVhdHMgZGV0ZWN0ZWQuIFlvdXIgd2FsbGV0IGFwcGVhcnMgdG8gYmUgaW4gZ29vZCBzdGFuZGluZy4nO1xuICAgIH1cbiAgICBpZiAoc3RhdHVzID09PSAnQVRfUklTSycpIHtcbiAgICAgIHJldHVybiBgJHt0aHJlYXRzLmxlbmd0aH0gcG90ZW50aWFsIHNlY3VyaXR5IGNvbmNlcm4ocykgZGV0ZWN0ZWQuIFJldmlldyB0aGUgaWRlbnRpZmllZCByaXNrcyBhbmQgY29uc2lkZXIgdGFraW5nIGFjdGlvbi5gO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBkcmFpbmVyVGhyZWF0cyA9IHRocmVhdHMuZmlsdGVyKHQgPT4gdC50eXBlID09PSAnV0FMTEVUX0RSQUlORVInIHx8IHQudHlwZSA9PT0gJ1BSSVZBVEVfS0VZX0xFQUsnKTtcbiAgICBpZiAoZHJhaW5lclRocmVhdHMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGDwn5qoIENSSVRJQ0FMOiBUaGlzIHdhbGxldCBzaG93cyBzaWducyBvZiBjb21wcm9taXNlLiAke2RyYWluZXJUaHJlYXRzLmxlbmd0aH0gZHJhaW5lci9rZXkgY29tcHJvbWlzZSBpbmNpZGVudChzKSBkZXRlY3RlZC4gSW1tZWRpYXRlIGFjdGlvbiByZXF1aXJlZC5gO1xuICAgIH1cbiAgICByZXR1cm4gYPCfmqggQ1JJVElDQUw6ICR7dGhyZWF0cy5sZW5ndGh9IGNyaXRpY2FsIHNlY3VyaXR5IHRocmVhdChzKSBkZXRlY3RlZC4gUmV2aWV3IGltbWVkaWF0ZWx5LmA7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUmVjb21tZW5kYXRpb25zKHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10sIGFwcHJvdmFsczogVG9rZW5BcHByb3ZhbFtdLCBzdGF0dXM6ICdTQUZFJyB8ICdBVF9SSVNLJyB8ICdDT01QUk9NSVNFRCcpOiBTZWN1cml0eVJlY29tbWVuZGF0aW9uW10ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogU2VjdXJpdHlSZWNvbW1lbmRhdGlvbltdID0gW107XG5cbiAgICBjb25zdCBtYWxpY2lvdXNBcHByb3ZhbHMgPSBhcHByb3ZhbHMuZmlsdGVyKGEgPT4gYS5pc01hbGljaW91cyk7XG4gICAgaWYgKG1hbGljaW91c0FwcHJvdmFscy5sZW5ndGggPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiAncmV2b2tlLW1hbGljaW91cycsXG4gICAgICAgIHByaW9yaXR5OiAnQ1JJVElDQUwnLFxuICAgICAgICBjYXRlZ29yeTogJ0lNTUVESUFURScsXG4gICAgICAgIHRpdGxlOiAnUmV2b2tlIE1hbGljaW91cyBBcHByb3ZhbHMgSU1NRURJQVRFTFknLFxuICAgICAgICBkZXNjcmlwdGlvbjogYFlvdSBoYXZlICR7bWFsaWNpb3VzQXBwcm92YWxzLmxlbmd0aH0gYXBwcm92YWwocykgdG8ga25vd24gbWFsaWNpb3VzIGNvbnRyYWN0cy5gLFxuICAgICAgICBhY3Rpb25hYmxlOiB0cnVlLFxuICAgICAgICBhY3Rpb25UeXBlOiAnUkVWT0tFX0FQUFJPVkFMJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0aHJlYXRzLnNvbWUodCA9PiB0LnR5cGUgPT09ICdXQUxMRVRfRFJBSU5FUicgfHwgdC50eXBlID09PSAnUFJJVkFURV9LRVlfTEVBSycpKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiAnbW92ZS1hc3NldHMnLFxuICAgICAgICBwcmlvcml0eTogJ0NSSVRJQ0FMJyxcbiAgICAgICAgY2F0ZWdvcnk6ICdJTU1FRElBVEUnLFxuICAgICAgICB0aXRsZTogJ1RyYW5zZmVyIFJlbWFpbmluZyBBc3NldHMgdG8gRnJlc2ggV2FsbGV0JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdUaGlzIHdhbGxldCBtYXkgYmUgY29tcHJvbWlzZWQuIE1vdmUgYW55IHJlbWFpbmluZyBhc3NldHMgdG8gYSBORVcgd2FsbGV0IGltbWVkaWF0ZWx5LicsXG4gICAgICAgIGFjdGlvbmFibGU6IHRydWUsXG4gICAgICAgIGFjdGlvblR5cGU6ICdUUkFOU0ZFUl9BU1NFVFMnLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xuICAgICAgaWQ6ICdyZWd1bGFyLWF1ZGl0JyxcbiAgICAgIHByaW9yaXR5OiAnTE9XJyxcbiAgICAgIGNhdGVnb3J5OiAnTE9OR19URVJNJyxcbiAgICAgIHRpdGxlOiAnUmVndWxhciBTZWN1cml0eSBBdWRpdHMnLFxuICAgICAgZGVzY3JpcHRpb246ICdSZXZpZXcgeW91ciB3YWxsZXQgYXBwcm92YWxzIGFuZCB0cmFuc2FjdGlvbnMgcmVndWxhcmx5LicsXG4gICAgICBhY3Rpb25hYmxlOiBmYWxzZSxcbiAgICB9KTtcblxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlUmVjb3ZlcnlQbGFuKHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10sIGFwcHJvdmFsczogVG9rZW5BcHByb3ZhbFtdKTogUmVjb3ZlcnlQbGFuIHtcbiAgICBjb25zdCBzdGVwczogUmVjb3ZlcnlTdGVwW10gPSBbXTtcbiAgICBsZXQgb3JkZXIgPSAxO1xuXG4gICAgY29uc3QgbWFsaWNpb3VzQXBwcm92YWxzID0gYXBwcm92YWxzLmZpbHRlcihhID0+IGEuaXNNYWxpY2lvdXMpO1xuICAgIGlmIChtYWxpY2lvdXNBcHByb3ZhbHMubGVuZ3RoID4gMCkge1xuICAgICAgc3RlcHMucHVzaCh7XG4gICAgICAgIG9yZGVyOiBvcmRlcisrLFxuICAgICAgICB0aXRsZTogJ1Jldm9rZSBNYWxpY2lvdXMgQXBwcm92YWxzJyxcbiAgICAgICAgZGVzY3JpcHRpb246IGBJbW1lZGlhdGVseSByZXZva2UgJHttYWxpY2lvdXNBcHByb3ZhbHMubGVuZ3RofSBhcHByb3ZhbChzKSB0byBrbm93biBtYWxpY2lvdXMgY29udHJhY3RzLmAsXG4gICAgICAgIGFjdGlvbjogeyB0eXBlOiAnUkVWT0tFX0FQUFJPVkFMJyB9LFxuICAgICAgICBwcmlvcml0eTogJ0lNTUVESUFURScsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBpc0NvbXByb21pc2VkID0gdGhyZWF0cy5zb21lKHQgPT4gdC50eXBlID09PSAnV0FMTEVUX0RSQUlORVInIHx8IHQudHlwZSA9PT0gJ1BSSVZBVEVfS0VZX0xFQUsnIHx8ICh0LnNldmVyaXR5ID09PSAnQ1JJVElDQUwnICYmIHQub25nb2luZ1Jpc2spKTtcblxuICAgIGlmIChpc0NvbXByb21pc2VkKSB7XG4gICAgICBzdGVwcy5wdXNoKHtcbiAgICAgICAgb3JkZXI6IG9yZGVyKyssXG4gICAgICAgIHRpdGxlOiAnVHJhbnNmZXIgQWxsIFJlbWFpbmluZyBBc3NldHMnLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ01vdmUgQUxMIHJlbWFpbmluZyBhc3NldHMgdG8gYSBuZXcgd2FsbGV0IHdpdGggYSBmcmVzaCBzZWVkIHBocmFzZS4nLFxuICAgICAgICBhY3Rpb246IHsgdHlwZTogJ1RSQU5TRkVSX0FTU0VUUycgfSxcbiAgICAgICAgcHJpb3JpdHk6ICdJTU1FRElBVEUnLFxuICAgICAgfSk7XG4gICAgICBzdGVwcy5wdXNoKHtcbiAgICAgICAgb3JkZXI6IG9yZGVyKyssXG4gICAgICAgIHRpdGxlOiAnQ3JlYXRlIE5ldyBTZWN1cmUgV2FsbGV0JyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdHZW5lcmF0ZSBhIGNvbXBsZXRlbHkgbmV3IHdhbGxldC4gTkVWRVIgcmV1c2UgdGhlIG9sZCBzZWVkIHBocmFzZS4nLFxuICAgICAgICBhY3Rpb246IHsgdHlwZTogJ01BTlVBTCcgfSxcbiAgICAgICAgcHJpb3JpdHk6ICdISUdIJyxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB1cmdlbmN5TGV2ZWw6IGlzQ29tcHJvbWlzZWQgPyAnQ1JJVElDQUwnIDogJ0hJR0gnLFxuICAgICAgZXN0aW1hdGVkVGltZU1pbnV0ZXM6IHN0ZXBzLmxlbmd0aCAqIDUsXG4gICAgICBzdGVwcyxcbiAgICAgIHdhcm5pbmdzOiBbXG4gICAgICAgICdOZXZlciBzaGFyZSB5b3VyIHNlZWQgcGhyYXNlIHdpdGggYW55b25lJyxcbiAgICAgICAgJ1ZlcmlmeSBhbGwgdHJhbnNhY3Rpb24gZGV0YWlscyBiZWZvcmUgc2lnbmluZycsXG4gICAgICAgICdCZSBjYXV0aW91cyBvZiBcInJlY292ZXJ5IHNlcnZpY2VzXCIgLSB0aGV5IGFyZSBvZnRlbiBzY2FtcycsXG4gICAgICBdLFxuICAgICAgc2FmZVdhbGxldFJlcXVpcmVkOiBpc0NvbXByb21pc2VkLFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGdlbmVyYXRlRWR1Y2F0aW9uYWxDb250ZW50KHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10pIHtcbiAgICBjb25zdCBwcmltYXJ5VHlwZSA9IHRocmVhdHNbMF0/LnR5cGUgfHwgJ1VOS05PV04nO1xuXG4gICAgY29uc3QgZXhwbGFuYXRpb25zOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge1xuICAgICAgV0FMTEVUX0RSQUlORVI6IHtcbiAgICAgICAgd2hhdEhhcHBlbmVkOiAnWW91ciB3YWxsZXQgd2FzIHRhcmdldGVkIGJ5IGEgd2FsbGV0IGRyYWluZXIgLSBtYWxpY2lvdXMgc29mdHdhcmUgZGVzaWduZWQgdG8gc3RlYWwgY3J5cHRvY3VycmVuY3kuJyxcbiAgICAgICAgaG93SXRXb3JrczogJ0RyYWluZXJzIHdvcmsgYnkgdHJpY2tpbmcgeW91IGludG8gc2lnbmluZyBtYWxpY2lvdXMgdHJhbnNhY3Rpb25zIG9yIGFwcHJvdmFscywgdGhlbiB1c2luZyB0aG9zZSBwZXJtaXNzaW9ucyB0byB0cmFuc2ZlciB5b3VyIGFzc2V0cy4nLFxuICAgICAgICBvbmdvaW5nRGFtYWdlOiAnSWYgdGhlIGF0dGFja2VyIGhhcyB5b3VyIHByaXZhdGUga2V5LCB0aGV5IGNhbiBkcmFpbiBhbnkgbmV3IGZ1bmRzIGRlcG9zaXRlZC4nLFxuICAgICAgICByZWNvdmVyYWJsZUluZm86ICdBc3NldHMgYWxyZWFkeSBzdG9sZW4gY2Fubm90IGJlIHJlY292ZXJlZC4gRm9jdXMgb24gcHJvdGVjdGluZyByZW1haW5pbmcgYXNzZXRzLicsXG4gICAgICB9LFxuICAgICAgUFJJVkFURV9LRVlfTEVBSzoge1xuICAgICAgICB3aGF0SGFwcGVuZWQ6ICdZb3VyIHByaXZhdGUga2V5IG9yIHNlZWQgcGhyYXNlIHdhcyBsaWtlbHkgY29tcHJvbWlzZWQsIGdpdmluZyB0aGUgYXR0YWNrZXIgZnVsbCBjb250cm9sLicsXG4gICAgICAgIGhvd0l0V29ya3M6ICdLZXkgbGVha3MgaGFwcGVuIHRocm91Z2ggcGhpc2hpbmcsIG1hbHdhcmUsIGZha2Ugd2FsbGV0IGFwcHMsIG9yIGFjY2lkZW50YWxseSBleHBvc2luZyB5b3VyIGtleS4nLFxuICAgICAgICBvbmdvaW5nRGFtYWdlOiAnVGhlIGF0dGFja2VyIGhhcyBDT01QTEVURSBjb250cm9sLiBBbnkgZnVuZHMgZGVwb3NpdGVkIGNhbiBiZSBzdG9sZW4gaW5zdGFudGx5LicsXG4gICAgICAgIHJlY292ZXJhYmxlSW5mbzogJ1RoaXMgd2FsbGV0IGlzIHBlcm1hbmVudGx5IGNvbXByb21pc2VkLiBORVZFUiB1c2UgaXQgYWdhaW4uJyxcbiAgICAgIH0sXG4gICAgICBBUFBST1ZBTF9ISUpBQ0s6IHtcbiAgICAgICAgd2hhdEhhcHBlbmVkOiAnQSBtYWxpY2lvdXMgYWN0b3IgZ2FpbmVkIHBlcm1pc3Npb24gdG8gc3BlbmQgeW91ciB0b2tlbnMgdGhyb3VnaCBhIHRva2VuIGFwcHJvdmFsLicsXG4gICAgICAgIGhvd0l0V29ya3M6ICdBdHRhY2tlcnMgY3JlYXRlIGZha2UgZEFwcHMgdGhhdCByZXF1ZXN0IGFwcHJvdmFscywgdGhlbiB1c2UgdGhlbSB0byBzdGVhbCBhc3NldHMuJyxcbiAgICAgICAgb25nb2luZ0RhbWFnZTogJ1RoZSBhdHRhY2tlciBjYW4gZHJhaW4gYXBwcm92ZWQgdG9rZW5zIHVudGlsIHlvdSByZXZva2UgdGhlIGFwcHJvdmFsLicsXG4gICAgICAgIHJlY292ZXJhYmxlSW5mbzogJ1Jldm9rZSB0aGUgbWFsaWNpb3VzIGFwcHJvdmFsIGltbWVkaWF0ZWx5LicsXG4gICAgICB9LFxuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgYXR0YWNrRXhwbGFuYXRpb246IGV4cGxhbmF0aW9uc1twcmltYXJ5VHlwZV0gfHwge1xuICAgICAgICB3aGF0SGFwcGVuZWQ6ICdTdXNwaWNpb3VzIGFjdGl2aXR5IHdhcyBkZXRlY3RlZCBvbiB5b3VyIHdhbGxldC4nLFxuICAgICAgICBob3dJdFdvcmtzOiAnVGhlIHNwZWNpZmljIGF0dGFjayBwYXR0ZXJuIGNvdWxkIG5vdCBiZSBkZXRlcm1pbmVkLicsXG4gICAgICAgIG9uZ29pbmdEYW1hZ2U6ICdNb25pdG9yIHlvdXIgd2FsbGV0IGNsb3NlbHkuJyxcbiAgICAgICAgcmVjb3ZlcmFibGVJbmZvOiAnQ29uc2lkZXIgbW92aW5nIGFzc2V0cyB0byBhIGZyZXNoIHdhbGxldC4nLFxuICAgICAgfSxcbiAgICAgIHByZXZlbnRpb25UaXBzOiBbXG4gICAgICAgIHsgdGl0bGU6ICdOZXZlciBzaGFyZSB5b3VyIHNlZWQgcGhyYXNlJywgZGVzY3JpcHRpb246ICdObyBsZWdpdGltYXRlIHNlcnZpY2Ugd2lsbCBldmVyIGFzayBmb3IgaXQuJywgaW1wb3J0YW5jZTogJ0NSSVRJQ0FMJyBhcyBSaXNrTGV2ZWwgfSxcbiAgICAgICAgeyB0aXRsZTogJ1ZlcmlmeSBiZWZvcmUgc2lnbmluZycsIGRlc2NyaXB0aW9uOiAnUmVhZCB0cmFuc2FjdGlvbiBkZXRhaWxzIGNhcmVmdWxseS4nLCBpbXBvcnRhbmNlOiAnSElHSCcgYXMgUmlza0xldmVsIH0sXG4gICAgICAgIHsgdGl0bGU6ICdVc2UgaGFyZHdhcmUgd2FsbGV0cycsIGRlc2NyaXB0aW9uOiAnS2VlcCBoaWdoLXZhbHVlIGFzc2V0cyBpbiBjb2xkIHN0b3JhZ2UuJywgaW1wb3J0YW5jZTogJ0hJR0gnIGFzIFJpc2tMZXZlbCB9LFxuICAgICAgXSxcbiAgICAgIHNlY3VyaXR5Q2hlY2tsaXN0OiBbXG4gICAgICAgIHsgaWQ6ICcxJywgY2F0ZWdvcnk6ICdXYWxsZXQnLCBpdGVtOiAnVXNlIGhhcmR3YXJlIHdhbGxldCcsIGNvbXBsZXRlZDogZmFsc2UgfSxcbiAgICAgICAgeyBpZDogJzInLCBjYXRlZ29yeTogJ1dhbGxldCcsIGl0ZW06ICdCYWNrdXAgc2VlZCBwaHJhc2Ugc2VjdXJlbHknLCBjb21wbGV0ZWQ6IGZhbHNlIH0sXG4gICAgICAgIHsgaWQ6ICczJywgY2F0ZWdvcnk6ICdBcHByb3ZhbHMnLCBpdGVtOiAnUmV2aWV3IGFwcHJvdmFscyByZWd1bGFybHknLCBjb21wbGV0ZWQ6IGZhbHNlIH0sXG4gICAgICBdLFxuICAgIH07XG4gIH1cblxuICBnZW5lcmF0ZVJldm9rZVRyYW5zYWN0aW9uKHRva2VuQWRkcmVzczogc3RyaW5nLCBzcGVuZGVyQWRkcmVzczogc3RyaW5nKTogeyB0bzogc3RyaW5nOyBkYXRhOiBzdHJpbmcgfSB7XG4gICAgY29uc3QgaWZhY2UgPSBuZXcgZXRoZXJzLkludGVyZmFjZShbJ2Z1bmN0aW9uIGFwcHJvdmUoYWRkcmVzcyBzcGVuZGVyLCB1aW50MjU2IGFtb3VudCknXSk7XG4gICAgY29uc3QgZGF0YSA9IGlmYWNlLmVuY29kZUZ1bmN0aW9uRGF0YSgnYXBwcm92ZScsIFtzcGVuZGVyQWRkcmVzcywgMF0pO1xuICAgIHJldHVybiB7IHRvOiB0b2tlbkFkZHJlc3MsIGRhdGEgfTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImV0aGVycyIsIkNIQUlOX1JQQ19DT05GSUciLCJpc01hbGljaW91c0FkZHJlc3MiLCJpc0RyYWluZXJSZWNpcGllbnQiLCJpc0luZmluaXRlQXBwcm92YWwiLCJpc0xlZ2l0aW1hdGVDb250cmFjdCIsIkVWTUFuYWx5emVyIiwiY29uc3RydWN0b3IiLCJjaGFpbiIsInByb3ZpZGVyIiwiY3VycmVudFJwY0luZGV4IiwiRXJyb3IiLCJjb25maWciLCJycGNVcmxzIiwiZXhwbG9yZXJBcGlVcmwiLCJleHBsb3JlckFwaSIsImV4cGxvcmVyQXBpS2V5IiwicHJvY2VzcyIsImVudiIsInRvVXBwZXJDYXNlIiwiZ2V0UHJvdmlkZXIiLCJpIiwibGVuZ3RoIiwicnBjSW5kZXgiLCJycGNVcmwiLCJKc29uUnBjUHJvdmlkZXIiLCJ1bmRlZmluZWQiLCJzdGF0aWNOZXR3b3JrIiwiYmF0Y2hNYXhDb3VudCIsIlByb21pc2UiLCJyYWNlIiwiZ2V0QmxvY2tOdW1iZXIiLCJfIiwicmVqZWN0Iiwic2V0VGltZW91dCIsImVycm9yIiwiYW5hbHl6ZVdhbGxldCIsImFkZHJlc3MiLCJpc0FkZHJlc3MiLCJub3JtYWxpemVkQWRkcmVzcyIsInRvTG93ZXJDYXNlIiwidGhyZWF0cyIsInRyYW5zYWN0aW9ucyIsInRva2VuVHJhbnNmZXJzIiwiYXBwcm92YWxFdmVudHMiLCJjdXJyZW50QmFsYW5jZSIsImFsbCIsImZldGNoVHJhbnNhY3Rpb25IaXN0b3J5IiwiZmV0Y2hUb2tlblRyYW5zZmVycyIsImZldGNoQXBwcm92YWxFdmVudHMiLCJmZXRjaEN1cnJlbnRCYWxhbmNlIiwiY29uc29sZSIsImxvZyIsImRyYWluVGhyZWF0IiwiZGV0ZWN0V2FsbGV0RHJhaW4iLCJwdXNoIiwibWFsaWNpb3VzVGhyZWF0cyIsImRldGVjdE1hbGljaW91c0ludGVyYWN0aW9ucyIsImFwcHJvdmFsVGhyZWF0cyIsImRldGVjdEFwcHJvdmFsQWJ1c2UiLCJhbmFseXplZEFwcHJvdmFscyIsImFuYWx5emVBcHByb3ZhbHMiLCJhcHByb3ZhbCIsImlzTWFsaWNpb3VzIiwiaWQiLCJ0eXBlIiwic2V2ZXJpdHkiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwidG9rZW4iLCJzeW1ib2wiLCJ0ZWNobmljYWxEZXRhaWxzIiwic3BlbmRlciIsImRldGVjdGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJyZWxhdGVkQWRkcmVzc2VzIiwicmVsYXRlZFRyYW5zYWN0aW9ucyIsIm9uZ29pbmdSaXNrIiwicmlza1Njb3JlIiwiY2FsY3VsYXRlUmlza1Njb3JlIiwic2VjdXJpdHlTdGF0dXMiLCJkZXRlcm1pbmVTZWN1cml0eVN0YXR1cyIsInN1c3BpY2lvdXNUcmFuc2FjdGlvbnMiLCJidWlsZFN1c3BpY2lvdXNUcmFuc2FjdGlvbnMiLCJyZWNvbW1lbmRhdGlvbnMiLCJnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyIsInJlY292ZXJ5UGxhbiIsImdlbmVyYXRlUmVjb3ZlcnlQbGFuIiwidGltZXN0YW1wIiwic3VtbWFyeSIsImdlbmVyYXRlU3VtbWFyeSIsImRldGVjdGVkVGhyZWF0cyIsImFwcHJvdmFscyIsImVkdWNhdGlvbmFsQ29udGVudCIsImdlbmVyYXRlRWR1Y2F0aW9uYWxDb250ZW50IiwidXNlckFkZHJlc3MiLCJiYWxhbmNlV2VpIiwiQmlnSW50Iiwib3V0Ym91bmRUcmFuc2ZlcnMiLCJ0eCIsImZyb20iLCJ0byIsInZhbHVlIiwiaGFzaCIsInRyYW5zZmVyIiwidG9rZW5TeW1ib2wiLCJpc0N1cnJlbnRseUVtcHR5IiwiZGVzdGluYXRpb25Db3VudHMiLCJjb3VudCIsInR5cGVzIiwiU2V0IiwiaGFzaGVzIiwidGltZXN0YW1wcyIsImFkZCIsImRlc3RpbmF0aW9uIiwiZGF0YSIsIk9iamVjdCIsImVudHJpZXMiLCJoYXNNdWx0aXBsZUFzc2V0VHlwZXMiLCJzaXplIiwiaGFzTmF0aXZlQW5kVG9rZW5zIiwiaGFzIiwiQXJyYXkiLCJzb21lIiwidCIsInN0YXJ0c1dpdGgiLCJzb3J0IiwiYSIsImIiLCJ0aW1lU3BhbiIsImlzUmFwaWQiLCJub3ciLCJzbGljZSIsImpvaW4iLCJ0aHJlYXRUeXBlIiwiTWF0aCIsImNlaWwiLCJ0b3RhbFJlY2VpdmVkIiwic29ydGVkRGVzdHMiLCJmaWx0ZXIiLCJhZGRyIiwidG9wRGVzdCIsInRvcERhdGEiLCJmb3JtYXRFdGhlciIsImZsYWdnZWRBZGRyZXNzZXMiLCJpbnRlcmFjdGVkV2l0aCIsIm1hbGljaW91cyIsIm5hbWUiLCJzcGVuZGVyTWFsaWNpb3VzIiwidHJhbnNhY3Rpb25IYXNoIiwic291cmNlcyIsImZldGNoRnJvbUJsb2Nrc2NvdXQiLCJmZXRjaEZyb21FdGhlcnNjYW4iLCJmZXRjaEZuIiwicmVzdWx0IiwidXJsIiwicmVzcG9uc2UiLCJmZXRjaCIsInNpZ25hbCIsIkFib3J0U2lnbmFsIiwidGltZW91dCIsImhlYWRlcnMiLCJqc29uIiwic3RhdHVzIiwiaXNBcnJheSIsIm1lc3NhZ2UiLCJtYXAiLCJpbnB1dCIsInBhcnNlSW50IiwidGltZVN0YW1wIiwiYmxvY2tOdW1iZXIiLCJtZXRob2RJZCIsImlzRXJyb3IiLCJnYXNVc2VkIiwiYmFzZVVybCIsIm9rIiwiaXRlbXMiLCJmcm9tQWRkciIsInRvQWRkciIsInJhd19pbnB1dCIsImZsb29yIiwiZ2V0VGltZSIsImJsb2NrX251bWJlciIsImJsb2NrIiwibWV0aG9kIiwiZ2FzX3VzZWQiLCJ0b1N0cmluZyIsImZldGNoVG9rZW5zRnJvbUJsb2Nrc2NvdXQiLCJmZXRjaFRva2Vuc0Zyb21FdGhlcnNjYW4iLCJ0b2tlbkFkZHJlc3MiLCJjb250cmFjdEFkZHJlc3MiLCJ0eF9oYXNoIiwidG90YWwiLCJjb2luX2JhbGFuY2UiLCJ0b2tlbk5hbWUiLCJvd25lciIsImFtb3VudCIsInByb2Nlc3NlZCIsImV2ZW50Iiwia2V5IiwiaXNVbmxpbWl0ZWQiLCJtYWxpY2lvdXNTcGVuZGVyIiwibGVnaXRpbWF0ZVNwZW5kZXIiLCJkcmFpbmVyUmVjaXBpZW50Iiwicmlza0xldmVsIiwicmlza1JlYXNvbiIsImRlY2ltYWxzIiwic3RhbmRhcmQiLCJ2ZXJpZmllZCIsInNwZW5kZXJMYWJlbCIsImdyYW50ZWRBdCIsIm9yZGVyIiwiQ1JJVElDQUwiLCJISUdIIiwiTUVESVVNIiwiTE9XIiwic2NvcmUiLCJ0aHJlYXQiLCJtaW4iLCJoYXNDcml0aWNhbCIsImhhc0tleUNvbXByb21pc2UiLCJoYXNEcmFpbmVyIiwic3VzcGljaW91cyIsInR4SGFzaCIsImZpbmQiLCJmbGFncyIsImRyYWluZXJUaHJlYXRzIiwibWFsaWNpb3VzQXBwcm92YWxzIiwicHJpb3JpdHkiLCJjYXRlZ29yeSIsImFjdGlvbmFibGUiLCJhY3Rpb25UeXBlIiwic3RlcHMiLCJhY3Rpb24iLCJpc0NvbXByb21pc2VkIiwidXJnZW5jeUxldmVsIiwiZXN0aW1hdGVkVGltZU1pbnV0ZXMiLCJ3YXJuaW5ncyIsInNhZmVXYWxsZXRSZXF1aXJlZCIsInByaW1hcnlUeXBlIiwiZXhwbGFuYXRpb25zIiwiV0FMTEVUX0RSQUlORVIiLCJ3aGF0SGFwcGVuZWQiLCJob3dJdFdvcmtzIiwib25nb2luZ0RhbWFnZSIsInJlY292ZXJhYmxlSW5mbyIsIlBSSVZBVEVfS0VZX0xFQUsiLCJBUFBST1ZBTF9ISUpBQ0siLCJhdHRhY2tFeHBsYW5hdGlvbiIsInByZXZlbnRpb25UaXBzIiwiaW1wb3J0YW5jZSIsInNlY3VyaXR5Q2hlY2tsaXN0IiwiaXRlbSIsImNvbXBsZXRlZCIsImdlbmVyYXRlUmV2b2tlVHJhbnNhY3Rpb24iLCJzcGVuZGVyQWRkcmVzcyIsImlmYWNlIiwiSW50ZXJmYWNlIiwiZW5jb2RlRnVuY3Rpb25EYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/analyzers/evm-analyzer.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/analyzers/solana-analyzer.ts":
/*!**********************************************!*\
  !*** ./src/lib/analyzers/solana-analyzer.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SolanaAnalyzer: () => (/* binding */ SolanaAnalyzer)\n/* harmony export */ });\n/* harmony import */ var _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @solana/web3.js */ \"(rsc)/./node_modules/@solana/web3.js/lib/index.esm.js\");\n/* harmony import */ var _detection_malicious_database__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../detection/malicious-database */ \"(rsc)/./src/lib/detection/malicious-database.ts\");\n// ============================================\n// SOLANA CHAIN ANALYZER\n// ============================================\n// Handles security analysis for Solana blockchain.\n// All operations are READ-ONLY.\n\n\n// Known Solana program IDs\nconst TOKEN_PROGRAM_ID = \"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\";\nconst TOKEN_2022_PROGRAM_ID = \"TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb\";\nconst ASSOCIATED_TOKEN_PROGRAM_ID = \"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL\";\nconst MEMO_PROGRAM_ID = \"MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr\";\n// Suspicious program patterns\nconst SUSPICIOUS_PROGRAM_PATTERNS = [\n    \"drain\",\n    \"claim\",\n    \"airdrop\",\n    \"reward\"\n];\nclass SolanaAnalyzer {\n    constructor(){\n        const config = _detection_malicious_database__WEBPACK_IMPORTED_MODULE_1__.CHAIN_RPC_CONFIG.solana;\n        // Use the first RPC URL from the array, with fallback\n        const rpcUrl = config.rpcUrls?.[0] || \"https://api.mainnet-beta.solana.com\";\n        this.connection = new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.Connection(rpcUrl, \"confirmed\");\n        this.explorerApiUrl = config.explorerApi;\n    }\n    async analyzeWallet(address) {\n        // Validate Solana address\n        let publicKey;\n        try {\n            publicKey = new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.PublicKey(address);\n        } catch  {\n            throw new Error(\"Invalid Solana address\");\n        }\n        // Fetch data in parallel\n        const [transactions, tokenAccounts, balance] = await Promise.all([\n            this.fetchTransactionHistory(publicKey),\n            this.fetchTokenAccounts(publicKey),\n            this.connection.getBalance(publicKey)\n        ]);\n        // Analyze threats\n        const threats = [];\n        // Check for malicious program interactions\n        const maliciousProgramThreats = this.detectMaliciousProgramInteractions(transactions);\n        threats.push(...maliciousProgramThreats);\n        // Check for delegate abuse\n        const delegateThreats = await this.detectDelegateAbuse(tokenAccounts, publicKey);\n        threats.push(...delegateThreats);\n        // Check for rapid outflows\n        const outflowThreats = this.detectRapidOutflows(transactions, address);\n        threats.push(...outflowThreats);\n        // Check for suspicious airdrops\n        const airdropThreats = this.detectSuspiciousAirdrops(transactions, address);\n        threats.push(...airdropThreats);\n        // Analyze token account delegations (similar to EVM approvals)\n        const approvals = await this.analyzeTokenDelegations(tokenAccounts, publicKey);\n        // Calculate risk score\n        const riskScore = this.calculateRiskScore(threats, approvals);\n        const securityStatus = this.determineSecurityStatus(riskScore, threats);\n        // Generate suspicious transactions list\n        const suspiciousTransactions = this.identifySuspiciousTransactions(transactions, threats);\n        // Generate recommendations\n        const recommendations = this.generateRecommendations(threats, approvals, securityStatus);\n        // Generate recovery plan\n        const recoveryPlan = securityStatus !== \"SAFE\" ? this.generateRecoveryPlan(threats, approvals) : undefined;\n        return {\n            address,\n            chain: \"solana\",\n            timestamp: new Date().toISOString(),\n            securityStatus,\n            riskScore,\n            summary: this.generateSummary(securityStatus, threats, approvals),\n            detectedThreats: threats,\n            approvals,\n            suspiciousTransactions,\n            recommendations,\n            recoveryPlan,\n            educationalContent: this.generateEducationalContent(threats)\n        };\n    }\n    async fetchTransactionHistory(publicKey) {\n        try {\n            const signatures = await this.connection.getSignaturesForAddress(publicKey, {\n                limit: 100\n            });\n            const transactions = await Promise.all(signatures.slice(0, 50).map(async (sig)=>{\n                try {\n                    return await this.connection.getParsedTransaction(sig.signature, {\n                        maxSupportedTransactionVersion: 0\n                    });\n                } catch  {\n                    return null;\n                }\n            }));\n            return transactions.filter((tx)=>tx !== null);\n        } catch (error) {\n            console.error(\"Error fetching Solana transactions:\", error);\n            return [];\n        }\n    }\n    async fetchTokenAccounts(publicKey) {\n        try {\n            const tokenAccounts = await this.connection.getParsedTokenAccountsByOwner(publicKey, {\n                programId: new _solana_web3_js__WEBPACK_IMPORTED_MODULE_0__.PublicKey(TOKEN_PROGRAM_ID)\n            });\n            return tokenAccounts.value;\n        } catch (error) {\n            console.error(\"Error fetching token accounts:\", error);\n            return [];\n        }\n    }\n    detectMaliciousProgramInteractions(transactions) {\n        const threats = [];\n        for (const tx of transactions){\n            if (!tx.transaction?.message?.instructions) continue;\n            for (const instruction of tx.transaction.message.instructions){\n                const programId = instruction.programId.toString();\n                // Check against known malicious programs\n                if (_detection_malicious_database__WEBPACK_IMPORTED_MODULE_1__.SOLANA_MALICIOUS_PROGRAMS.includes(programId)) {\n                    threats.push({\n                        id: `malicious-program-${tx.transaction.signatures[0]}`,\n                        type: \"COMPROMISED_PROGRAM_AUTHORITY\",\n                        severity: \"CRITICAL\",\n                        title: \"Interaction with Known Malicious Program\",\n                        description: `Transaction interacted with a known malicious Solana program.`,\n                        technicalDetails: `Program: ${programId}, Signature: ${tx.transaction.signatures[0]}`,\n                        detectedAt: new Date().toISOString(),\n                        relatedAddresses: [\n                            programId\n                        ],\n                        relatedTransactions: [\n                            tx.transaction.signatures[0]\n                        ],\n                        ongoingRisk: true\n                    });\n                }\n            }\n        }\n        return threats;\n    }\n    async detectDelegateAbuse(tokenAccounts, owner) {\n        const threats = [];\n        for (const account of tokenAccounts){\n            const info = account.account.data.parsed?.info;\n            if (!info) continue;\n            // Check if token account has a delegate\n            if (info.delegate && info.delegatedAmount) {\n                const delegatedAmount = BigInt(info.delegatedAmount.amount || 0);\n                if (delegatedAmount > BigInt(0)) {\n                    // Check if delegate is malicious\n                    if (_detection_malicious_database__WEBPACK_IMPORTED_MODULE_1__.SOLANA_MALICIOUS_PROGRAMS.includes(info.delegate)) {\n                        threats.push({\n                            id: `delegate-abuse-${account.pubkey.toString()}`,\n                            type: \"APPROVAL_HIJACK\",\n                            severity: \"CRITICAL\",\n                            title: \"Token Delegated to Malicious Account\",\n                            description: \"A token account has been delegated to a known malicious address.\",\n                            technicalDetails: `Token Account: ${account.pubkey.toString()}, Delegate: ${info.delegate}`,\n                            detectedAt: new Date().toISOString(),\n                            relatedAddresses: [\n                                info.delegate\n                            ],\n                            relatedTransactions: [],\n                            ongoingRisk: true\n                        });\n                    }\n                }\n            }\n        }\n        return threats;\n    }\n    detectRapidOutflows(transactions, address) {\n        const threats = [];\n        // Group transactions by time window\n        const windowMinutes = 10;\n        const sortedTxs = [\n            ...transactions\n        ].filter((tx)=>tx.blockTime).sort((a, b)=>(a.blockTime || 0) - (b.blockTime || 0));\n        // Look for multiple outbound transfers in short window\n        for(let i = 0; i < sortedTxs.length; i++){\n            const windowStart = sortedTxs[i].blockTime || 0;\n            const windowEnd = windowStart + windowMinutes * 60;\n            const txsInWindow = sortedTxs.filter((tx)=>(tx.blockTime || 0) >= windowStart && (tx.blockTime || 0) <= windowEnd);\n            // Count outbound transfers\n            let outboundCount = 0;\n            for (const tx of txsInWindow){\n                const preBalances = tx.meta?.preBalances || [];\n                const postBalances = tx.meta?.postBalances || [];\n                // First account is usually the fee payer/signer\n                if (preBalances[0] > postBalances[0]) {\n                    outboundCount++;\n                }\n            }\n            if (outboundCount >= 5) {\n                threats.push({\n                    id: `rapid-outflow-${Date.now()}`,\n                    type: \"WALLET_DRAINER\",\n                    severity: \"CRITICAL\",\n                    title: \"Rapid Asset Outflow Detected\",\n                    description: `${outboundCount} outbound transactions detected within ${windowMinutes} minutes. This pattern is consistent with wallet drainer activity.`,\n                    technicalDetails: `Time window: ${new Date(windowStart * 1000).toISOString()}`,\n                    detectedAt: new Date().toISOString(),\n                    relatedAddresses: [],\n                    relatedTransactions: txsInWindow.map((tx)=>tx.transaction.signatures[0]),\n                    ongoingRisk: true\n                });\n                break; // Only report once\n            }\n        }\n        return threats;\n    }\n    detectSuspiciousAirdrops(transactions, address) {\n        const threats = [];\n        for (const tx of transactions){\n            if (!tx.transaction?.message?.instructions) continue;\n            // Check for unsolicited token transfers to this wallet\n            for (const instruction of tx.transaction.message.instructions){\n                if (\"parsed\" in instruction && instruction.parsed?.type === \"transfer\") {\n                    const info = instruction.parsed.info;\n                    // If receiving tokens from unknown source with memo\n                    if (info.destination === address) {\n                        // Check for suspicious memo\n                        const memoInstruction = tx.transaction.message.instructions.find((i)=>i.programId.toString() === MEMO_PROGRAM_ID);\n                        if (memoInstruction && \"parsed\" in memoInstruction) {\n                            const memoText = String(memoInstruction.parsed || \"\").toLowerCase();\n                            if (SUSPICIOUS_PROGRAM_PATTERNS.some((pattern)=>memoText.includes(pattern))) {\n                                threats.push({\n                                    id: `suspicious-airdrop-${tx.transaction.signatures[0]}`,\n                                    type: \"MALICIOUS_NFT_AIRDROP\",\n                                    severity: \"MEDIUM\",\n                                    title: \"Suspicious Airdrop Detected\",\n                                    description: \"Received tokens with suspicious memo. This may be a phishing attempt.\",\n                                    technicalDetails: `Signature: ${tx.transaction.signatures[0]}`,\n                                    detectedAt: new Date().toISOString(),\n                                    relatedAddresses: [],\n                                    relatedTransactions: [\n                                        tx.transaction.signatures[0]\n                                    ],\n                                    ongoingRisk: false\n                                });\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return threats;\n    }\n    async analyzeTokenDelegations(tokenAccounts, owner) {\n        const approvals = [];\n        for (const account of tokenAccounts){\n            const info = account.account.data.parsed?.info;\n            if (!info || !info.delegate) continue;\n            const delegatedAmount = BigInt(info.delegatedAmount?.amount || 0);\n            if (delegatedAmount === BigInt(0)) continue;\n            const isMalicious = _detection_malicious_database__WEBPACK_IMPORTED_MODULE_1__.SOLANA_MALICIOUS_PROGRAMS.includes(info.delegate);\n            approvals.push({\n                id: `delegation-${account.pubkey.toString()}`,\n                token: {\n                    address: info.mint,\n                    symbol: \"SPL\",\n                    name: \"SPL Token\",\n                    decimals: info.tokenAmount?.decimals || 9,\n                    standard: \"SPL\",\n                    verified: false\n                },\n                spender: info.delegate,\n                amount: delegatedAmount.toString(),\n                isUnlimited: false,\n                riskLevel: isMalicious ? \"CRITICAL\" : \"MEDIUM\",\n                riskReason: isMalicious ? \"Delegated to known malicious address\" : \"Active token delegation\",\n                grantedAt: new Date().toISOString(),\n                isMalicious\n            });\n        }\n        return approvals;\n    }\n    calculateRiskScore(threats, approvals) {\n        let score = 0;\n        // Critical threats\n        score += threats.filter((t)=>t.severity === \"CRITICAL\").length * 30;\n        // High threats\n        score += threats.filter((t)=>t.severity === \"HIGH\").length * 20;\n        // Medium threats\n        score += threats.filter((t)=>t.severity === \"MEDIUM\").length * 10;\n        // Malicious approvals\n        score += approvals.filter((a)=>a.isMalicious).length * 25;\n        // Any active delegations\n        score += approvals.length * 5;\n        return Math.min(100, Math.max(0, score));\n    }\n    determineSecurityStatus(riskScore, threats) {\n        const hasCritical = threats.some((t)=>t.severity === \"CRITICAL\" && t.ongoingRisk);\n        if (hasCritical || riskScore >= 70) return \"COMPROMISED\";\n        if (riskScore >= 30 || threats.length > 0) return \"AT_RISK\";\n        return \"SAFE\";\n    }\n    identifySuspiciousTransactions(transactions, threats) {\n        const suspiciousSigs = new Set(threats.flatMap((t)=>t.relatedTransactions));\n        return transactions.filter((tx)=>suspiciousSigs.has(tx.transaction.signatures[0])).map((tx)=>{\n            const relatedThreat = threats.find((t)=>t.relatedTransactions.includes(tx.transaction.signatures[0]));\n            return {\n                hash: tx.transaction.signatures[0],\n                timestamp: tx.blockTime ? new Date(tx.blockTime * 1000).toISOString() : new Date().toISOString(),\n                type: relatedThreat?.type || \"UNKNOWN\",\n                from: tx.transaction.message.accountKeys[0]?.pubkey.toString() || \"\",\n                to: tx.transaction.message.accountKeys[1]?.pubkey.toString() || \"\",\n                riskLevel: relatedThreat?.severity || \"MEDIUM\",\n                flags: relatedThreat ? [\n                    relatedThreat.title\n                ] : [],\n                description: relatedThreat?.description || \"Suspicious activity detected\"\n            };\n        });\n    }\n    generateRecommendations(threats, approvals, status) {\n        const recommendations = [];\n        // Malicious delegations\n        const maliciousDelegations = approvals.filter((a)=>a.isMalicious);\n        if (maliciousDelegations.length > 0) {\n            recommendations.push({\n                id: \"revoke-delegations\",\n                priority: \"CRITICAL\",\n                category: \"IMMEDIATE\",\n                title: \"Revoke Malicious Token Delegations\",\n                description: `You have ${maliciousDelegations.length} token account${maliciousDelegations.length > 1 ? \"s\" : \"\"} delegated to malicious addresses.`,\n                actionable: true,\n                actionType: \"DELEGATE_REVOKE\"\n            });\n        }\n        // Active drainer\n        if (threats.some((t)=>t.type === \"WALLET_DRAINER\" && t.ongoingRisk)) {\n            recommendations.push({\n                id: \"move-assets\",\n                priority: \"CRITICAL\",\n                category: \"IMMEDIATE\",\n                title: \"Transfer Assets to Fresh Wallet\",\n                description: \"Create a new Solana wallet and transfer all remaining assets immediately.\",\n                actionable: true,\n                actionType: \"TRANSFER_ASSETS\"\n            });\n        }\n        // Close empty token accounts (cleanup)\n        recommendations.push({\n            id: \"close-token-accounts\",\n            priority: \"LOW\",\n            category: \"LONG_TERM\",\n            title: \"Close Unused Token Accounts\",\n            description: \"Close empty token accounts to reclaim rent SOL. This also removes potential attack surface.\",\n            actionable: true,\n            actionType: \"CLOSE_ACCOUNT\"\n        });\n        // General security\n        recommendations.push({\n            id: \"use-hardware-wallet\",\n            priority: \"MEDIUM\",\n            category: \"SHORT_TERM\",\n            title: \"Use Hardware Wallet\",\n            description: \"Consider using a Ledger or other hardware wallet for better key security.\",\n            actionable: false\n        });\n        return recommendations;\n    }\n    generateRecoveryPlan(threats, approvals) {\n        const steps = [];\n        let order = 1;\n        // Step 1: Revoke malicious delegations\n        const maliciousDelegations = approvals.filter((a)=>a.isMalicious);\n        if (maliciousDelegations.length > 0) {\n            steps.push({\n                order: order++,\n                title: \"Revoke Token Delegations\",\n                description: `Revoke ${maliciousDelegations.length} malicious token delegation${maliciousDelegations.length > 1 ? \"s\" : \"\"}.`,\n                action: {\n                    type: \"DELEGATE_REVOKE\"\n                },\n                priority: \"IMMEDIATE\"\n            });\n        }\n        // Step 2: Transfer assets if ongoing risk\n        if (threats.some((t)=>t.ongoingRisk)) {\n            steps.push({\n                order: order++,\n                title: \"Transfer All Assets\",\n                description: \"Move all SOL and tokens to a new, secure wallet.\",\n                action: {\n                    type: \"TRANSFER_ASSETS\"\n                },\n                priority: \"IMMEDIATE\"\n            });\n        }\n        // Step 3: Close token accounts\n        steps.push({\n            order: order++,\n            title: \"Close Token Accounts\",\n            description: \"Close all token accounts on the compromised wallet to reclaim rent.\",\n            action: {\n                type: \"CLOSE_ACCOUNT\"\n            },\n            priority: \"HIGH\"\n        });\n        return {\n            urgencyLevel: threats.some((t)=>t.severity === \"CRITICAL\") ? \"CRITICAL\" : \"HIGH\",\n            estimatedTimeMinutes: steps.length * 3,\n            steps,\n            warnings: [\n                \"Verify you are on the official Solana wallet or dApp\",\n                \"Never share your seed phrase\",\n                'Be cautious of anyone offering \"recovery services\"'\n            ],\n            safeWalletRequired: true\n        };\n    }\n    generateSummary(status, threats, approvals) {\n        if (status === \"SAFE\") {\n            return \"No significant security threats detected on your Solana wallet. Continue practicing safe wallet hygiene.\";\n        }\n        if (status === \"AT_RISK\") {\n            return `${threats.length} potential security concern${threats.length !== 1 ? \"s\" : \"\"} detected. Review the findings and take preventive action.`;\n        }\n        return `URGENT: Critical security threats detected on your Solana wallet. Immediate action required to protect remaining assets.`;\n    }\n    generateEducationalContent(threats) {\n        return {\n            attackExplanation: {\n                whatHappened: \"Suspicious activity was detected on your Solana wallet.\",\n                howItWorks: \"Solana-specific attacks can include malicious program interactions, token delegation abuse, and phishing airdrops.\",\n                ongoingDamage: \"If delegations or program authorities are still active, your assets may still be at risk.\",\n                recoverableInfo: \"Transfer remaining assets to a fresh wallet and revoke all delegations.\"\n            },\n            preventionTips: [\n                {\n                    title: \"Verify Program IDs\",\n                    description: \"Always verify the program ID before signing Solana transactions. Use official documentation.\",\n                    importance: \"HIGH\"\n                },\n                {\n                    title: \"Be Cautious of Airdrops\",\n                    description: \"Do not interact with unsolicited token airdrops. They may be phishing attempts.\",\n                    importance: \"MEDIUM\"\n                },\n                {\n                    title: \"Review Token Account Delegations\",\n                    description: \"Regularly check if any of your token accounts have active delegations.\",\n                    importance: \"MEDIUM\"\n                }\n            ],\n            securityChecklist: [\n                {\n                    id: \"1\",\n                    category: \"Wallet\",\n                    item: \"Use hardware wallet for significant holdings\",\n                    completed: false,\n                    chainSpecific: [\n                        \"solana\"\n                    ]\n                },\n                {\n                    id: \"2\",\n                    category: \"Wallet\",\n                    item: \"Backup seed phrase securely offline\",\n                    completed: false\n                },\n                {\n                    id: \"3\",\n                    category: \"Transactions\",\n                    item: \"Verify program IDs before signing\",\n                    completed: false,\n                    chainSpecific: [\n                        \"solana\"\n                    ]\n                },\n                {\n                    id: \"4\",\n                    category: \"Tokens\",\n                    item: \"Close unused token accounts\",\n                    completed: false,\n                    chainSpecific: [\n                        \"solana\"\n                    ]\n                },\n                {\n                    id: \"5\",\n                    category: \"Security\",\n                    item: \"Avoid clicking airdrop links\",\n                    completed: false\n                }\n            ]\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FuYWx5emVycy9zb2xhbmEtYW5hbHl6ZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsK0NBQStDO0FBQy9DLHdCQUF3QjtBQUN4QiwrQ0FBK0M7QUFDL0MsbURBQW1EO0FBQ25ELGdDQUFnQztBQU9QO0FBYXFFO0FBRTlGLDJCQUEyQjtBQUMzQixNQUFNSSxtQkFBbUI7QUFDekIsTUFBTUMsd0JBQXdCO0FBQzlCLE1BQU1DLDhCQUE4QjtBQUNwQyxNQUFNQyxrQkFBa0I7QUFFeEIsOEJBQThCO0FBQzlCLE1BQU1DLDhCQUE4QjtJQUNsQztJQUNBO0lBQ0E7SUFDQTtDQUNEO0FBRU0sTUFBTUM7SUFJWEMsYUFBYztRQUNaLE1BQU1DLFNBQVNULDJFQUFnQkEsQ0FBQ1UsTUFBTTtRQUN0QyxzREFBc0Q7UUFDdEQsTUFBTUMsU0FBU0YsT0FBT0csT0FBTyxFQUFFLENBQUMsRUFBRSxJQUFJO1FBQ3RDLElBQUksQ0FBQ0MsVUFBVSxHQUFHLElBQUlmLHVEQUFVQSxDQUFDYSxRQUFRO1FBQ3pDLElBQUksQ0FBQ0csY0FBYyxHQUFHTCxPQUFPTSxXQUFXO0lBQzFDO0lBRUEsTUFBTUMsY0FBY0MsT0FBZSxFQUFpQztRQUNsRSwwQkFBMEI7UUFDMUIsSUFBSUM7UUFDSixJQUFJO1lBQ0ZBLFlBQVksSUFBSW5CLHNEQUFTQSxDQUFDa0I7UUFDNUIsRUFBRSxPQUFNO1lBQ04sTUFBTSxJQUFJRSxNQUFNO1FBQ2xCO1FBRUEseUJBQXlCO1FBQ3pCLE1BQU0sQ0FBQ0MsY0FBY0MsZUFBZUMsUUFBUSxHQUFHLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQztZQUMvRCxJQUFJLENBQUNDLHVCQUF1QixDQUFDUDtZQUM3QixJQUFJLENBQUNRLGtCQUFrQixDQUFDUjtZQUN4QixJQUFJLENBQUNMLFVBQVUsQ0FBQ2MsVUFBVSxDQUFDVDtTQUM1QjtRQUVELGtCQUFrQjtRQUNsQixNQUFNVSxVQUE0QixFQUFFO1FBRXBDLDJDQUEyQztRQUMzQyxNQUFNQywwQkFBMEIsSUFBSSxDQUFDQyxrQ0FBa0MsQ0FBQ1Y7UUFDeEVRLFFBQVFHLElBQUksSUFBSUY7UUFFaEIsMkJBQTJCO1FBQzNCLE1BQU1HLGtCQUFrQixNQUFNLElBQUksQ0FBQ0MsbUJBQW1CLENBQUNaLGVBQWVIO1FBQ3RFVSxRQUFRRyxJQUFJLElBQUlDO1FBRWhCLDJCQUEyQjtRQUMzQixNQUFNRSxpQkFBaUIsSUFBSSxDQUFDQyxtQkFBbUIsQ0FBQ2YsY0FBY0g7UUFDOURXLFFBQVFHLElBQUksSUFBSUc7UUFFaEIsZ0NBQWdDO1FBQ2hDLE1BQU1FLGlCQUFpQixJQUFJLENBQUNDLHdCQUF3QixDQUFDakIsY0FBY0g7UUFDbkVXLFFBQVFHLElBQUksSUFBSUs7UUFFaEIsK0RBQStEO1FBQy9ELE1BQU1FLFlBQVksTUFBTSxJQUFJLENBQUNDLHVCQUF1QixDQUFDbEIsZUFBZUg7UUFFcEUsdUJBQXVCO1FBQ3ZCLE1BQU1zQixZQUFZLElBQUksQ0FBQ0Msa0JBQWtCLENBQUNiLFNBQVNVO1FBQ25ELE1BQU1JLGlCQUFpQixJQUFJLENBQUNDLHVCQUF1QixDQUFDSCxXQUFXWjtRQUUvRCx3Q0FBd0M7UUFDeEMsTUFBTWdCLHlCQUF5QixJQUFJLENBQUNDLDhCQUE4QixDQUFDekIsY0FBY1E7UUFFakYsMkJBQTJCO1FBQzNCLE1BQU1rQixrQkFBa0IsSUFBSSxDQUFDQyx1QkFBdUIsQ0FBQ25CLFNBQVNVLFdBQVdJO1FBRXpFLHlCQUF5QjtRQUN6QixNQUFNTSxlQUFlTixtQkFBbUIsU0FDcEMsSUFBSSxDQUFDTyxvQkFBb0IsQ0FBQ3JCLFNBQVNVLGFBQ25DWTtRQUVKLE9BQU87WUFDTGpDO1lBQ0FrQyxPQUFPO1lBQ1BDLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztZQUNqQ1o7WUFDQUY7WUFDQWUsU0FBUyxJQUFJLENBQUNDLGVBQWUsQ0FBQ2QsZ0JBQWdCZCxTQUFTVTtZQUN2RG1CLGlCQUFpQjdCO1lBQ2pCVTtZQUNBTTtZQUNBRTtZQUNBRTtZQUNBVSxvQkFBb0IsSUFBSSxDQUFDQywwQkFBMEIsQ0FBQy9CO1FBQ3REO0lBQ0Y7SUFFQSxNQUFjSCx3QkFBd0JQLFNBQW9CLEVBQXdDO1FBQ2hHLElBQUk7WUFDRixNQUFNMEMsYUFBYSxNQUFNLElBQUksQ0FBQy9DLFVBQVUsQ0FBQ2dELHVCQUF1QixDQUFDM0MsV0FBVztnQkFBRTRDLE9BQU87WUFBSTtZQUV6RixNQUFNMUMsZUFBZSxNQUFNRyxRQUFRQyxHQUFHLENBQ3BDb0MsV0FBV0csS0FBSyxDQUFDLEdBQUcsSUFBSUMsR0FBRyxDQUFDLE9BQU9DO2dCQUNqQyxJQUFJO29CQUNGLE9BQU8sTUFBTSxJQUFJLENBQUNwRCxVQUFVLENBQUNxRCxvQkFBb0IsQ0FBQ0QsSUFBSUUsU0FBUyxFQUFFO3dCQUMvREMsZ0NBQWdDO29CQUNsQztnQkFDRixFQUFFLE9BQU07b0JBQ04sT0FBTztnQkFDVDtZQUNGO1lBR0YsT0FBT2hELGFBQWFpRCxNQUFNLENBQUMsQ0FBQ0MsS0FBd0NBLE9BQU87UUFDN0UsRUFBRSxPQUFPQyxPQUFPO1lBQ2RDLFFBQVFELEtBQUssQ0FBQyx1Q0FBdUNBO1lBQ3JELE9BQU8sRUFBRTtRQUNYO0lBQ0Y7SUFFQSxNQUFjN0MsbUJBQW1CUixTQUFvQixFQUFrQjtRQUNyRSxJQUFJO1lBQ0YsTUFBTUcsZ0JBQWdCLE1BQU0sSUFBSSxDQUFDUixVQUFVLENBQUM0RCw2QkFBNkIsQ0FBQ3ZELFdBQVc7Z0JBQ25Gd0QsV0FBVyxJQUFJM0Usc0RBQVNBLENBQUNHO1lBQzNCO1lBRUEsT0FBT21CLGNBQWNzRCxLQUFLO1FBQzVCLEVBQUUsT0FBT0osT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMsa0NBQWtDQTtZQUNoRCxPQUFPLEVBQUU7UUFDWDtJQUNGO0lBRVF6QyxtQ0FBbUNWLFlBQXlDLEVBQW9CO1FBQ3RHLE1BQU1RLFVBQTRCLEVBQUU7UUFFcEMsS0FBSyxNQUFNMEMsTUFBTWxELGFBQWM7WUFDN0IsSUFBSSxDQUFDa0QsR0FBR00sV0FBVyxFQUFFQyxTQUFTQyxjQUFjO1lBRTVDLEtBQUssTUFBTUMsZUFBZVQsR0FBR00sV0FBVyxDQUFDQyxPQUFPLENBQUNDLFlBQVksQ0FBRTtnQkFDN0QsTUFBTUosWUFBWUssWUFBWUwsU0FBUyxDQUFDTSxRQUFRO2dCQUVoRCx5Q0FBeUM7Z0JBQ3pDLElBQUkvRSxvRkFBeUJBLENBQUNnRixRQUFRLENBQUNQLFlBQVk7b0JBQ2pEOUMsUUFBUUcsSUFBSSxDQUFDO3dCQUNYbUQsSUFBSSxDQUFDLGtCQUFrQixFQUFFWixHQUFHTSxXQUFXLENBQUNoQixVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7d0JBQ3ZEdUIsTUFBTTt3QkFDTkMsVUFBVTt3QkFDVkMsT0FBTzt3QkFDUEMsYUFBYSxDQUFDLDZEQUE2RCxDQUFDO3dCQUM1RUMsa0JBQWtCLENBQUMsU0FBUyxFQUFFYixVQUFVLGFBQWEsRUFBRUosR0FBR00sV0FBVyxDQUFDaEIsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUNyRjRCLFlBQVksSUFBSW5DLE9BQU9DLFdBQVc7d0JBQ2xDbUMsa0JBQWtCOzRCQUFDZjt5QkFBVTt3QkFDN0JnQixxQkFBcUI7NEJBQUNwQixHQUFHTSxXQUFXLENBQUNoQixVQUFVLENBQUMsRUFBRTt5QkFBQzt3QkFDbkQrQixhQUFhO29CQUNmO2dCQUNGO1lBQ0Y7UUFDRjtRQUVBLE9BQU8vRDtJQUNUO0lBRUEsTUFBY0ssb0JBQW9CWixhQUFvQixFQUFFdUUsS0FBZ0IsRUFBNkI7UUFDbkcsTUFBTWhFLFVBQTRCLEVBQUU7UUFFcEMsS0FBSyxNQUFNaUUsV0FBV3hFLGNBQWU7WUFDbkMsTUFBTXlFLE9BQU9ELFFBQVFBLE9BQU8sQ0FBQ0UsSUFBSSxDQUFDQyxNQUFNLEVBQUVGO1lBQzFDLElBQUksQ0FBQ0EsTUFBTTtZQUVYLHdDQUF3QztZQUN4QyxJQUFJQSxLQUFLRyxRQUFRLElBQUlILEtBQUtJLGVBQWUsRUFBRTtnQkFDekMsTUFBTUEsa0JBQWtCQyxPQUFPTCxLQUFLSSxlQUFlLENBQUNFLE1BQU0sSUFBSTtnQkFFOUQsSUFBSUYsa0JBQWtCQyxPQUFPLElBQUk7b0JBQy9CLGlDQUFpQztvQkFDakMsSUFBSWxHLG9GQUF5QkEsQ0FBQ2dGLFFBQVEsQ0FBQ2EsS0FBS0csUUFBUSxHQUFHO3dCQUNyRHJFLFFBQVFHLElBQUksQ0FBQzs0QkFDWG1ELElBQUksQ0FBQyxlQUFlLEVBQUVXLFFBQVFRLE1BQU0sQ0FBQ3JCLFFBQVEsR0FBRyxDQUFDOzRCQUNqREcsTUFBTTs0QkFDTkMsVUFBVTs0QkFDVkMsT0FBTzs0QkFDUEMsYUFBYTs0QkFDYkMsa0JBQWtCLENBQUMsZUFBZSxFQUFFTSxRQUFRUSxNQUFNLENBQUNyQixRQUFRLEdBQUcsWUFBWSxFQUFFYyxLQUFLRyxRQUFRLENBQUMsQ0FBQzs0QkFDM0ZULFlBQVksSUFBSW5DLE9BQU9DLFdBQVc7NEJBQ2xDbUMsa0JBQWtCO2dDQUFDSyxLQUFLRyxRQUFROzZCQUFDOzRCQUNqQ1AscUJBQXFCLEVBQUU7NEJBQ3ZCQyxhQUFhO3dCQUNmO29CQUNGO2dCQUNGO1lBQ0Y7UUFDRjtRQUVBLE9BQU8vRDtJQUNUO0lBRVFPLG9CQUFvQmYsWUFBeUMsRUFBRUgsT0FBZSxFQUFvQjtRQUN4RyxNQUFNVyxVQUE0QixFQUFFO1FBRXBDLG9DQUFvQztRQUNwQyxNQUFNMEUsZ0JBQWdCO1FBQ3RCLE1BQU1DLFlBQVk7ZUFBSW5GO1NBQWEsQ0FDaENpRCxNQUFNLENBQUMsQ0FBQ0MsS0FBT0EsR0FBR2tDLFNBQVMsRUFDM0JDLElBQUksQ0FBQyxDQUFDQyxHQUFHQyxJQUFNLENBQUNELEVBQUVGLFNBQVMsSUFBSSxLQUFNRyxDQUFBQSxFQUFFSCxTQUFTLElBQUk7UUFFdkQsdURBQXVEO1FBQ3ZELElBQUssSUFBSUksSUFBSSxHQUFHQSxJQUFJTCxVQUFVTSxNQUFNLEVBQUVELElBQUs7WUFDekMsTUFBTUUsY0FBY1AsU0FBUyxDQUFDSyxFQUFFLENBQUNKLFNBQVMsSUFBSTtZQUM5QyxNQUFNTyxZQUFZRCxjQUFjUixnQkFBZ0I7WUFFaEQsTUFBTVUsY0FBY1QsVUFBVWxDLE1BQU0sQ0FDbEMsQ0FBQ0MsS0FBTyxDQUFDQSxHQUFHa0MsU0FBUyxJQUFJLE1BQU1NLGVBQWUsQ0FBQ3hDLEdBQUdrQyxTQUFTLElBQUksTUFBTU87WUFHdkUsMkJBQTJCO1lBQzNCLElBQUlFLGdCQUFnQjtZQUNwQixLQUFLLE1BQU0zQyxNQUFNMEMsWUFBYTtnQkFDNUIsTUFBTUUsY0FBYzVDLEdBQUc2QyxJQUFJLEVBQUVELGVBQWUsRUFBRTtnQkFDOUMsTUFBTUUsZUFBZTlDLEdBQUc2QyxJQUFJLEVBQUVDLGdCQUFnQixFQUFFO2dCQUVoRCxnREFBZ0Q7Z0JBQ2hELElBQUlGLFdBQVcsQ0FBQyxFQUFFLEdBQUdFLFlBQVksQ0FBQyxFQUFFLEVBQUU7b0JBQ3BDSDtnQkFDRjtZQUNGO1lBRUEsSUFBSUEsaUJBQWlCLEdBQUc7Z0JBQ3RCckYsUUFBUUcsSUFBSSxDQUFDO29CQUNYbUQsSUFBSSxDQUFDLGNBQWMsRUFBRTdCLEtBQUtnRSxHQUFHLEdBQUcsQ0FBQztvQkFDakNsQyxNQUFNO29CQUNOQyxVQUFVO29CQUNWQyxPQUFPO29CQUNQQyxhQUFhLENBQUMsRUFBRTJCLGNBQWMsdUNBQXVDLEVBQUVYLGNBQWMsa0VBQWtFLENBQUM7b0JBQ3hKZixrQkFBa0IsQ0FBQyxhQUFhLEVBQUUsSUFBSWxDLEtBQUt5RCxjQUFjLE1BQU14RCxXQUFXLEdBQUcsQ0FBQztvQkFDOUVrQyxZQUFZLElBQUluQyxPQUFPQyxXQUFXO29CQUNsQ21DLGtCQUFrQixFQUFFO29CQUNwQkMscUJBQXFCc0IsWUFBWWhELEdBQUcsQ0FBQyxDQUFDTSxLQUFPQSxHQUFHTSxXQUFXLENBQUNoQixVQUFVLENBQUMsRUFBRTtvQkFDekUrQixhQUFhO2dCQUNmO2dCQUNBLE9BQU8sbUJBQW1CO1lBQzVCO1FBQ0Y7UUFFQSxPQUFPL0Q7SUFDVDtJQUVRUyx5QkFBeUJqQixZQUF5QyxFQUFFSCxPQUFlLEVBQW9CO1FBQzdHLE1BQU1XLFVBQTRCLEVBQUU7UUFFcEMsS0FBSyxNQUFNMEMsTUFBTWxELGFBQWM7WUFDN0IsSUFBSSxDQUFDa0QsR0FBR00sV0FBVyxFQUFFQyxTQUFTQyxjQUFjO1lBRTVDLHVEQUF1RDtZQUN2RCxLQUFLLE1BQU1DLGVBQWVULEdBQUdNLFdBQVcsQ0FBQ0MsT0FBTyxDQUFDQyxZQUFZLENBQUU7Z0JBQzdELElBQUksWUFBWUMsZUFBZUEsWUFBWWlCLE1BQU0sRUFBRWIsU0FBUyxZQUFZO29CQUN0RSxNQUFNVyxPQUFPZixZQUFZaUIsTUFBTSxDQUFDRixJQUFJO29CQUVwQyxvREFBb0Q7b0JBQ3BELElBQUlBLEtBQUt3QixXQUFXLEtBQUtyRyxTQUFTO3dCQUNoQyw0QkFBNEI7d0JBQzVCLE1BQU1zRyxrQkFBa0JqRCxHQUFHTSxXQUFXLENBQUNDLE9BQU8sQ0FBQ0MsWUFBWSxDQUFDMEMsSUFBSSxDQUM5RCxDQUFDWixJQUFNQSxFQUFFbEMsU0FBUyxDQUFDTSxRQUFRLE9BQU8zRTt3QkFHcEMsSUFBSWtILG1CQUFtQixZQUFZQSxpQkFBaUI7NEJBQ2xELE1BQU1FLFdBQVdDLE9BQU9ILGdCQUFnQnZCLE1BQU0sSUFBSSxJQUFJMkIsV0FBVzs0QkFFakUsSUFBSXJILDRCQUE0QnNILElBQUksQ0FBQyxDQUFDQyxVQUFZSixTQUFTeEMsUUFBUSxDQUFDNEMsV0FBVztnQ0FDN0VqRyxRQUFRRyxJQUFJLENBQUM7b0NBQ1htRCxJQUFJLENBQUMsbUJBQW1CLEVBQUVaLEdBQUdNLFdBQVcsQ0FBQ2hCLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztvQ0FDeER1QixNQUFNO29DQUNOQyxVQUFVO29DQUNWQyxPQUFPO29DQUNQQyxhQUFhO29DQUNiQyxrQkFBa0IsQ0FBQyxXQUFXLEVBQUVqQixHQUFHTSxXQUFXLENBQUNoQixVQUFVLENBQUMsRUFBRSxDQUFDLENBQUM7b0NBQzlENEIsWUFBWSxJQUFJbkMsT0FBT0MsV0FBVztvQ0FDbENtQyxrQkFBa0IsRUFBRTtvQ0FDcEJDLHFCQUFxQjt3Q0FBQ3BCLEdBQUdNLFdBQVcsQ0FBQ2hCLFVBQVUsQ0FBQyxFQUFFO3FDQUFDO29DQUNuRCtCLGFBQWE7Z0NBQ2Y7NEJBQ0Y7d0JBQ0Y7b0JBQ0Y7Z0JBQ0Y7WUFDRjtRQUNGO1FBRUEsT0FBTy9EO0lBQ1Q7SUFFQSxNQUFjVyx3QkFBd0JsQixhQUFvQixFQUFFdUUsS0FBZ0IsRUFBNEI7UUFDdEcsTUFBTXRELFlBQTZCLEVBQUU7UUFFckMsS0FBSyxNQUFNdUQsV0FBV3hFLGNBQWU7WUFDbkMsTUFBTXlFLE9BQU9ELFFBQVFBLE9BQU8sQ0FBQ0UsSUFBSSxDQUFDQyxNQUFNLEVBQUVGO1lBQzFDLElBQUksQ0FBQ0EsUUFBUSxDQUFDQSxLQUFLRyxRQUFRLEVBQUU7WUFFN0IsTUFBTUMsa0JBQWtCQyxPQUFPTCxLQUFLSSxlQUFlLEVBQUVFLFVBQVU7WUFDL0QsSUFBSUYsb0JBQW9CQyxPQUFPLElBQUk7WUFFbkMsTUFBTTJCLGNBQWM3SCxvRkFBeUJBLENBQUNnRixRQUFRLENBQUNhLEtBQUtHLFFBQVE7WUFFcEUzRCxVQUFVUCxJQUFJLENBQUM7Z0JBQ2JtRCxJQUFJLENBQUMsV0FBVyxFQUFFVyxRQUFRUSxNQUFNLENBQUNyQixRQUFRLEdBQUcsQ0FBQztnQkFDN0MrQyxPQUFPO29CQUNMOUcsU0FBUzZFLEtBQUtrQyxJQUFJO29CQUNsQkMsUUFBUTtvQkFDUkMsTUFBTTtvQkFDTkMsVUFBVXJDLEtBQUtzQyxXQUFXLEVBQUVELFlBQVk7b0JBQ3hDRSxVQUFVO29CQUNWQyxVQUFVO2dCQUNaO2dCQUNBQyxTQUFTekMsS0FBS0csUUFBUTtnQkFDdEJHLFFBQVFGLGdCQUFnQmxCLFFBQVE7Z0JBQ2hDd0QsYUFBYTtnQkFDYkMsV0FBV1gsY0FBYyxhQUFhO2dCQUN0Q1ksWUFBWVosY0FDUix5Q0FDQTtnQkFDSmEsV0FBVyxJQUFJdEYsT0FBT0MsV0FBVztnQkFDakN3RTtZQUNGO1FBQ0Y7UUFFQSxPQUFPeEY7SUFDVDtJQUVRRyxtQkFBbUJiLE9BQXlCLEVBQUVVLFNBQTBCLEVBQVU7UUFDeEYsSUFBSXNHLFFBQVE7UUFFWixtQkFBbUI7UUFDbkJBLFNBQVNoSCxRQUFReUMsTUFBTSxDQUFDLENBQUN3RSxJQUFNQSxFQUFFekQsUUFBUSxLQUFLLFlBQVl5QixNQUFNLEdBQUc7UUFDbkUsZUFBZTtRQUNmK0IsU0FBU2hILFFBQVF5QyxNQUFNLENBQUMsQ0FBQ3dFLElBQU1BLEVBQUV6RCxRQUFRLEtBQUssUUFBUXlCLE1BQU0sR0FBRztRQUMvRCxpQkFBaUI7UUFDakIrQixTQUFTaEgsUUFBUXlDLE1BQU0sQ0FBQyxDQUFDd0UsSUFBTUEsRUFBRXpELFFBQVEsS0FBSyxVQUFVeUIsTUFBTSxHQUFHO1FBQ2pFLHNCQUFzQjtRQUN0QitCLFNBQVN0RyxVQUFVK0IsTUFBTSxDQUFDLENBQUNxQyxJQUFNQSxFQUFFb0IsV0FBVyxFQUFFakIsTUFBTSxHQUFHO1FBQ3pELHlCQUF5QjtRQUN6QitCLFNBQVN0RyxVQUFVdUUsTUFBTSxHQUFHO1FBRTVCLE9BQU9pQyxLQUFLQyxHQUFHLENBQUMsS0FBS0QsS0FBS0UsR0FBRyxDQUFDLEdBQUdKO0lBQ25DO0lBRVFqRyx3QkFBd0JILFNBQWlCLEVBQUVaLE9BQXlCLEVBQWtCO1FBQzVGLE1BQU1xSCxjQUFjckgsUUFBUWdHLElBQUksQ0FBQyxDQUFDaUIsSUFBTUEsRUFBRXpELFFBQVEsS0FBSyxjQUFjeUQsRUFBRWxELFdBQVc7UUFFbEYsSUFBSXNELGVBQWV6RyxhQUFhLElBQUksT0FBTztRQUMzQyxJQUFJQSxhQUFhLE1BQU1aLFFBQVFpRixNQUFNLEdBQUcsR0FBRyxPQUFPO1FBQ2xELE9BQU87SUFDVDtJQUVRaEUsK0JBQ056QixZQUF5QyxFQUN6Q1EsT0FBeUIsRUFDQTtRQUN6QixNQUFNc0gsaUJBQWlCLElBQUlDLElBQUl2SCxRQUFRd0gsT0FBTyxDQUFDLENBQUNQLElBQU1BLEVBQUVuRCxtQkFBbUI7UUFFM0UsT0FBT3RFLGFBQ0ppRCxNQUFNLENBQUMsQ0FBQ0MsS0FBTzRFLGVBQWVHLEdBQUcsQ0FBQy9FLEdBQUdNLFdBQVcsQ0FBQ2hCLFVBQVUsQ0FBQyxFQUFFLEdBQzlESSxHQUFHLENBQUMsQ0FBQ007WUFDSixNQUFNZ0YsZ0JBQWdCMUgsUUFBUTRGLElBQUksQ0FBQyxDQUFDcUIsSUFDbENBLEVBQUVuRCxtQkFBbUIsQ0FBQ1QsUUFBUSxDQUFDWCxHQUFHTSxXQUFXLENBQUNoQixVQUFVLENBQUMsRUFBRTtZQUc3RCxPQUFPO2dCQUNMMkYsTUFBTWpGLEdBQUdNLFdBQVcsQ0FBQ2hCLFVBQVUsQ0FBQyxFQUFFO2dCQUNsQ1IsV0FBV2tCLEdBQUdrQyxTQUFTLEdBQ25CLElBQUluRCxLQUFLaUIsR0FBR2tDLFNBQVMsR0FBRyxNQUFNbEQsV0FBVyxLQUN6QyxJQUFJRCxPQUFPQyxXQUFXO2dCQUMxQjZCLE1BQU1tRSxlQUFlbkUsUUFBUTtnQkFDN0JxRSxNQUFNbEYsR0FBR00sV0FBVyxDQUFDQyxPQUFPLENBQUM0RSxXQUFXLENBQUMsRUFBRSxFQUFFcEQsT0FBT3JCLGNBQWM7Z0JBQ2xFMEUsSUFBSXBGLEdBQUdNLFdBQVcsQ0FBQ0MsT0FBTyxDQUFDNEUsV0FBVyxDQUFDLEVBQUUsRUFBRXBELE9BQU9yQixjQUFjO2dCQUNoRXlELFdBQVdhLGVBQWVsRSxZQUFZO2dCQUN0Q3VFLE9BQU9MLGdCQUFnQjtvQkFBQ0EsY0FBY2pFLEtBQUs7aUJBQUMsR0FBRyxFQUFFO2dCQUNqREMsYUFBYWdFLGVBQWVoRSxlQUFlO1lBQzdDO1FBQ0Y7SUFDSjtJQUVRdkMsd0JBQ05uQixPQUF5QixFQUN6QlUsU0FBMEIsRUFDMUJzSCxNQUFzQixFQUNJO1FBQzFCLE1BQU05RyxrQkFBNEMsRUFBRTtRQUVwRCx3QkFBd0I7UUFDeEIsTUFBTStHLHVCQUF1QnZILFVBQVUrQixNQUFNLENBQUMsQ0FBQ3FDLElBQU1BLEVBQUVvQixXQUFXO1FBQ2xFLElBQUkrQixxQkFBcUJoRCxNQUFNLEdBQUcsR0FBRztZQUNuQy9ELGdCQUFnQmYsSUFBSSxDQUFDO2dCQUNuQm1ELElBQUk7Z0JBQ0o0RSxVQUFVO2dCQUNWQyxVQUFVO2dCQUNWMUUsT0FBTztnQkFDUEMsYUFBYSxDQUFDLFNBQVMsRUFBRXVFLHFCQUFxQmhELE1BQU0sQ0FBQyxjQUFjLEVBQUVnRCxxQkFBcUJoRCxNQUFNLEdBQUcsSUFBSSxNQUFNLEdBQUcsa0NBQWtDLENBQUM7Z0JBQ25KbUQsWUFBWTtnQkFDWkMsWUFBWTtZQUNkO1FBQ0Y7UUFFQSxpQkFBaUI7UUFDakIsSUFBSXJJLFFBQVFnRyxJQUFJLENBQUMsQ0FBQ2lCLElBQU1BLEVBQUUxRCxJQUFJLEtBQUssb0JBQW9CMEQsRUFBRWxELFdBQVcsR0FBRztZQUNyRTdDLGdCQUFnQmYsSUFBSSxDQUFDO2dCQUNuQm1ELElBQUk7Z0JBQ0o0RSxVQUFVO2dCQUNWQyxVQUFVO2dCQUNWMUUsT0FBTztnQkFDUEMsYUFBYTtnQkFDYjBFLFlBQVk7Z0JBQ1pDLFlBQVk7WUFDZDtRQUNGO1FBRUEsdUNBQXVDO1FBQ3ZDbkgsZ0JBQWdCZixJQUFJLENBQUM7WUFDbkJtRCxJQUFJO1lBQ0o0RSxVQUFVO1lBQ1ZDLFVBQVU7WUFDVjFFLE9BQU87WUFDUEMsYUFBYTtZQUNiMEUsWUFBWTtZQUNaQyxZQUFZO1FBQ2Q7UUFFQSxtQkFBbUI7UUFDbkJuSCxnQkFBZ0JmLElBQUksQ0FBQztZQUNuQm1ELElBQUk7WUFDSjRFLFVBQVU7WUFDVkMsVUFBVTtZQUNWMUUsT0FBTztZQUNQQyxhQUFhO1lBQ2IwRSxZQUFZO1FBQ2Q7UUFFQSxPQUFPbEg7SUFDVDtJQUVRRyxxQkFDTnJCLE9BQXlCLEVBQ3pCVSxTQUEwQixFQUNaO1FBQ2QsTUFBTTRILFFBQXdCLEVBQUU7UUFDaEMsSUFBSUMsUUFBUTtRQUVaLHVDQUF1QztRQUN2QyxNQUFNTix1QkFBdUJ2SCxVQUFVK0IsTUFBTSxDQUFDLENBQUNxQyxJQUFNQSxFQUFFb0IsV0FBVztRQUNsRSxJQUFJK0IscUJBQXFCaEQsTUFBTSxHQUFHLEdBQUc7WUFDbkNxRCxNQUFNbkksSUFBSSxDQUFDO2dCQUNUb0ksT0FBT0E7Z0JBQ1A5RSxPQUFPO2dCQUNQQyxhQUFhLENBQUMsT0FBTyxFQUFFdUUscUJBQXFCaEQsTUFBTSxDQUFDLDJCQUEyQixFQUFFZ0QscUJBQXFCaEQsTUFBTSxHQUFHLElBQUksTUFBTSxHQUFHLENBQUMsQ0FBQztnQkFDN0h1RCxRQUFRO29CQUNOakYsTUFBTTtnQkFDUjtnQkFDQTJFLFVBQVU7WUFDWjtRQUNGO1FBRUEsMENBQTBDO1FBQzFDLElBQUlsSSxRQUFRZ0csSUFBSSxDQUFDLENBQUNpQixJQUFNQSxFQUFFbEQsV0FBVyxHQUFHO1lBQ3RDdUUsTUFBTW5JLElBQUksQ0FBQztnQkFDVG9JLE9BQU9BO2dCQUNQOUUsT0FBTztnQkFDUEMsYUFBYTtnQkFDYjhFLFFBQVE7b0JBQ05qRixNQUFNO2dCQUNSO2dCQUNBMkUsVUFBVTtZQUNaO1FBQ0Y7UUFFQSwrQkFBK0I7UUFDL0JJLE1BQU1uSSxJQUFJLENBQUM7WUFDVG9JLE9BQU9BO1lBQ1A5RSxPQUFPO1lBQ1BDLGFBQWE7WUFDYjhFLFFBQVE7Z0JBQ05qRixNQUFNO1lBQ1I7WUFDQTJFLFVBQVU7UUFDWjtRQUVBLE9BQU87WUFDTE8sY0FBY3pJLFFBQVFnRyxJQUFJLENBQUMsQ0FBQ2lCLElBQU1BLEVBQUV6RCxRQUFRLEtBQUssY0FBYyxhQUFhO1lBQzVFa0Ysc0JBQXNCSixNQUFNckQsTUFBTSxHQUFHO1lBQ3JDcUQ7WUFDQUssVUFBVTtnQkFDUjtnQkFDQTtnQkFDQTthQUNEO1lBQ0RDLG9CQUFvQjtRQUN0QjtJQUNGO0lBRVFoSCxnQkFDTm9HLE1BQXNCLEVBQ3RCaEksT0FBeUIsRUFDekJVLFNBQTBCLEVBQ2xCO1FBQ1IsSUFBSXNILFdBQVcsUUFBUTtZQUNyQixPQUFPO1FBQ1Q7UUFFQSxJQUFJQSxXQUFXLFdBQVc7WUFDeEIsT0FBTyxDQUFDLEVBQUVoSSxRQUFRaUYsTUFBTSxDQUFDLDJCQUEyQixFQUFFakYsUUFBUWlGLE1BQU0sS0FBSyxJQUFJLE1BQU0sR0FBRywwREFBMEQsQ0FBQztRQUNuSjtRQUVBLE9BQU8sQ0FBQyx3SEFBd0gsQ0FBQztJQUNuSTtJQUVRbEQsMkJBQTJCL0IsT0FBeUIsRUFBRTtRQUM1RCxPQUFPO1lBQ0w2SSxtQkFBbUI7Z0JBQ2pCQyxjQUFjO2dCQUNkQyxZQUFZO2dCQUNaQyxlQUFlO2dCQUNmQyxpQkFBaUI7WUFDbkI7WUFDQUMsZ0JBQWdCO2dCQUNkO29CQUNFekYsT0FBTztvQkFDUEMsYUFBYTtvQkFDYnlGLFlBQVk7Z0JBQ2Q7Z0JBQ0E7b0JBQ0UxRixPQUFPO29CQUNQQyxhQUFhO29CQUNieUYsWUFBWTtnQkFDZDtnQkFDQTtvQkFDRTFGLE9BQU87b0JBQ1BDLGFBQWE7b0JBQ2J5RixZQUFZO2dCQUNkO2FBQ0Q7WUFDREMsbUJBQW1CO2dCQUNqQjtvQkFBRTlGLElBQUk7b0JBQUs2RSxVQUFVO29CQUFVa0IsTUFBTTtvQkFBZ0RDLFdBQVc7b0JBQU9DLGVBQWU7d0JBQUM7cUJBQVM7Z0JBQUM7Z0JBQ2pJO29CQUFFakcsSUFBSTtvQkFBSzZFLFVBQVU7b0JBQVVrQixNQUFNO29CQUF1Q0MsV0FBVztnQkFBTTtnQkFDN0Y7b0JBQUVoRyxJQUFJO29CQUFLNkUsVUFBVTtvQkFBZ0JrQixNQUFNO29CQUFxQ0MsV0FBVztvQkFBT0MsZUFBZTt3QkFBQztxQkFBUztnQkFBQztnQkFDNUg7b0JBQUVqRyxJQUFJO29CQUFLNkUsVUFBVTtvQkFBVWtCLE1BQU07b0JBQStCQyxXQUFXO29CQUFPQyxlQUFlO3dCQUFDO3FCQUFTO2dCQUFDO2dCQUNoSDtvQkFBRWpHLElBQUk7b0JBQUs2RSxVQUFVO29CQUFZa0IsTUFBTTtvQkFBZ0NDLFdBQVc7Z0JBQU07YUFDekY7UUFDSDtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93YWxsZXQtc2VudGluZWwvLi9zcmMvbGliL2FuYWx5emVycy9zb2xhbmEtYW5hbHl6ZXIudHM/MTBmOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBTT0xBTkEgQ0hBSU4gQU5BTFlaRVJcclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gSGFuZGxlcyBzZWN1cml0eSBhbmFseXNpcyBmb3IgU29sYW5hIGJsb2NrY2hhaW4uXHJcbi8vIEFsbCBvcGVyYXRpb25zIGFyZSBSRUFELU9OTFkuXHJcblxyXG5pbXBvcnQge1xyXG4gIENvbm5lY3Rpb24sXHJcbiAgUHVibGljS2V5LFxyXG4gIFBhcnNlZFRyYW5zYWN0aW9uV2l0aE1ldGEsXHJcbiAgUGFyc2VkSW5zdHJ1Y3Rpb24sXHJcbn0gZnJvbSAnQHNvbGFuYS93ZWIzLmpzJztcclxuaW1wb3J0IHtcclxuICBDaGFpbixcclxuICBEZXRlY3RlZFRocmVhdCxcclxuICBUb2tlbkFwcHJvdmFsLFxyXG4gIFN1c3BpY2lvdXNUcmFuc2FjdGlvbixcclxuICBSaXNrTGV2ZWwsXHJcbiAgV2FsbGV0QW5hbHlzaXNSZXN1bHQsXHJcbiAgU2VjdXJpdHlSZWNvbW1lbmRhdGlvbixcclxuICBSZWNvdmVyeVBsYW4sXHJcbiAgUmVjb3ZlcnlTdGVwLFxyXG4gIFNlY3VyaXR5U3RhdHVzLFxyXG59IGZyb20gJ0AvdHlwZXMnO1xyXG5pbXBvcnQgeyBDSEFJTl9SUENfQ09ORklHLCBTT0xBTkFfTUFMSUNJT1VTX1BST0dSQU1TIH0gZnJvbSAnLi4vZGV0ZWN0aW9uL21hbGljaW91cy1kYXRhYmFzZSc7XHJcblxyXG4vLyBLbm93biBTb2xhbmEgcHJvZ3JhbSBJRHNcclxuY29uc3QgVE9LRU5fUFJPR1JBTV9JRCA9ICdUb2tlbmtlZ1FmZVp5aU53QUpiTmJHS1BGWENXdUJ2ZjlTczYyM1ZRNURBJztcclxuY29uc3QgVE9LRU5fMjAyMl9QUk9HUkFNX0lEID0gJ1Rva2VuelFkQk5iTHFQNVZFaGRrQVM2RVBGTEMxUEhuQnFDWEVwUHh1RWInO1xyXG5jb25zdCBBU1NPQ0lBVEVEX1RPS0VOX1BST0dSQU1fSUQgPSAnQVRva2VuR1B2YmRHVnhyMWIyaHZaYnNpcVc1eFdIMjVlZlROc0xKQThrbkwnO1xyXG5jb25zdCBNRU1PX1BST0dSQU1fSUQgPSAnTWVtb1NxNGdxQUJBWEtiOTZxbkg4VHlzTmNXeE15V0NxWGdETEdtZmNIcic7XHJcblxyXG4vLyBTdXNwaWNpb3VzIHByb2dyYW0gcGF0dGVybnNcclxuY29uc3QgU1VTUElDSU9VU19QUk9HUkFNX1BBVFRFUk5TID0gW1xyXG4gICdkcmFpbicsXHJcbiAgJ2NsYWltJyxcclxuICAnYWlyZHJvcCcsXHJcbiAgJ3Jld2FyZCcsXHJcbl07XHJcblxyXG5leHBvcnQgY2xhc3MgU29sYW5hQW5hbHl6ZXIge1xyXG4gIHByaXZhdGUgY29ubmVjdGlvbjogQ29ubmVjdGlvbjtcclxuICBwcml2YXRlIGV4cGxvcmVyQXBpVXJsOiBzdHJpbmc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgY29uc3QgY29uZmlnID0gQ0hBSU5fUlBDX0NPTkZJRy5zb2xhbmE7XHJcbiAgICAvLyBVc2UgdGhlIGZpcnN0IFJQQyBVUkwgZnJvbSB0aGUgYXJyYXksIHdpdGggZmFsbGJhY2tcclxuICAgIGNvbnN0IHJwY1VybCA9IGNvbmZpZy5ycGNVcmxzPy5bMF0gfHwgJ2h0dHBzOi8vYXBpLm1haW5uZXQtYmV0YS5zb2xhbmEuY29tJztcclxuICAgIHRoaXMuY29ubmVjdGlvbiA9IG5ldyBDb25uZWN0aW9uKHJwY1VybCwgJ2NvbmZpcm1lZCcpO1xyXG4gICAgdGhpcy5leHBsb3JlckFwaVVybCA9IGNvbmZpZy5leHBsb3JlckFwaTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGFuYWx5emVXYWxsZXQoYWRkcmVzczogc3RyaW5nKTogUHJvbWlzZTxXYWxsZXRBbmFseXNpc1Jlc3VsdD4ge1xyXG4gICAgLy8gVmFsaWRhdGUgU29sYW5hIGFkZHJlc3NcclxuICAgIGxldCBwdWJsaWNLZXk6IFB1YmxpY0tleTtcclxuICAgIHRyeSB7XHJcbiAgICAgIHB1YmxpY0tleSA9IG5ldyBQdWJsaWNLZXkoYWRkcmVzcyk7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFNvbGFuYSBhZGRyZXNzJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmV0Y2ggZGF0YSBpbiBwYXJhbGxlbFxyXG4gICAgY29uc3QgW3RyYW5zYWN0aW9ucywgdG9rZW5BY2NvdW50cywgYmFsYW5jZV0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIHRoaXMuZmV0Y2hUcmFuc2FjdGlvbkhpc3RvcnkocHVibGljS2V5KSxcclxuICAgICAgdGhpcy5mZXRjaFRva2VuQWNjb3VudHMocHVibGljS2V5KSxcclxuICAgICAgdGhpcy5jb25uZWN0aW9uLmdldEJhbGFuY2UocHVibGljS2V5KSxcclxuICAgIF0pO1xyXG5cclxuICAgIC8vIEFuYWx5emUgdGhyZWF0c1xyXG4gICAgY29uc3QgdGhyZWF0czogRGV0ZWN0ZWRUaHJlYXRbXSA9IFtdO1xyXG5cclxuICAgIC8vIENoZWNrIGZvciBtYWxpY2lvdXMgcHJvZ3JhbSBpbnRlcmFjdGlvbnNcclxuICAgIGNvbnN0IG1hbGljaW91c1Byb2dyYW1UaHJlYXRzID0gdGhpcy5kZXRlY3RNYWxpY2lvdXNQcm9ncmFtSW50ZXJhY3Rpb25zKHRyYW5zYWN0aW9ucyk7XHJcbiAgICB0aHJlYXRzLnB1c2goLi4ubWFsaWNpb3VzUHJvZ3JhbVRocmVhdHMpO1xyXG5cclxuICAgIC8vIENoZWNrIGZvciBkZWxlZ2F0ZSBhYnVzZVxyXG4gICAgY29uc3QgZGVsZWdhdGVUaHJlYXRzID0gYXdhaXQgdGhpcy5kZXRlY3REZWxlZ2F0ZUFidXNlKHRva2VuQWNjb3VudHMsIHB1YmxpY0tleSk7XHJcbiAgICB0aHJlYXRzLnB1c2goLi4uZGVsZWdhdGVUaHJlYXRzKTtcclxuXHJcbiAgICAvLyBDaGVjayBmb3IgcmFwaWQgb3V0Zmxvd3NcclxuICAgIGNvbnN0IG91dGZsb3dUaHJlYXRzID0gdGhpcy5kZXRlY3RSYXBpZE91dGZsb3dzKHRyYW5zYWN0aW9ucywgYWRkcmVzcyk7XHJcbiAgICB0aHJlYXRzLnB1c2goLi4ub3V0Zmxvd1RocmVhdHMpO1xyXG5cclxuICAgIC8vIENoZWNrIGZvciBzdXNwaWNpb3VzIGFpcmRyb3BzXHJcbiAgICBjb25zdCBhaXJkcm9wVGhyZWF0cyA9IHRoaXMuZGV0ZWN0U3VzcGljaW91c0FpcmRyb3BzKHRyYW5zYWN0aW9ucywgYWRkcmVzcyk7XHJcbiAgICB0aHJlYXRzLnB1c2goLi4uYWlyZHJvcFRocmVhdHMpO1xyXG5cclxuICAgIC8vIEFuYWx5emUgdG9rZW4gYWNjb3VudCBkZWxlZ2F0aW9ucyAoc2ltaWxhciB0byBFVk0gYXBwcm92YWxzKVxyXG4gICAgY29uc3QgYXBwcm92YWxzID0gYXdhaXQgdGhpcy5hbmFseXplVG9rZW5EZWxlZ2F0aW9ucyh0b2tlbkFjY291bnRzLCBwdWJsaWNLZXkpO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSByaXNrIHNjb3JlXHJcbiAgICBjb25zdCByaXNrU2NvcmUgPSB0aGlzLmNhbGN1bGF0ZVJpc2tTY29yZSh0aHJlYXRzLCBhcHByb3ZhbHMpO1xyXG4gICAgY29uc3Qgc2VjdXJpdHlTdGF0dXMgPSB0aGlzLmRldGVybWluZVNlY3VyaXR5U3RhdHVzKHJpc2tTY29yZSwgdGhyZWF0cyk7XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgc3VzcGljaW91cyB0cmFuc2FjdGlvbnMgbGlzdFxyXG4gICAgY29uc3Qgc3VzcGljaW91c1RyYW5zYWN0aW9ucyA9IHRoaXMuaWRlbnRpZnlTdXNwaWNpb3VzVHJhbnNhY3Rpb25zKHRyYW5zYWN0aW9ucywgdGhyZWF0cyk7XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgcmVjb21tZW5kYXRpb25zXHJcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSB0aGlzLmdlbmVyYXRlUmVjb21tZW5kYXRpb25zKHRocmVhdHMsIGFwcHJvdmFscywgc2VjdXJpdHlTdGF0dXMpO1xyXG5cclxuICAgIC8vIEdlbmVyYXRlIHJlY292ZXJ5IHBsYW5cclxuICAgIGNvbnN0IHJlY292ZXJ5UGxhbiA9IHNlY3VyaXR5U3RhdHVzICE9PSAnU0FGRSdcclxuICAgICAgPyB0aGlzLmdlbmVyYXRlUmVjb3ZlcnlQbGFuKHRocmVhdHMsIGFwcHJvdmFscylcclxuICAgICAgOiB1bmRlZmluZWQ7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYWRkcmVzcyxcclxuICAgICAgY2hhaW46ICdzb2xhbmEnLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgc2VjdXJpdHlTdGF0dXMsXHJcbiAgICAgIHJpc2tTY29yZSxcclxuICAgICAgc3VtbWFyeTogdGhpcy5nZW5lcmF0ZVN1bW1hcnkoc2VjdXJpdHlTdGF0dXMsIHRocmVhdHMsIGFwcHJvdmFscyksXHJcbiAgICAgIGRldGVjdGVkVGhyZWF0czogdGhyZWF0cyxcclxuICAgICAgYXBwcm92YWxzLFxyXG4gICAgICBzdXNwaWNpb3VzVHJhbnNhY3Rpb25zLFxyXG4gICAgICByZWNvbW1lbmRhdGlvbnMsXHJcbiAgICAgIHJlY292ZXJ5UGxhbixcclxuICAgICAgZWR1Y2F0aW9uYWxDb250ZW50OiB0aGlzLmdlbmVyYXRlRWR1Y2F0aW9uYWxDb250ZW50KHRocmVhdHMpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgZmV0Y2hUcmFuc2FjdGlvbkhpc3RvcnkocHVibGljS2V5OiBQdWJsaWNLZXkpOiBQcm9taXNlPFBhcnNlZFRyYW5zYWN0aW9uV2l0aE1ldGFbXT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3Qgc2lnbmF0dXJlcyA9IGF3YWl0IHRoaXMuY29ubmVjdGlvbi5nZXRTaWduYXR1cmVzRm9yQWRkcmVzcyhwdWJsaWNLZXksIHsgbGltaXQ6IDEwMCB9KTtcclxuXHJcbiAgICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgIHNpZ25hdHVyZXMuc2xpY2UoMCwgNTApLm1hcChhc3luYyAoc2lnKSA9PiB7XHJcbiAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jb25uZWN0aW9uLmdldFBhcnNlZFRyYW5zYWN0aW9uKHNpZy5zaWduYXR1cmUsIHtcclxuICAgICAgICAgICAgICBtYXhTdXBwb3J0ZWRUcmFuc2FjdGlvblZlcnNpb246IDAsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICk7XHJcblxyXG4gICAgICByZXR1cm4gdHJhbnNhY3Rpb25zLmZpbHRlcigodHgpOiB0eCBpcyBQYXJzZWRUcmFuc2FjdGlvbldpdGhNZXRhID0+IHR4ICE9PSBudWxsKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIFNvbGFuYSB0cmFuc2FjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGZldGNoVG9rZW5BY2NvdW50cyhwdWJsaWNLZXk6IFB1YmxpY0tleSk6IFByb21pc2U8YW55W10+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHRva2VuQWNjb3VudHMgPSBhd2FpdCB0aGlzLmNvbm5lY3Rpb24uZ2V0UGFyc2VkVG9rZW5BY2NvdW50c0J5T3duZXIocHVibGljS2V5LCB7XHJcbiAgICAgICAgcHJvZ3JhbUlkOiBuZXcgUHVibGljS2V5KFRPS0VOX1BST0dSQU1fSUQpLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB0b2tlbkFjY291bnRzLnZhbHVlO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdG9rZW4gYWNjb3VudHM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGRldGVjdE1hbGljaW91c1Byb2dyYW1JbnRlcmFjdGlvbnModHJhbnNhY3Rpb25zOiBQYXJzZWRUcmFuc2FjdGlvbldpdGhNZXRhW10pOiBEZXRlY3RlZFRocmVhdFtdIHtcclxuICAgIGNvbnN0IHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10gPSBbXTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IHR4IG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICBpZiAoIXR4LnRyYW5zYWN0aW9uPy5tZXNzYWdlPy5pbnN0cnVjdGlvbnMpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgZm9yIChjb25zdCBpbnN0cnVjdGlvbiBvZiB0eC50cmFuc2FjdGlvbi5tZXNzYWdlLmluc3RydWN0aW9ucykge1xyXG4gICAgICAgIGNvbnN0IHByb2dyYW1JZCA9IGluc3RydWN0aW9uLnByb2dyYW1JZC50b1N0cmluZygpO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBhZ2FpbnN0IGtub3duIG1hbGljaW91cyBwcm9ncmFtc1xyXG4gICAgICAgIGlmIChTT0xBTkFfTUFMSUNJT1VTX1BST0dSQU1TLmluY2x1ZGVzKHByb2dyYW1JZCkpIHtcclxuICAgICAgICAgIHRocmVhdHMucHVzaCh7XHJcbiAgICAgICAgICAgIGlkOiBgbWFsaWNpb3VzLXByb2dyYW0tJHt0eC50cmFuc2FjdGlvbi5zaWduYXR1cmVzWzBdfWAsXHJcbiAgICAgICAgICAgIHR5cGU6ICdDT01QUk9NSVNFRF9QUk9HUkFNX0FVVEhPUklUWScsXHJcbiAgICAgICAgICAgIHNldmVyaXR5OiAnQ1JJVElDQUwnLFxyXG4gICAgICAgICAgICB0aXRsZTogJ0ludGVyYWN0aW9uIHdpdGggS25vd24gTWFsaWNpb3VzIFByb2dyYW0nLFxyXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogYFRyYW5zYWN0aW9uIGludGVyYWN0ZWQgd2l0aCBhIGtub3duIG1hbGljaW91cyBTb2xhbmEgcHJvZ3JhbS5gLFxyXG4gICAgICAgICAgICB0ZWNobmljYWxEZXRhaWxzOiBgUHJvZ3JhbTogJHtwcm9ncmFtSWR9LCBTaWduYXR1cmU6ICR7dHgudHJhbnNhY3Rpb24uc2lnbmF0dXJlc1swXX1gLFxyXG4gICAgICAgICAgICBkZXRlY3RlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgIHJlbGF0ZWRBZGRyZXNzZXM6IFtwcm9ncmFtSWRdLFxyXG4gICAgICAgICAgICByZWxhdGVkVHJhbnNhY3Rpb25zOiBbdHgudHJhbnNhY3Rpb24uc2lnbmF0dXJlc1swXV0sXHJcbiAgICAgICAgICAgIG9uZ29pbmdSaXNrOiB0cnVlLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRocmVhdHM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGFzeW5jIGRldGVjdERlbGVnYXRlQWJ1c2UodG9rZW5BY2NvdW50czogYW55W10sIG93bmVyOiBQdWJsaWNLZXkpOiBQcm9taXNlPERldGVjdGVkVGhyZWF0W10+IHtcclxuICAgIGNvbnN0IHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10gPSBbXTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGFjY291bnQgb2YgdG9rZW5BY2NvdW50cykge1xyXG4gICAgICBjb25zdCBpbmZvID0gYWNjb3VudC5hY2NvdW50LmRhdGEucGFyc2VkPy5pbmZvO1xyXG4gICAgICBpZiAoIWluZm8pIGNvbnRpbnVlO1xyXG5cclxuICAgICAgLy8gQ2hlY2sgaWYgdG9rZW4gYWNjb3VudCBoYXMgYSBkZWxlZ2F0ZVxyXG4gICAgICBpZiAoaW5mby5kZWxlZ2F0ZSAmJiBpbmZvLmRlbGVnYXRlZEFtb3VudCkge1xyXG4gICAgICAgIGNvbnN0IGRlbGVnYXRlZEFtb3VudCA9IEJpZ0ludChpbmZvLmRlbGVnYXRlZEFtb3VudC5hbW91bnQgfHwgMCk7XHJcblxyXG4gICAgICAgIGlmIChkZWxlZ2F0ZWRBbW91bnQgPiBCaWdJbnQoMCkpIHtcclxuICAgICAgICAgIC8vIENoZWNrIGlmIGRlbGVnYXRlIGlzIG1hbGljaW91c1xyXG4gICAgICAgICAgaWYgKFNPTEFOQV9NQUxJQ0lPVVNfUFJPR1JBTVMuaW5jbHVkZXMoaW5mby5kZWxlZ2F0ZSkpIHtcclxuICAgICAgICAgICAgdGhyZWF0cy5wdXNoKHtcclxuICAgICAgICAgICAgICBpZDogYGRlbGVnYXRlLWFidXNlLSR7YWNjb3VudC5wdWJrZXkudG9TdHJpbmcoKX1gLFxyXG4gICAgICAgICAgICAgIHR5cGU6ICdBUFBST1ZBTF9ISUpBQ0snLFxyXG4gICAgICAgICAgICAgIHNldmVyaXR5OiAnQ1JJVElDQUwnLFxyXG4gICAgICAgICAgICAgIHRpdGxlOiAnVG9rZW4gRGVsZWdhdGVkIHRvIE1hbGljaW91cyBBY2NvdW50JyxcclxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0EgdG9rZW4gYWNjb3VudCBoYXMgYmVlbiBkZWxlZ2F0ZWQgdG8gYSBrbm93biBtYWxpY2lvdXMgYWRkcmVzcy4nLFxyXG4gICAgICAgICAgICAgIHRlY2huaWNhbERldGFpbHM6IGBUb2tlbiBBY2NvdW50OiAke2FjY291bnQucHVia2V5LnRvU3RyaW5nKCl9LCBEZWxlZ2F0ZTogJHtpbmZvLmRlbGVnYXRlfWAsXHJcbiAgICAgICAgICAgICAgZGV0ZWN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgICAgIHJlbGF0ZWRBZGRyZXNzZXM6IFtpbmZvLmRlbGVnYXRlXSxcclxuICAgICAgICAgICAgICByZWxhdGVkVHJhbnNhY3Rpb25zOiBbXSxcclxuICAgICAgICAgICAgICBvbmdvaW5nUmlzazogdHJ1ZSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRocmVhdHM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGRldGVjdFJhcGlkT3V0Zmxvd3ModHJhbnNhY3Rpb25zOiBQYXJzZWRUcmFuc2FjdGlvbldpdGhNZXRhW10sIGFkZHJlc3M6IHN0cmluZyk6IERldGVjdGVkVGhyZWF0W10ge1xyXG4gICAgY29uc3QgdGhyZWF0czogRGV0ZWN0ZWRUaHJlYXRbXSA9IFtdO1xyXG5cclxuICAgIC8vIEdyb3VwIHRyYW5zYWN0aW9ucyBieSB0aW1lIHdpbmRvd1xyXG4gICAgY29uc3Qgd2luZG93TWludXRlcyA9IDEwO1xyXG4gICAgY29uc3Qgc29ydGVkVHhzID0gWy4uLnRyYW5zYWN0aW9uc11cclxuICAgICAgLmZpbHRlcigodHgpID0+IHR4LmJsb2NrVGltZSlcclxuICAgICAgLnNvcnQoKGEsIGIpID0+IChhLmJsb2NrVGltZSB8fCAwKSAtIChiLmJsb2NrVGltZSB8fCAwKSk7XHJcblxyXG4gICAgLy8gTG9vayBmb3IgbXVsdGlwbGUgb3V0Ym91bmQgdHJhbnNmZXJzIGluIHNob3J0IHdpbmRvd1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzb3J0ZWRUeHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3Qgd2luZG93U3RhcnQgPSBzb3J0ZWRUeHNbaV0uYmxvY2tUaW1lIHx8IDA7XHJcbiAgICAgIGNvbnN0IHdpbmRvd0VuZCA9IHdpbmRvd1N0YXJ0ICsgd2luZG93TWludXRlcyAqIDYwO1xyXG5cclxuICAgICAgY29uc3QgdHhzSW5XaW5kb3cgPSBzb3J0ZWRUeHMuZmlsdGVyKFxyXG4gICAgICAgICh0eCkgPT4gKHR4LmJsb2NrVGltZSB8fCAwKSA+PSB3aW5kb3dTdGFydCAmJiAodHguYmxvY2tUaW1lIHx8IDApIDw9IHdpbmRvd0VuZFxyXG4gICAgICApO1xyXG5cclxuICAgICAgLy8gQ291bnQgb3V0Ym91bmQgdHJhbnNmZXJzXHJcbiAgICAgIGxldCBvdXRib3VuZENvdW50ID0gMDtcclxuICAgICAgZm9yIChjb25zdCB0eCBvZiB0eHNJbldpbmRvdykge1xyXG4gICAgICAgIGNvbnN0IHByZUJhbGFuY2VzID0gdHgubWV0YT8ucHJlQmFsYW5jZXMgfHwgW107XHJcbiAgICAgICAgY29uc3QgcG9zdEJhbGFuY2VzID0gdHgubWV0YT8ucG9zdEJhbGFuY2VzIHx8IFtdO1xyXG5cclxuICAgICAgICAvLyBGaXJzdCBhY2NvdW50IGlzIHVzdWFsbHkgdGhlIGZlZSBwYXllci9zaWduZXJcclxuICAgICAgICBpZiAocHJlQmFsYW5jZXNbMF0gPiBwb3N0QmFsYW5jZXNbMF0pIHtcclxuICAgICAgICAgIG91dGJvdW5kQ291bnQrKztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChvdXRib3VuZENvdW50ID49IDUpIHtcclxuICAgICAgICB0aHJlYXRzLnB1c2goe1xyXG4gICAgICAgICAgaWQ6IGByYXBpZC1vdXRmbG93LSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgICAgICAgdHlwZTogJ1dBTExFVF9EUkFJTkVSJyxcclxuICAgICAgICAgIHNldmVyaXR5OiAnQ1JJVElDQUwnLFxyXG4gICAgICAgICAgdGl0bGU6ICdSYXBpZCBBc3NldCBPdXRmbG93IERldGVjdGVkJyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgJHtvdXRib3VuZENvdW50fSBvdXRib3VuZCB0cmFuc2FjdGlvbnMgZGV0ZWN0ZWQgd2l0aGluICR7d2luZG93TWludXRlc30gbWludXRlcy4gVGhpcyBwYXR0ZXJuIGlzIGNvbnNpc3RlbnQgd2l0aCB3YWxsZXQgZHJhaW5lciBhY3Rpdml0eS5gLFxyXG4gICAgICAgICAgdGVjaG5pY2FsRGV0YWlsczogYFRpbWUgd2luZG93OiAke25ldyBEYXRlKHdpbmRvd1N0YXJ0ICogMTAwMCkudG9JU09TdHJpbmcoKX1gLFxyXG4gICAgICAgICAgZGV0ZWN0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgcmVsYXRlZEFkZHJlc3NlczogW10sXHJcbiAgICAgICAgICByZWxhdGVkVHJhbnNhY3Rpb25zOiB0eHNJbldpbmRvdy5tYXAoKHR4KSA9PiB0eC50cmFuc2FjdGlvbi5zaWduYXR1cmVzWzBdKSxcclxuICAgICAgICAgIG9uZ29pbmdSaXNrOiB0cnVlLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGJyZWFrOyAvLyBPbmx5IHJlcG9ydCBvbmNlXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhyZWF0cztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGV0ZWN0U3VzcGljaW91c0FpcmRyb3BzKHRyYW5zYWN0aW9uczogUGFyc2VkVHJhbnNhY3Rpb25XaXRoTWV0YVtdLCBhZGRyZXNzOiBzdHJpbmcpOiBEZXRlY3RlZFRocmVhdFtdIHtcclxuICAgIGNvbnN0IHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10gPSBbXTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IHR4IG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICBpZiAoIXR4LnRyYW5zYWN0aW9uPy5tZXNzYWdlPy5pbnN0cnVjdGlvbnMpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgLy8gQ2hlY2sgZm9yIHVuc29saWNpdGVkIHRva2VuIHRyYW5zZmVycyB0byB0aGlzIHdhbGxldFxyXG4gICAgICBmb3IgKGNvbnN0IGluc3RydWN0aW9uIG9mIHR4LnRyYW5zYWN0aW9uLm1lc3NhZ2UuaW5zdHJ1Y3Rpb25zKSB7XHJcbiAgICAgICAgaWYgKCdwYXJzZWQnIGluIGluc3RydWN0aW9uICYmIGluc3RydWN0aW9uLnBhcnNlZD8udHlwZSA9PT0gJ3RyYW5zZmVyJykge1xyXG4gICAgICAgICAgY29uc3QgaW5mbyA9IGluc3RydWN0aW9uLnBhcnNlZC5pbmZvO1xyXG5cclxuICAgICAgICAgIC8vIElmIHJlY2VpdmluZyB0b2tlbnMgZnJvbSB1bmtub3duIHNvdXJjZSB3aXRoIG1lbW9cclxuICAgICAgICAgIGlmIChpbmZvLmRlc3RpbmF0aW9uID09PSBhZGRyZXNzKSB7XHJcbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBzdXNwaWNpb3VzIG1lbW9cclxuICAgICAgICAgICAgY29uc3QgbWVtb0luc3RydWN0aW9uID0gdHgudHJhbnNhY3Rpb24ubWVzc2FnZS5pbnN0cnVjdGlvbnMuZmluZChcclxuICAgICAgICAgICAgICAoaSkgPT4gaS5wcm9ncmFtSWQudG9TdHJpbmcoKSA9PT0gTUVNT19QUk9HUkFNX0lEXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpZiAobWVtb0luc3RydWN0aW9uICYmICdwYXJzZWQnIGluIG1lbW9JbnN0cnVjdGlvbikge1xyXG4gICAgICAgICAgICAgIGNvbnN0IG1lbW9UZXh0ID0gU3RyaW5nKG1lbW9JbnN0cnVjdGlvbi5wYXJzZWQgfHwgJycpLnRvTG93ZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChTVVNQSUNJT1VTX1BST0dSQU1fUEFUVEVSTlMuc29tZSgocGF0dGVybikgPT4gbWVtb1RleHQuaW5jbHVkZXMocGF0dGVybikpKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJlYXRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICBpZDogYHN1c3BpY2lvdXMtYWlyZHJvcC0ke3R4LnRyYW5zYWN0aW9uLnNpZ25hdHVyZXNbMF19YCxcclxuICAgICAgICAgICAgICAgICAgdHlwZTogJ01BTElDSU9VU19ORlRfQUlSRFJPUCcsXHJcbiAgICAgICAgICAgICAgICAgIHNldmVyaXR5OiAnTUVESVVNJyxcclxuICAgICAgICAgICAgICAgICAgdGl0bGU6ICdTdXNwaWNpb3VzIEFpcmRyb3AgRGV0ZWN0ZWQnLFxyXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1JlY2VpdmVkIHRva2VucyB3aXRoIHN1c3BpY2lvdXMgbWVtby4gVGhpcyBtYXkgYmUgYSBwaGlzaGluZyBhdHRlbXB0LicsXHJcbiAgICAgICAgICAgICAgICAgIHRlY2huaWNhbERldGFpbHM6IGBTaWduYXR1cmU6ICR7dHgudHJhbnNhY3Rpb24uc2lnbmF0dXJlc1swXX1gLFxyXG4gICAgICAgICAgICAgICAgICBkZXRlY3RlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgICAgICAgIHJlbGF0ZWRBZGRyZXNzZXM6IFtdLFxyXG4gICAgICAgICAgICAgICAgICByZWxhdGVkVHJhbnNhY3Rpb25zOiBbdHgudHJhbnNhY3Rpb24uc2lnbmF0dXJlc1swXV0sXHJcbiAgICAgICAgICAgICAgICAgIG9uZ29pbmdSaXNrOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aHJlYXRzO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplVG9rZW5EZWxlZ2F0aW9ucyh0b2tlbkFjY291bnRzOiBhbnlbXSwgb3duZXI6IFB1YmxpY0tleSk6IFByb21pc2U8VG9rZW5BcHByb3ZhbFtdPiB7XHJcbiAgICBjb25zdCBhcHByb3ZhbHM6IFRva2VuQXBwcm92YWxbXSA9IFtdO1xyXG5cclxuICAgIGZvciAoY29uc3QgYWNjb3VudCBvZiB0b2tlbkFjY291bnRzKSB7XHJcbiAgICAgIGNvbnN0IGluZm8gPSBhY2NvdW50LmFjY291bnQuZGF0YS5wYXJzZWQ/LmluZm87XHJcbiAgICAgIGlmICghaW5mbyB8fCAhaW5mby5kZWxlZ2F0ZSkgY29udGludWU7XHJcblxyXG4gICAgICBjb25zdCBkZWxlZ2F0ZWRBbW91bnQgPSBCaWdJbnQoaW5mby5kZWxlZ2F0ZWRBbW91bnQ/LmFtb3VudCB8fCAwKTtcclxuICAgICAgaWYgKGRlbGVnYXRlZEFtb3VudCA9PT0gQmlnSW50KDApKSBjb250aW51ZTtcclxuXHJcbiAgICAgIGNvbnN0IGlzTWFsaWNpb3VzID0gU09MQU5BX01BTElDSU9VU19QUk9HUkFNUy5pbmNsdWRlcyhpbmZvLmRlbGVnYXRlKTtcclxuXHJcbiAgICAgIGFwcHJvdmFscy5wdXNoKHtcclxuICAgICAgICBpZDogYGRlbGVnYXRpb24tJHthY2NvdW50LnB1YmtleS50b1N0cmluZygpfWAsXHJcbiAgICAgICAgdG9rZW46IHtcclxuICAgICAgICAgIGFkZHJlc3M6IGluZm8ubWludCxcclxuICAgICAgICAgIHN5bWJvbDogJ1NQTCcsXHJcbiAgICAgICAgICBuYW1lOiAnU1BMIFRva2VuJyxcclxuICAgICAgICAgIGRlY2ltYWxzOiBpbmZvLnRva2VuQW1vdW50Py5kZWNpbWFscyB8fCA5LFxyXG4gICAgICAgICAgc3RhbmRhcmQ6ICdTUEwnLFxyXG4gICAgICAgICAgdmVyaWZpZWQ6IGZhbHNlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3BlbmRlcjogaW5mby5kZWxlZ2F0ZSxcclxuICAgICAgICBhbW91bnQ6IGRlbGVnYXRlZEFtb3VudC50b1N0cmluZygpLFxyXG4gICAgICAgIGlzVW5saW1pdGVkOiBmYWxzZSwgLy8gU29sYW5hIGRlbGVnYXRpb25zIGhhdmUgc3BlY2lmaWMgYW1vdW50c1xyXG4gICAgICAgIHJpc2tMZXZlbDogaXNNYWxpY2lvdXMgPyAnQ1JJVElDQUwnIDogJ01FRElVTScsXHJcbiAgICAgICAgcmlza1JlYXNvbjogaXNNYWxpY2lvdXNcclxuICAgICAgICAgID8gJ0RlbGVnYXRlZCB0byBrbm93biBtYWxpY2lvdXMgYWRkcmVzcydcclxuICAgICAgICAgIDogJ0FjdGl2ZSB0b2tlbiBkZWxlZ2F0aW9uJyxcclxuICAgICAgICBncmFudGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgICBpc01hbGljaW91cyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGFwcHJvdmFscztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlUmlza1Njb3JlKHRocmVhdHM6IERldGVjdGVkVGhyZWF0W10sIGFwcHJvdmFsczogVG9rZW5BcHByb3ZhbFtdKTogbnVtYmVyIHtcclxuICAgIGxldCBzY29yZSA9IDA7XHJcblxyXG4gICAgLy8gQ3JpdGljYWwgdGhyZWF0c1xyXG4gICAgc2NvcmUgKz0gdGhyZWF0cy5maWx0ZXIoKHQpID0+IHQuc2V2ZXJpdHkgPT09ICdDUklUSUNBTCcpLmxlbmd0aCAqIDMwO1xyXG4gICAgLy8gSGlnaCB0aHJlYXRzXHJcbiAgICBzY29yZSArPSB0aHJlYXRzLmZpbHRlcigodCkgPT4gdC5zZXZlcml0eSA9PT0gJ0hJR0gnKS5sZW5ndGggKiAyMDtcclxuICAgIC8vIE1lZGl1bSB0aHJlYXRzXHJcbiAgICBzY29yZSArPSB0aHJlYXRzLmZpbHRlcigodCkgPT4gdC5zZXZlcml0eSA9PT0gJ01FRElVTScpLmxlbmd0aCAqIDEwO1xyXG4gICAgLy8gTWFsaWNpb3VzIGFwcHJvdmFsc1xyXG4gICAgc2NvcmUgKz0gYXBwcm92YWxzLmZpbHRlcigoYSkgPT4gYS5pc01hbGljaW91cykubGVuZ3RoICogMjU7XHJcbiAgICAvLyBBbnkgYWN0aXZlIGRlbGVnYXRpb25zXHJcbiAgICBzY29yZSArPSBhcHByb3ZhbHMubGVuZ3RoICogNTtcclxuXHJcbiAgICByZXR1cm4gTWF0aC5taW4oMTAwLCBNYXRoLm1heCgwLCBzY29yZSkpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBkZXRlcm1pbmVTZWN1cml0eVN0YXR1cyhyaXNrU2NvcmU6IG51bWJlciwgdGhyZWF0czogRGV0ZWN0ZWRUaHJlYXRbXSk6IFNlY3VyaXR5U3RhdHVzIHtcclxuICAgIGNvbnN0IGhhc0NyaXRpY2FsID0gdGhyZWF0cy5zb21lKCh0KSA9PiB0LnNldmVyaXR5ID09PSAnQ1JJVElDQUwnICYmIHQub25nb2luZ1Jpc2spO1xyXG5cclxuICAgIGlmIChoYXNDcml0aWNhbCB8fCByaXNrU2NvcmUgPj0gNzApIHJldHVybiAnQ09NUFJPTUlTRUQnO1xyXG4gICAgaWYgKHJpc2tTY29yZSA+PSAzMCB8fCB0aHJlYXRzLmxlbmd0aCA+IDApIHJldHVybiAnQVRfUklTSyc7XHJcbiAgICByZXR1cm4gJ1NBRkUnO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpZGVudGlmeVN1c3BpY2lvdXNUcmFuc2FjdGlvbnMoXHJcbiAgICB0cmFuc2FjdGlvbnM6IFBhcnNlZFRyYW5zYWN0aW9uV2l0aE1ldGFbXSxcclxuICAgIHRocmVhdHM6IERldGVjdGVkVGhyZWF0W11cclxuICApOiBTdXNwaWNpb3VzVHJhbnNhY3Rpb25bXSB7XHJcbiAgICBjb25zdCBzdXNwaWNpb3VzU2lncyA9IG5ldyBTZXQodGhyZWF0cy5mbGF0TWFwKCh0KSA9PiB0LnJlbGF0ZWRUcmFuc2FjdGlvbnMpKTtcclxuXHJcbiAgICByZXR1cm4gdHJhbnNhY3Rpb25zXHJcbiAgICAgIC5maWx0ZXIoKHR4KSA9PiBzdXNwaWNpb3VzU2lncy5oYXModHgudHJhbnNhY3Rpb24uc2lnbmF0dXJlc1swXSkpXHJcbiAgICAgIC5tYXAoKHR4KSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVsYXRlZFRocmVhdCA9IHRocmVhdHMuZmluZCgodCkgPT5cclxuICAgICAgICAgIHQucmVsYXRlZFRyYW5zYWN0aW9ucy5pbmNsdWRlcyh0eC50cmFuc2FjdGlvbi5zaWduYXR1cmVzWzBdKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBoYXNoOiB0eC50cmFuc2FjdGlvbi5zaWduYXR1cmVzWzBdLFxyXG4gICAgICAgICAgdGltZXN0YW1wOiB0eC5ibG9ja1RpbWVcclxuICAgICAgICAgICAgPyBuZXcgRGF0ZSh0eC5ibG9ja1RpbWUgKiAxMDAwKS50b0lTT1N0cmluZygpXHJcbiAgICAgICAgICAgIDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgICAgdHlwZTogcmVsYXRlZFRocmVhdD8udHlwZSB8fCAnVU5LTk9XTicsXHJcbiAgICAgICAgICBmcm9tOiB0eC50cmFuc2FjdGlvbi5tZXNzYWdlLmFjY291bnRLZXlzWzBdPy5wdWJrZXkudG9TdHJpbmcoKSB8fCAnJyxcclxuICAgICAgICAgIHRvOiB0eC50cmFuc2FjdGlvbi5tZXNzYWdlLmFjY291bnRLZXlzWzFdPy5wdWJrZXkudG9TdHJpbmcoKSB8fCAnJyxcclxuICAgICAgICAgIHJpc2tMZXZlbDogcmVsYXRlZFRocmVhdD8uc2V2ZXJpdHkgfHwgJ01FRElVTScsXHJcbiAgICAgICAgICBmbGFnczogcmVsYXRlZFRocmVhdCA/IFtyZWxhdGVkVGhyZWF0LnRpdGxlXSA6IFtdLFxyXG4gICAgICAgICAgZGVzY3JpcHRpb246IHJlbGF0ZWRUaHJlYXQ/LmRlc2NyaXB0aW9uIHx8ICdTdXNwaWNpb3VzIGFjdGl2aXR5IGRldGVjdGVkJyxcclxuICAgICAgICB9O1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoXHJcbiAgICB0aHJlYXRzOiBEZXRlY3RlZFRocmVhdFtdLFxyXG4gICAgYXBwcm92YWxzOiBUb2tlbkFwcHJvdmFsW10sXHJcbiAgICBzdGF0dXM6IFNlY3VyaXR5U3RhdHVzXHJcbiAgKTogU2VjdXJpdHlSZWNvbW1lbmRhdGlvbltdIHtcclxuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogU2VjdXJpdHlSZWNvbW1lbmRhdGlvbltdID0gW107XHJcblxyXG4gICAgLy8gTWFsaWNpb3VzIGRlbGVnYXRpb25zXHJcbiAgICBjb25zdCBtYWxpY2lvdXNEZWxlZ2F0aW9ucyA9IGFwcHJvdmFscy5maWx0ZXIoKGEpID0+IGEuaXNNYWxpY2lvdXMpO1xyXG4gICAgaWYgKG1hbGljaW91c0RlbGVnYXRpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goe1xyXG4gICAgICAgIGlkOiAncmV2b2tlLWRlbGVnYXRpb25zJyxcclxuICAgICAgICBwcmlvcml0eTogJ0NSSVRJQ0FMJyxcclxuICAgICAgICBjYXRlZ29yeTogJ0lNTUVESUFURScsXHJcbiAgICAgICAgdGl0bGU6ICdSZXZva2UgTWFsaWNpb3VzIFRva2VuIERlbGVnYXRpb25zJyxcclxuICAgICAgICBkZXNjcmlwdGlvbjogYFlvdSBoYXZlICR7bWFsaWNpb3VzRGVsZWdhdGlvbnMubGVuZ3RofSB0b2tlbiBhY2NvdW50JHttYWxpY2lvdXNEZWxlZ2F0aW9ucy5sZW5ndGggPiAxID8gJ3MnIDogJyd9IGRlbGVnYXRlZCB0byBtYWxpY2lvdXMgYWRkcmVzc2VzLmAsXHJcbiAgICAgICAgYWN0aW9uYWJsZTogdHJ1ZSxcclxuICAgICAgICBhY3Rpb25UeXBlOiAnREVMRUdBVEVfUkVWT0tFJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQWN0aXZlIGRyYWluZXJcclxuICAgIGlmICh0aHJlYXRzLnNvbWUoKHQpID0+IHQudHlwZSA9PT0gJ1dBTExFVF9EUkFJTkVSJyAmJiB0Lm9uZ29pbmdSaXNrKSkge1xyXG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCh7XHJcbiAgICAgICAgaWQ6ICdtb3ZlLWFzc2V0cycsXHJcbiAgICAgICAgcHJpb3JpdHk6ICdDUklUSUNBTCcsXHJcbiAgICAgICAgY2F0ZWdvcnk6ICdJTU1FRElBVEUnLFxyXG4gICAgICAgIHRpdGxlOiAnVHJhbnNmZXIgQXNzZXRzIHRvIEZyZXNoIFdhbGxldCcsXHJcbiAgICAgICAgZGVzY3JpcHRpb246ICdDcmVhdGUgYSBuZXcgU29sYW5hIHdhbGxldCBhbmQgdHJhbnNmZXIgYWxsIHJlbWFpbmluZyBhc3NldHMgaW1tZWRpYXRlbHkuJyxcclxuICAgICAgICBhY3Rpb25hYmxlOiB0cnVlLFxyXG4gICAgICAgIGFjdGlvblR5cGU6ICdUUkFOU0ZFUl9BU1NFVFMnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDbG9zZSBlbXB0eSB0b2tlbiBhY2NvdW50cyAoY2xlYW51cClcclxuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcclxuICAgICAgaWQ6ICdjbG9zZS10b2tlbi1hY2NvdW50cycsXHJcbiAgICAgIHByaW9yaXR5OiAnTE9XJyxcclxuICAgICAgY2F0ZWdvcnk6ICdMT05HX1RFUk0nLFxyXG4gICAgICB0aXRsZTogJ0Nsb3NlIFVudXNlZCBUb2tlbiBBY2NvdW50cycsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiAnQ2xvc2UgZW1wdHkgdG9rZW4gYWNjb3VudHMgdG8gcmVjbGFpbSByZW50IFNPTC4gVGhpcyBhbHNvIHJlbW92ZXMgcG90ZW50aWFsIGF0dGFjayBzdXJmYWNlLicsXHJcbiAgICAgIGFjdGlvbmFibGU6IHRydWUsXHJcbiAgICAgIGFjdGlvblR5cGU6ICdDTE9TRV9BQ0NPVU5UJyxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEdlbmVyYWwgc2VjdXJpdHlcclxuICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKHtcclxuICAgICAgaWQ6ICd1c2UtaGFyZHdhcmUtd2FsbGV0JyxcclxuICAgICAgcHJpb3JpdHk6ICdNRURJVU0nLFxyXG4gICAgICBjYXRlZ29yeTogJ1NIT1JUX1RFUk0nLFxyXG4gICAgICB0aXRsZTogJ1VzZSBIYXJkd2FyZSBXYWxsZXQnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJ0NvbnNpZGVyIHVzaW5nIGEgTGVkZ2VyIG9yIG90aGVyIGhhcmR3YXJlIHdhbGxldCBmb3IgYmV0dGVyIGtleSBzZWN1cml0eS4nLFxyXG4gICAgICBhY3Rpb25hYmxlOiBmYWxzZSxcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByZWNvbW1lbmRhdGlvbnM7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdlbmVyYXRlUmVjb3ZlcnlQbGFuKFxyXG4gICAgdGhyZWF0czogRGV0ZWN0ZWRUaHJlYXRbXSxcclxuICAgIGFwcHJvdmFsczogVG9rZW5BcHByb3ZhbFtdXHJcbiAgKTogUmVjb3ZlcnlQbGFuIHtcclxuICAgIGNvbnN0IHN0ZXBzOiBSZWNvdmVyeVN0ZXBbXSA9IFtdO1xyXG4gICAgbGV0IG9yZGVyID0gMTtcclxuXHJcbiAgICAvLyBTdGVwIDE6IFJldm9rZSBtYWxpY2lvdXMgZGVsZWdhdGlvbnNcclxuICAgIGNvbnN0IG1hbGljaW91c0RlbGVnYXRpb25zID0gYXBwcm92YWxzLmZpbHRlcigoYSkgPT4gYS5pc01hbGljaW91cyk7XHJcbiAgICBpZiAobWFsaWNpb3VzRGVsZWdhdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICBzdGVwcy5wdXNoKHtcclxuICAgICAgICBvcmRlcjogb3JkZXIrKyxcclxuICAgICAgICB0aXRsZTogJ1Jldm9rZSBUb2tlbiBEZWxlZ2F0aW9ucycsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IGBSZXZva2UgJHttYWxpY2lvdXNEZWxlZ2F0aW9ucy5sZW5ndGh9IG1hbGljaW91cyB0b2tlbiBkZWxlZ2F0aW9uJHttYWxpY2lvdXNEZWxlZ2F0aW9ucy5sZW5ndGggPiAxID8gJ3MnIDogJyd9LmAsXHJcbiAgICAgICAgYWN0aW9uOiB7XHJcbiAgICAgICAgICB0eXBlOiAnREVMRUdBVEVfUkVWT0tFJyxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHByaW9yaXR5OiAnSU1NRURJQVRFJyxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3RlcCAyOiBUcmFuc2ZlciBhc3NldHMgaWYgb25nb2luZyByaXNrXHJcbiAgICBpZiAodGhyZWF0cy5zb21lKCh0KSA9PiB0Lm9uZ29pbmdSaXNrKSkge1xyXG4gICAgICBzdGVwcy5wdXNoKHtcclxuICAgICAgICBvcmRlcjogb3JkZXIrKyxcclxuICAgICAgICB0aXRsZTogJ1RyYW5zZmVyIEFsbCBBc3NldHMnLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTW92ZSBhbGwgU09MIGFuZCB0b2tlbnMgdG8gYSBuZXcsIHNlY3VyZSB3YWxsZXQuJyxcclxuICAgICAgICBhY3Rpb246IHtcclxuICAgICAgICAgIHR5cGU6ICdUUkFOU0ZFUl9BU1NFVFMnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJpb3JpdHk6ICdJTU1FRElBVEUnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTdGVwIDM6IENsb3NlIHRva2VuIGFjY291bnRzXHJcbiAgICBzdGVwcy5wdXNoKHtcclxuICAgICAgb3JkZXI6IG9yZGVyKyssXHJcbiAgICAgIHRpdGxlOiAnQ2xvc2UgVG9rZW4gQWNjb3VudHMnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogJ0Nsb3NlIGFsbCB0b2tlbiBhY2NvdW50cyBvbiB0aGUgY29tcHJvbWlzZWQgd2FsbGV0IHRvIHJlY2xhaW0gcmVudC4nLFxyXG4gICAgICBhY3Rpb246IHtcclxuICAgICAgICB0eXBlOiAnQ0xPU0VfQUNDT1VOVCcsXHJcbiAgICAgIH0sXHJcbiAgICAgIHByaW9yaXR5OiAnSElHSCcsXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1cmdlbmN5TGV2ZWw6IHRocmVhdHMuc29tZSgodCkgPT4gdC5zZXZlcml0eSA9PT0gJ0NSSVRJQ0FMJykgPyAnQ1JJVElDQUwnIDogJ0hJR0gnLFxyXG4gICAgICBlc3RpbWF0ZWRUaW1lTWludXRlczogc3RlcHMubGVuZ3RoICogMyxcclxuICAgICAgc3RlcHMsXHJcbiAgICAgIHdhcm5pbmdzOiBbXHJcbiAgICAgICAgJ1ZlcmlmeSB5b3UgYXJlIG9uIHRoZSBvZmZpY2lhbCBTb2xhbmEgd2FsbGV0IG9yIGRBcHAnLFxyXG4gICAgICAgICdOZXZlciBzaGFyZSB5b3VyIHNlZWQgcGhyYXNlJyxcclxuICAgICAgICAnQmUgY2F1dGlvdXMgb2YgYW55b25lIG9mZmVyaW5nIFwicmVjb3Zlcnkgc2VydmljZXNcIicsXHJcbiAgICAgIF0sXHJcbiAgICAgIHNhZmVXYWxsZXRSZXF1aXJlZDogdHJ1ZSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGdlbmVyYXRlU3VtbWFyeShcclxuICAgIHN0YXR1czogU2VjdXJpdHlTdGF0dXMsXHJcbiAgICB0aHJlYXRzOiBEZXRlY3RlZFRocmVhdFtdLFxyXG4gICAgYXBwcm92YWxzOiBUb2tlbkFwcHJvdmFsW11cclxuICApOiBzdHJpbmcge1xyXG4gICAgaWYgKHN0YXR1cyA9PT0gJ1NBRkUnKSB7XHJcbiAgICAgIHJldHVybiAnTm8gc2lnbmlmaWNhbnQgc2VjdXJpdHkgdGhyZWF0cyBkZXRlY3RlZCBvbiB5b3VyIFNvbGFuYSB3YWxsZXQuIENvbnRpbnVlIHByYWN0aWNpbmcgc2FmZSB3YWxsZXQgaHlnaWVuZS4nO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzdGF0dXMgPT09ICdBVF9SSVNLJykge1xyXG4gICAgICByZXR1cm4gYCR7dGhyZWF0cy5sZW5ndGh9IHBvdGVudGlhbCBzZWN1cml0eSBjb25jZXJuJHt0aHJlYXRzLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBkZXRlY3RlZC4gUmV2aWV3IHRoZSBmaW5kaW5ncyBhbmQgdGFrZSBwcmV2ZW50aXZlIGFjdGlvbi5gO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBgVVJHRU5UOiBDcml0aWNhbCBzZWN1cml0eSB0aHJlYXRzIGRldGVjdGVkIG9uIHlvdXIgU29sYW5hIHdhbGxldC4gSW1tZWRpYXRlIGFjdGlvbiByZXF1aXJlZCB0byBwcm90ZWN0IHJlbWFpbmluZyBhc3NldHMuYDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2VuZXJhdGVFZHVjYXRpb25hbENvbnRlbnQodGhyZWF0czogRGV0ZWN0ZWRUaHJlYXRbXSkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXR0YWNrRXhwbGFuYXRpb246IHtcclxuICAgICAgICB3aGF0SGFwcGVuZWQ6ICdTdXNwaWNpb3VzIGFjdGl2aXR5IHdhcyBkZXRlY3RlZCBvbiB5b3VyIFNvbGFuYSB3YWxsZXQuJyxcclxuICAgICAgICBob3dJdFdvcmtzOiAnU29sYW5hLXNwZWNpZmljIGF0dGFja3MgY2FuIGluY2x1ZGUgbWFsaWNpb3VzIHByb2dyYW0gaW50ZXJhY3Rpb25zLCB0b2tlbiBkZWxlZ2F0aW9uIGFidXNlLCBhbmQgcGhpc2hpbmcgYWlyZHJvcHMuJyxcclxuICAgICAgICBvbmdvaW5nRGFtYWdlOiAnSWYgZGVsZWdhdGlvbnMgb3IgcHJvZ3JhbSBhdXRob3JpdGllcyBhcmUgc3RpbGwgYWN0aXZlLCB5b3VyIGFzc2V0cyBtYXkgc3RpbGwgYmUgYXQgcmlzay4nLFxyXG4gICAgICAgIHJlY292ZXJhYmxlSW5mbzogJ1RyYW5zZmVyIHJlbWFpbmluZyBhc3NldHMgdG8gYSBmcmVzaCB3YWxsZXQgYW5kIHJldm9rZSBhbGwgZGVsZWdhdGlvbnMuJyxcclxuICAgICAgfSxcclxuICAgICAgcHJldmVudGlvblRpcHM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICB0aXRsZTogJ1ZlcmlmeSBQcm9ncmFtIElEcycsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0Fsd2F5cyB2ZXJpZnkgdGhlIHByb2dyYW0gSUQgYmVmb3JlIHNpZ25pbmcgU29sYW5hIHRyYW5zYWN0aW9ucy4gVXNlIG9mZmljaWFsIGRvY3VtZW50YXRpb24uJyxcclxuICAgICAgICAgIGltcG9ydGFuY2U6ICdISUdIJyBhcyBSaXNrTGV2ZWwsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB0aXRsZTogJ0JlIENhdXRpb3VzIG9mIEFpcmRyb3BzJyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnRG8gbm90IGludGVyYWN0IHdpdGggdW5zb2xpY2l0ZWQgdG9rZW4gYWlyZHJvcHMuIFRoZXkgbWF5IGJlIHBoaXNoaW5nIGF0dGVtcHRzLicsXHJcbiAgICAgICAgICBpbXBvcnRhbmNlOiAnTUVESVVNJyBhcyBSaXNrTGV2ZWwsXHJcbiAgICAgICAgfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICB0aXRsZTogJ1JldmlldyBUb2tlbiBBY2NvdW50IERlbGVnYXRpb25zJyxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiAnUmVndWxhcmx5IGNoZWNrIGlmIGFueSBvZiB5b3VyIHRva2VuIGFjY291bnRzIGhhdmUgYWN0aXZlIGRlbGVnYXRpb25zLicsXHJcbiAgICAgICAgICBpbXBvcnRhbmNlOiAnTUVESVVNJyBhcyBSaXNrTGV2ZWwsXHJcbiAgICAgICAgfSxcclxuICAgICAgXSxcclxuICAgICAgc2VjdXJpdHlDaGVja2xpc3Q6IFtcclxuICAgICAgICB7IGlkOiAnMScsIGNhdGVnb3J5OiAnV2FsbGV0JywgaXRlbTogJ1VzZSBoYXJkd2FyZSB3YWxsZXQgZm9yIHNpZ25pZmljYW50IGhvbGRpbmdzJywgY29tcGxldGVkOiBmYWxzZSwgY2hhaW5TcGVjaWZpYzogWydzb2xhbmEnXSB9LFxyXG4gICAgICAgIHsgaWQ6ICcyJywgY2F0ZWdvcnk6ICdXYWxsZXQnLCBpdGVtOiAnQmFja3VwIHNlZWQgcGhyYXNlIHNlY3VyZWx5IG9mZmxpbmUnLCBjb21wbGV0ZWQ6IGZhbHNlIH0sXHJcbiAgICAgICAgeyBpZDogJzMnLCBjYXRlZ29yeTogJ1RyYW5zYWN0aW9ucycsIGl0ZW06ICdWZXJpZnkgcHJvZ3JhbSBJRHMgYmVmb3JlIHNpZ25pbmcnLCBjb21wbGV0ZWQ6IGZhbHNlLCBjaGFpblNwZWNpZmljOiBbJ3NvbGFuYSddIH0sXHJcbiAgICAgICAgeyBpZDogJzQnLCBjYXRlZ29yeTogJ1Rva2VucycsIGl0ZW06ICdDbG9zZSB1bnVzZWQgdG9rZW4gYWNjb3VudHMnLCBjb21wbGV0ZWQ6IGZhbHNlLCBjaGFpblNwZWNpZmljOiBbJ3NvbGFuYSddIH0sXHJcbiAgICAgICAgeyBpZDogJzUnLCBjYXRlZ29yeTogJ1NlY3VyaXR5JywgaXRlbTogJ0F2b2lkIGNsaWNraW5nIGFpcmRyb3AgbGlua3MnLCBjb21wbGV0ZWQ6IGZhbHNlIH0sXHJcbiAgICAgIF0sXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuIl0sIm5hbWVzIjpbIkNvbm5lY3Rpb24iLCJQdWJsaWNLZXkiLCJDSEFJTl9SUENfQ09ORklHIiwiU09MQU5BX01BTElDSU9VU19QUk9HUkFNUyIsIlRPS0VOX1BST0dSQU1fSUQiLCJUT0tFTl8yMDIyX1BST0dSQU1fSUQiLCJBU1NPQ0lBVEVEX1RPS0VOX1BST0dSQU1fSUQiLCJNRU1PX1BST0dSQU1fSUQiLCJTVVNQSUNJT1VTX1BST0dSQU1fUEFUVEVSTlMiLCJTb2xhbmFBbmFseXplciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwic29sYW5hIiwicnBjVXJsIiwicnBjVXJscyIsImNvbm5lY3Rpb24iLCJleHBsb3JlckFwaVVybCIsImV4cGxvcmVyQXBpIiwiYW5hbHl6ZVdhbGxldCIsImFkZHJlc3MiLCJwdWJsaWNLZXkiLCJFcnJvciIsInRyYW5zYWN0aW9ucyIsInRva2VuQWNjb3VudHMiLCJiYWxhbmNlIiwiUHJvbWlzZSIsImFsbCIsImZldGNoVHJhbnNhY3Rpb25IaXN0b3J5IiwiZmV0Y2hUb2tlbkFjY291bnRzIiwiZ2V0QmFsYW5jZSIsInRocmVhdHMiLCJtYWxpY2lvdXNQcm9ncmFtVGhyZWF0cyIsImRldGVjdE1hbGljaW91c1Byb2dyYW1JbnRlcmFjdGlvbnMiLCJwdXNoIiwiZGVsZWdhdGVUaHJlYXRzIiwiZGV0ZWN0RGVsZWdhdGVBYnVzZSIsIm91dGZsb3dUaHJlYXRzIiwiZGV0ZWN0UmFwaWRPdXRmbG93cyIsImFpcmRyb3BUaHJlYXRzIiwiZGV0ZWN0U3VzcGljaW91c0FpcmRyb3BzIiwiYXBwcm92YWxzIiwiYW5hbHl6ZVRva2VuRGVsZWdhdGlvbnMiLCJyaXNrU2NvcmUiLCJjYWxjdWxhdGVSaXNrU2NvcmUiLCJzZWN1cml0eVN0YXR1cyIsImRldGVybWluZVNlY3VyaXR5U3RhdHVzIiwic3VzcGljaW91c1RyYW5zYWN0aW9ucyIsImlkZW50aWZ5U3VzcGljaW91c1RyYW5zYWN0aW9ucyIsInJlY29tbWVuZGF0aW9ucyIsImdlbmVyYXRlUmVjb21tZW5kYXRpb25zIiwicmVjb3ZlcnlQbGFuIiwiZ2VuZXJhdGVSZWNvdmVyeVBsYW4iLCJ1bmRlZmluZWQiLCJjaGFpbiIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInN1bW1hcnkiLCJnZW5lcmF0ZVN1bW1hcnkiLCJkZXRlY3RlZFRocmVhdHMiLCJlZHVjYXRpb25hbENvbnRlbnQiLCJnZW5lcmF0ZUVkdWNhdGlvbmFsQ29udGVudCIsInNpZ25hdHVyZXMiLCJnZXRTaWduYXR1cmVzRm9yQWRkcmVzcyIsImxpbWl0Iiwic2xpY2UiLCJtYXAiLCJzaWciLCJnZXRQYXJzZWRUcmFuc2FjdGlvbiIsInNpZ25hdHVyZSIsIm1heFN1cHBvcnRlZFRyYW5zYWN0aW9uVmVyc2lvbiIsImZpbHRlciIsInR4IiwiZXJyb3IiLCJjb25zb2xlIiwiZ2V0UGFyc2VkVG9rZW5BY2NvdW50c0J5T3duZXIiLCJwcm9ncmFtSWQiLCJ2YWx1ZSIsInRyYW5zYWN0aW9uIiwibWVzc2FnZSIsImluc3RydWN0aW9ucyIsImluc3RydWN0aW9uIiwidG9TdHJpbmciLCJpbmNsdWRlcyIsImlkIiwidHlwZSIsInNldmVyaXR5IiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInRlY2huaWNhbERldGFpbHMiLCJkZXRlY3RlZEF0IiwicmVsYXRlZEFkZHJlc3NlcyIsInJlbGF0ZWRUcmFuc2FjdGlvbnMiLCJvbmdvaW5nUmlzayIsIm93bmVyIiwiYWNjb3VudCIsImluZm8iLCJkYXRhIiwicGFyc2VkIiwiZGVsZWdhdGUiLCJkZWxlZ2F0ZWRBbW91bnQiLCJCaWdJbnQiLCJhbW91bnQiLCJwdWJrZXkiLCJ3aW5kb3dNaW51dGVzIiwic29ydGVkVHhzIiwiYmxvY2tUaW1lIiwic29ydCIsImEiLCJiIiwiaSIsImxlbmd0aCIsIndpbmRvd1N0YXJ0Iiwid2luZG93RW5kIiwidHhzSW5XaW5kb3ciLCJvdXRib3VuZENvdW50IiwicHJlQmFsYW5jZXMiLCJtZXRhIiwicG9zdEJhbGFuY2VzIiwibm93IiwiZGVzdGluYXRpb24iLCJtZW1vSW5zdHJ1Y3Rpb24iLCJmaW5kIiwibWVtb1RleHQiLCJTdHJpbmciLCJ0b0xvd2VyQ2FzZSIsInNvbWUiLCJwYXR0ZXJuIiwiaXNNYWxpY2lvdXMiLCJ0b2tlbiIsIm1pbnQiLCJzeW1ib2wiLCJuYW1lIiwiZGVjaW1hbHMiLCJ0b2tlbkFtb3VudCIsInN0YW5kYXJkIiwidmVyaWZpZWQiLCJzcGVuZGVyIiwiaXNVbmxpbWl0ZWQiLCJyaXNrTGV2ZWwiLCJyaXNrUmVhc29uIiwiZ3JhbnRlZEF0Iiwic2NvcmUiLCJ0IiwiTWF0aCIsIm1pbiIsIm1heCIsImhhc0NyaXRpY2FsIiwic3VzcGljaW91c1NpZ3MiLCJTZXQiLCJmbGF0TWFwIiwiaGFzIiwicmVsYXRlZFRocmVhdCIsImhhc2giLCJmcm9tIiwiYWNjb3VudEtleXMiLCJ0byIsImZsYWdzIiwic3RhdHVzIiwibWFsaWNpb3VzRGVsZWdhdGlvbnMiLCJwcmlvcml0eSIsImNhdGVnb3J5IiwiYWN0aW9uYWJsZSIsImFjdGlvblR5cGUiLCJzdGVwcyIsIm9yZGVyIiwiYWN0aW9uIiwidXJnZW5jeUxldmVsIiwiZXN0aW1hdGVkVGltZU1pbnV0ZXMiLCJ3YXJuaW5ncyIsInNhZmVXYWxsZXRSZXF1aXJlZCIsImF0dGFja0V4cGxhbmF0aW9uIiwid2hhdEhhcHBlbmVkIiwiaG93SXRXb3JrcyIsIm9uZ29pbmdEYW1hZ2UiLCJyZWNvdmVyYWJsZUluZm8iLCJwcmV2ZW50aW9uVGlwcyIsImltcG9ydGFuY2UiLCJzZWN1cml0eUNoZWNrbGlzdCIsIml0ZW0iLCJjb21wbGV0ZWQiLCJjaGFpblNwZWNpZmljIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/analyzers/solana-analyzer.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/detection/drainer-addresses.ts":
/*!************************************************!*\
  !*** ./src/lib/detection/drainer-addresses.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DRAINER_CONTRACTS: () => (/* binding */ DRAINER_CONTRACTS),\n/* harmony export */   DRAINER_RECIPIENTS: () => (/* binding */ DRAINER_RECIPIENTS),\n/* harmony export */   getDrainerType: () => (/* binding */ getDrainerType),\n/* harmony export */   isKnownDrainer: () => (/* binding */ isKnownDrainer)\n/* harmony export */ });\n// ============================================\n// COMPREHENSIVE DRAINER ADDRESS DATABASE\n// ============================================\n// This file contains VERIFIED malicious drainer contract addresses and recipient wallets.\n// Only addresses that are CONFIRMED malicious should be in this list.\n// Legitimate contracts (Uniswap, 0x, Blur, etc.) must NOT be included.\n// Known drainer contract addresses (multi-chain) - VERIFIED MALICIOUS ONLY\nconst DRAINER_CONTRACTS = [\n    // ============================================\n    // INFERNO DRAINER FAMILY - CONFIRMED MALICIOUS\n    // ============================================\n    \"0x0000db5c8b030ae20308ac975898e09741e70000\",\n    \"0x00000000a82b4758df44fcab4c4e86e2f231b000\",\n    // ============================================\n    // PINK DRAINER FAMILY - CONFIRMED MALICIOUS\n    // ============================================\n    \"0x00005ea00ac477b1030ce78506496e8c2de24bf5\",\n    \"0x0000d194a19e7578e1ee97a2b6f6e4af01a00000\",\n    // ============================================\n    // ANGEL DRAINER FAMILY - CONFIRMED MALICIOUS\n    // ============================================\n    \"0x00000000ae347930bd1e7b0f35588b92280f9e75\",\n    // ============================================\n    // MONKEY DRAINER FAMILY - CONFIRMED MALICIOUS\n    // ============================================\n    \"0x0000000035634b55f3d99b071b5a354f48e10000\",\n    // ============================================\n    // VENOM DRAINER FAMILY - CONFIRMED MALICIOUS\n    // ============================================\n    \"0x0000000052e7f0c029b6e38e96f03c70d86bfde5\",\n    // ============================================\n    // MS DRAINER FAMILY - CONFIRMED MALICIOUS\n    // ============================================\n    \"0x0000000083fc54c35b9b83de16c67c73b1a7b000\"\n];\n// Known drainer recipient wallets (where stolen funds are sent) - VERIFIED ONLY\nconst DRAINER_RECIPIENTS = [\n    // ============================================\n    // INFERNO DRAINER RECIPIENTS - CONFIRMED\n    // ============================================\n    \"0x59abf3837fa962d6853b4cc0a19513aa031fd32b\",\n    \"0x0000db5c8b030ae20308ac975898e09741e70000\",\n    // ============================================\n    // PINK DRAINER RECIPIENTS - CONFIRMED\n    // ============================================\n    \"0x00005ea00ac477b1030ce78506496e8c2de24bf5\",\n    \"0x6d2e03b7effeae98bd302a9f836d0d6ab0002219\",\n    // ============================================\n    // ANGEL DRAINER RECIPIENTS - CONFIRMED\n    // ============================================\n    \"0x00000000ae347930bd1e7b0f35588b92280f9e75\",\n    // ============================================\n    // MS DRAINER RECIPIENTS - CONFIRMED\n    // ============================================\n    \"0x0000000083fc54c35b9b83de16c67c73b1a7b000\"\n];\n// Function to check if an address is a known drainer\nfunction isKnownDrainer(address) {\n    if (!address) return false;\n    const normalized = address.toLowerCase();\n    return DRAINER_CONTRACTS.some((d)=>d.toLowerCase() === normalized) || DRAINER_RECIPIENTS.some((d)=>d.toLowerCase() === normalized);\n}\n// Function to get drainer type\nfunction getDrainerType(address) {\n    if (!address) return null;\n    const normalized = address.toLowerCase();\n    // Check specific patterns in the address\n    if (normalized.includes(\"db5c8b030ae20308ac975898e09741e7\")) return \"Inferno Drainer\";\n    if (normalized.includes(\"5ea00ac477b1030ce78506496e8c2de2\")) return \"Pink Drainer\";\n    if (normalized.includes(\"ae347930bd1e7b0f35588b92280f9e75\")) return \"Angel Drainer\";\n    if (normalized.includes(\"35634b55f3d99b071b5a354f48e1\")) return \"Monkey Drainer\";\n    if (normalized.includes(\"52e7f0c029b6e38e96f03c70d86bfde5\")) return \"Venom Drainer\";\n    if (normalized.includes(\"83fc54c35b9b83de16c67c73b1a7b\")) return \"MS Drainer\";\n    if (isKnownDrainer(address)) return \"Known Drainer\";\n    return null;\n} // NOTE: Pattern-based detection has been removed to prevent false positives.\n // Only addresses explicitly in the lists above will be flagged as malicious.\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RldGVjdGlvbi9kcmFpbmVyLWFkZHJlc3Nlcy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsK0NBQStDO0FBQy9DLHlDQUF5QztBQUN6QywrQ0FBK0M7QUFDL0MsMEZBQTBGO0FBQzFGLHNFQUFzRTtBQUN0RSx1RUFBdUU7QUFFdkUsMkVBQTJFO0FBQ3BFLE1BQU1BLG9CQUE4QjtJQUN6QywrQ0FBK0M7SUFDL0MsK0NBQStDO0lBQy9DLCtDQUErQztJQUMvQztJQUNBO0lBRUEsK0NBQStDO0lBQy9DLDRDQUE0QztJQUM1QywrQ0FBK0M7SUFDL0M7SUFDQTtJQUVBLCtDQUErQztJQUMvQyw2Q0FBNkM7SUFDN0MsK0NBQStDO0lBQy9DO0lBRUEsK0NBQStDO0lBQy9DLDhDQUE4QztJQUM5QywrQ0FBK0M7SUFDL0M7SUFFQSwrQ0FBK0M7SUFDL0MsNkNBQTZDO0lBQzdDLCtDQUErQztJQUMvQztJQUVBLCtDQUErQztJQUMvQywwQ0FBMEM7SUFDMUMsK0NBQStDO0lBQy9DO0NBQ0QsQ0FBQztBQUVGLGdGQUFnRjtBQUN6RSxNQUFNQyxxQkFBK0I7SUFDMUMsK0NBQStDO0lBQy9DLHlDQUF5QztJQUN6QywrQ0FBK0M7SUFDL0M7SUFDQTtJQUVBLCtDQUErQztJQUMvQyxzQ0FBc0M7SUFDdEMsK0NBQStDO0lBQy9DO0lBQ0E7SUFFQSwrQ0FBK0M7SUFDL0MsdUNBQXVDO0lBQ3ZDLCtDQUErQztJQUMvQztJQUVBLCtDQUErQztJQUMvQyxvQ0FBb0M7SUFDcEMsK0NBQStDO0lBQy9DO0NBQ0QsQ0FBQztBQUVGLHFEQUFxRDtBQUM5QyxTQUFTQyxlQUFlQyxPQUFlO0lBQzVDLElBQUksQ0FBQ0EsU0FBUyxPQUFPO0lBQ3JCLE1BQU1DLGFBQWFELFFBQVFFLFdBQVc7SUFDdEMsT0FBT0wsa0JBQWtCTSxJQUFJLENBQUNDLENBQUFBLElBQUtBLEVBQUVGLFdBQVcsT0FBT0QsZUFDaERILG1CQUFtQkssSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFRixXQUFXLE9BQU9EO0FBQzFEO0FBRUEsK0JBQStCO0FBQ3hCLFNBQVNJLGVBQWVMLE9BQWU7SUFDNUMsSUFBSSxDQUFDQSxTQUFTLE9BQU87SUFDckIsTUFBTUMsYUFBYUQsUUFBUUUsV0FBVztJQUV0Qyx5Q0FBeUM7SUFDekMsSUFBSUQsV0FBV0ssUUFBUSxDQUFDLHFDQUFxQyxPQUFPO0lBQ3BFLElBQUlMLFdBQVdLLFFBQVEsQ0FBQyxxQ0FBcUMsT0FBTztJQUNwRSxJQUFJTCxXQUFXSyxRQUFRLENBQUMscUNBQXFDLE9BQU87SUFDcEUsSUFBSUwsV0FBV0ssUUFBUSxDQUFDLGlDQUFpQyxPQUFPO0lBQ2hFLElBQUlMLFdBQVdLLFFBQVEsQ0FBQyxxQ0FBcUMsT0FBTztJQUNwRSxJQUFJTCxXQUFXSyxRQUFRLENBQUMsa0NBQWtDLE9BQU87SUFFakUsSUFBSVAsZUFBZUMsVUFBVSxPQUFPO0lBRXBDLE9BQU87QUFDVCxFQUVBLDZFQUE2RTtDQUM3RSw2RUFBNkUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93YWxsZXQtc2VudGluZWwvLi9zcmMvbGliL2RldGVjdGlvbi9kcmFpbmVyLWFkZHJlc3Nlcy50cz80NWQ4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIENPTVBSRUhFTlNJVkUgRFJBSU5FUiBBRERSRVNTIERBVEFCQVNFXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vIFRoaXMgZmlsZSBjb250YWlucyBWRVJJRklFRCBtYWxpY2lvdXMgZHJhaW5lciBjb250cmFjdCBhZGRyZXNzZXMgYW5kIHJlY2lwaWVudCB3YWxsZXRzLlxyXG4vLyBPbmx5IGFkZHJlc3NlcyB0aGF0IGFyZSBDT05GSVJNRUQgbWFsaWNpb3VzIHNob3VsZCBiZSBpbiB0aGlzIGxpc3QuXHJcbi8vIExlZ2l0aW1hdGUgY29udHJhY3RzIChVbmlzd2FwLCAweCwgQmx1ciwgZXRjLikgbXVzdCBOT1QgYmUgaW5jbHVkZWQuXHJcblxyXG4vLyBLbm93biBkcmFpbmVyIGNvbnRyYWN0IGFkZHJlc3NlcyAobXVsdGktY2hhaW4pIC0gVkVSSUZJRUQgTUFMSUNJT1VTIE9OTFlcclxuZXhwb3J0IGNvbnN0IERSQUlORVJfQ09OVFJBQ1RTOiBzdHJpbmdbXSA9IFtcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIElORkVSTk8gRFJBSU5FUiBGQU1JTFkgLSBDT05GSVJNRUQgTUFMSUNJT1VTXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAnMHgwMDAwZGI1YzhiMDMwYWUyMDMwOGFjOTc1ODk4ZTA5NzQxZTcwMDAwJyxcclxuICAnMHgwMDAwMDAwMGE4MmI0NzU4ZGY0NGZjYWI0YzRlODZlMmYyMzFiMDAwJyxcclxuICBcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIFBJTksgRFJBSU5FUiBGQU1JTFkgLSBDT05GSVJNRUQgTUFMSUNJT1VTXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAnMHgwMDAwNWVhMDBhYzQ3N2IxMDMwY2U3ODUwNjQ5NmU4YzJkZTI0YmY1JyxcclxuICAnMHgwMDAwZDE5NGExOWU3NTc4ZTFlZTk3YTJiNmY2ZTRhZjAxYTAwMDAwJyxcclxuICBcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIEFOR0VMIERSQUlORVIgRkFNSUxZIC0gQ09ORklSTUVEIE1BTElDSU9VU1xyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgJzB4MDAwMDAwMDBhZTM0NzkzMGJkMWU3YjBmMzU1ODhiOTIyODBmOWU3NScsXHJcbiAgXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBNT05LRVkgRFJBSU5FUiBGQU1JTFkgLSBDT05GSVJNRUQgTUFMSUNJT1VTXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAnMHgwMDAwMDAwMDM1NjM0YjU1ZjNkOTliMDcxYjVhMzU0ZjQ4ZTEwMDAwJyxcclxuICBcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gIC8vIFZFTk9NIERSQUlORVIgRkFNSUxZIC0gQ09ORklSTUVEIE1BTElDSU9VU1xyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgJzB4MDAwMDAwMDA1MmU3ZjBjMDI5YjZlMzhlOTZmMDNjNzBkODZiZmRlNScsXHJcbiAgXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBNUyBEUkFJTkVSIEZBTUlMWSAtIENPTkZJUk1FRCBNQUxJQ0lPVVNcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICcweDAwMDAwMDAwODNmYzU0YzM1YjliODNkZTE2YzY3YzczYjFhN2IwMDAnLFxyXG5dO1xyXG5cclxuLy8gS25vd24gZHJhaW5lciByZWNpcGllbnQgd2FsbGV0cyAod2hlcmUgc3RvbGVuIGZ1bmRzIGFyZSBzZW50KSAtIFZFUklGSUVEIE9OTFlcclxuZXhwb3J0IGNvbnN0IERSQUlORVJfUkVDSVBJRU5UUzogc3RyaW5nW10gPSBbXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBJTkZFUk5PIERSQUlORVIgUkVDSVBJRU5UUyAtIENPTkZJUk1FRFxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgJzB4NTlhYmYzODM3ZmE5NjJkNjg1M2I0Y2MwYTE5NTEzYWEwMzFmZDMyYicsXHJcbiAgJzB4MDAwMGRiNWM4YjAzMGFlMjAzMDhhYzk3NTg5OGUwOTc0MWU3MDAwMCcsXHJcbiAgXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBQSU5LIERSQUlORVIgUkVDSVBJRU5UUyAtIENPTkZJUk1FRFxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgJzB4MDAwMDVlYTAwYWM0NzdiMTAzMGNlNzg1MDY0OTZlOGMyZGUyNGJmNScsXHJcbiAgJzB4NmQyZTAzYjdlZmZlYWU5OGJkMzAyYTlmODM2ZDBkNmFiMDAwMjIxOScsXHJcbiAgXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAvLyBBTkdFTCBEUkFJTkVSIFJFQ0lQSUVOVFMgLSBDT05GSVJNRURcclxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICcweDAwMDAwMDAwYWUzNDc5MzBiZDFlN2IwZjM1NTg4YjkyMjgwZjllNzUnLFxyXG4gIFxyXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbiAgLy8gTVMgRFJBSU5FUiBSRUNJUElFTlRTIC0gQ09ORklSTUVEXHJcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuICAnMHgwMDAwMDAwMDgzZmM1NGMzNWI5YjgzZGUxNmM2N2M3M2IxYTdiMDAwJyxcclxuXTtcclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGNoZWNrIGlmIGFuIGFkZHJlc3MgaXMgYSBrbm93biBkcmFpbmVyXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0tub3duRHJhaW5lcihhZGRyZXNzOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICBpZiAoIWFkZHJlc3MpIHJldHVybiBmYWxzZTtcclxuICBjb25zdCBub3JtYWxpemVkID0gYWRkcmVzcy50b0xvd2VyQ2FzZSgpO1xyXG4gIHJldHVybiBEUkFJTkVSX0NPTlRSQUNUUy5zb21lKGQgPT4gZC50b0xvd2VyQ2FzZSgpID09PSBub3JtYWxpemVkKSB8fFxyXG4gICAgICAgICBEUkFJTkVSX1JFQ0lQSUVOVFMuc29tZShkID0+IGQudG9Mb3dlckNhc2UoKSA9PT0gbm9ybWFsaXplZCk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIHRvIGdldCBkcmFpbmVyIHR5cGVcclxuZXhwb3J0IGZ1bmN0aW9uIGdldERyYWluZXJUeXBlKGFkZHJlc3M6IHN0cmluZyk6IHN0cmluZyB8IG51bGwge1xyXG4gIGlmICghYWRkcmVzcykgcmV0dXJuIG51bGw7XHJcbiAgY29uc3Qgbm9ybWFsaXplZCA9IGFkZHJlc3MudG9Mb3dlckNhc2UoKTtcclxuICBcclxuICAvLyBDaGVjayBzcGVjaWZpYyBwYXR0ZXJucyBpbiB0aGUgYWRkcmVzc1xyXG4gIGlmIChub3JtYWxpemVkLmluY2x1ZGVzKCdkYjVjOGIwMzBhZTIwMzA4YWM5NzU4OThlMDk3NDFlNycpKSByZXR1cm4gJ0luZmVybm8gRHJhaW5lcic7XHJcbiAgaWYgKG5vcm1hbGl6ZWQuaW5jbHVkZXMoJzVlYTAwYWM0NzdiMTAzMGNlNzg1MDY0OTZlOGMyZGUyJykpIHJldHVybiAnUGluayBEcmFpbmVyJztcclxuICBpZiAobm9ybWFsaXplZC5pbmNsdWRlcygnYWUzNDc5MzBiZDFlN2IwZjM1NTg4YjkyMjgwZjllNzUnKSkgcmV0dXJuICdBbmdlbCBEcmFpbmVyJztcclxuICBpZiAobm9ybWFsaXplZC5pbmNsdWRlcygnMzU2MzRiNTVmM2Q5OWIwNzFiNWEzNTRmNDhlMScpKSByZXR1cm4gJ01vbmtleSBEcmFpbmVyJztcclxuICBpZiAobm9ybWFsaXplZC5pbmNsdWRlcygnNTJlN2YwYzAyOWI2ZTM4ZTk2ZjAzYzcwZDg2YmZkZTUnKSkgcmV0dXJuICdWZW5vbSBEcmFpbmVyJztcclxuICBpZiAobm9ybWFsaXplZC5pbmNsdWRlcygnODNmYzU0YzM1YjliODNkZTE2YzY3YzczYjFhN2InKSkgcmV0dXJuICdNUyBEcmFpbmVyJztcclxuICBcclxuICBpZiAoaXNLbm93bkRyYWluZXIoYWRkcmVzcykpIHJldHVybiAnS25vd24gRHJhaW5lcic7XHJcbiAgXHJcbiAgcmV0dXJuIG51bGw7XHJcbn1cclxuXHJcbi8vIE5PVEU6IFBhdHRlcm4tYmFzZWQgZGV0ZWN0aW9uIGhhcyBiZWVuIHJlbW92ZWQgdG8gcHJldmVudCBmYWxzZSBwb3NpdGl2ZXMuXHJcbi8vIE9ubHkgYWRkcmVzc2VzIGV4cGxpY2l0bHkgaW4gdGhlIGxpc3RzIGFib3ZlIHdpbGwgYmUgZmxhZ2dlZCBhcyBtYWxpY2lvdXMuXHJcbiJdLCJuYW1lcyI6WyJEUkFJTkVSX0NPTlRSQUNUUyIsIkRSQUlORVJfUkVDSVBJRU5UUyIsImlzS25vd25EcmFpbmVyIiwiYWRkcmVzcyIsIm5vcm1hbGl6ZWQiLCJ0b0xvd2VyQ2FzZSIsInNvbWUiLCJkIiwiZ2V0RHJhaW5lclR5cGUiLCJpbmNsdWRlcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/detection/drainer-addresses.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/detection/malicious-database.ts":
/*!*************************************************!*\
  !*** ./src/lib/detection/malicious-database.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CHAIN_RPC_CONFIG: () => (/* binding */ CHAIN_RPC_CONFIG),\n/* harmony export */   DRAINER_FUNCTION_SIGNATURES: () => (/* binding */ DRAINER_FUNCTION_SIGNATURES),\n/* harmony export */   DRAINER_PATTERNS: () => (/* binding */ DRAINER_PATTERNS),\n/* harmony export */   HIGH_RISK_CONTRACT_PATTERNS: () => (/* binding */ HIGH_RISK_CONTRACT_PATTERNS),\n/* harmony export */   INFINITE_APPROVAL_THRESHOLD: () => (/* binding */ INFINITE_APPROVAL_THRESHOLD),\n/* harmony export */   KNOWN_DRAINER_RECIPIENTS: () => (/* binding */ KNOWN_DRAINER_RECIPIENTS),\n/* harmony export */   KNOWN_LEGITIMATE_CONTRACTS: () => (/* binding */ KNOWN_LEGITIMATE_CONTRACTS),\n/* harmony export */   KNOWN_MALICIOUS_CONTRACTS: () => (/* binding */ KNOWN_MALICIOUS_CONTRACTS),\n/* harmony export */   SOLANA_MALICIOUS_PROGRAMS: () => (/* binding */ SOLANA_MALICIOUS_PROGRAMS),\n/* harmony export */   SUSPICIOUS_METHOD_NAMES: () => (/* binding */ SUSPICIOUS_METHOD_NAMES),\n/* harmony export */   getAttackTypeFromPattern: () => (/* binding */ getAttackTypeFromPattern),\n/* harmony export */   getDrainerPatternBySignature: () => (/* binding */ getDrainerPatternBySignature),\n/* harmony export */   isDrainerMethodSignature: () => (/* binding */ isDrainerMethodSignature),\n/* harmony export */   isDrainerRecipient: () => (/* binding */ isDrainerRecipient),\n/* harmony export */   isHighRiskMethod: () => (/* binding */ isHighRiskMethod),\n/* harmony export */   isInfiniteApproval: () => (/* binding */ isInfiniteApproval),\n/* harmony export */   isLegitimateContract: () => (/* binding */ isLegitimateContract),\n/* harmony export */   isMaliciousAddress: () => (/* binding */ isMaliciousAddress)\n/* harmony export */ });\n/* harmony import */ var _drainer_addresses__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./drainer-addresses */ \"(rsc)/./src/lib/detection/drainer-addresses.ts\");\n// ============================================\n// MALICIOUS ADDRESS & PATTERN DATABASE\n// ============================================\n// This database contains REAL known malicious contracts, drainer patterns,\n// and scam addresses aggregated from community reports and incident feeds.\n// This is a READ-ONLY defensive resource.\n\n// ============================================\n// KNOWN MALICIOUS CONTRACTS - REAL DATA\n// ============================================\n// Sources: ScamSniffer, Forta, ChainAbuse, MistTrack, community reports\nconst KNOWN_MALICIOUS_CONTRACTS = [\n    // ============================================\n    // ETHEREUM MAINNET DRAINERS\n    // ============================================\n    // Inferno Drainer (one of the largest drainer-as-a-service)\n    {\n        address: \"0x0000db5c8b030ae20308ac975898e09741e70000\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"Inferno Drainer\",\n        reportedAt: \"2023-05-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\",\n        affectedUsers: 100000\n    },\n    {\n        address: \"0x00000000a82b4758df44fcab4c4e86e2f231b000\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"Inferno Drainer V2\",\n        reportedAt: \"2023-08-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // Pink Drainer\n    {\n        address: \"0x00005ea00ac477b1030ce78506496e8c2de24bf5\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"Pink Drainer\",\n        reportedAt: \"2023-06-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\",\n        affectedUsers: 50000\n    },\n    {\n        address: \"0x0000d194a19e7578e1ee97a2b6f6e4af01a00000\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"Pink Drainer V2\",\n        reportedAt: \"2023-09-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // Angel Drainer\n    {\n        address: \"0x00000000ae347930bd1e7b0f35588b92280f9e75\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"Angel Drainer\",\n        reportedAt: \"2023-10-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // Monkey Drainer\n    {\n        address: \"0x0000000035634b55f3d99b071b5a354f48e10000\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"Monkey Drainer\",\n        reportedAt: \"2022-10-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\",\n        affectedUsers: 20000\n    },\n    // Venom Drainer\n    {\n        address: \"0x0000000052e7f0c029b6e38e96f03c70d86bfde5\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"Venom Drainer\",\n        reportedAt: \"2023-03-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // MS Drainer\n    {\n        address: \"0x0000000083fc54c35b9b83de16c67c73b1a7b000\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"MS Drainer\",\n        reportedAt: \"2023-11-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // Pussy Drainer\n    {\n        address: \"0x00000000052e7f0c029b6e38e96f03c70d86bfe5\",\n        chain: \"ethereum\",\n        type: \"WALLET_DRAINER\",\n        name: \"Pussy Drainer\",\n        reportedAt: \"2023-07-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // Ice Phishing contracts\n    {\n        address: \"0x00000000000000adc04c56bf30ac9d3c0aaf14dc\",\n        chain: \"ethereum\",\n        type: \"PHISHING_SIGNATURE\",\n        name: \"Seaport Conduit Phishing\",\n        reportedAt: \"2023-05-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // Known scam NFT contracts\n    {\n        address: \"0x0000000000664ceffed39244a8312bd895470803\",\n        chain: \"ethereum\",\n        type: \"MALICIOUS_NFT_AIRDROP\",\n        name: \"Fake Blur Airdrop\",\n        reportedAt: \"2023-02-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // ============================================\n    // BASE CHAIN DRAINERS\n    // ============================================\n    {\n        address: \"0x0000db5c8b030ae20308ac975898e09741e70000\",\n        chain: \"base\",\n        type: \"WALLET_DRAINER\",\n        name: \"Inferno Drainer (Base)\",\n        reportedAt: \"2023-08-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    {\n        address: \"0x00005ea00ac477b1030ce78506496e8c2de24bf5\",\n        chain: \"base\",\n        type: \"WALLET_DRAINER\",\n        name: \"Pink Drainer (Base)\",\n        reportedAt: \"2023-09-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    // ============================================\n    // BNB CHAIN DRAINERS\n    // ============================================\n    {\n        address: \"0x0000db5c8b030ae20308ac975898e09741e70000\",\n        chain: \"bnb\",\n        type: \"WALLET_DRAINER\",\n        name: \"Inferno Drainer (BSC)\",\n        reportedAt: \"2023-06-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    },\n    {\n        address: \"0x00005ea00ac477b1030ce78506496e8c2de24bf5\",\n        chain: \"bnb\",\n        type: \"WALLET_DRAINER\",\n        name: \"Pink Drainer (BSC)\",\n        reportedAt: \"2023-08-01T00:00:00Z\",\n        confirmationLevel: \"CONFIRMED\"\n    }\n];\n// ============================================\n// KNOWN DRAINER WALLET ADDRESSES (Recipients)\n// ============================================\n// These are addresses that have received stolen funds\nconst KNOWN_DRAINER_RECIPIENTS = [\n    // Inferno Drainer wallets\n    \"0x59abf3837fa962d6853b4cc0a19513aa031fd32b\",\n    \"0x0000db5c8b030ae20308ac975898e09741e70000\",\n    \"0xaefc6e27b7a73e7c4f1a5c2e7a9a5b5c3d1e0f00\",\n    // Pink Drainer wallets\n    \"0x00005ea00ac477b1030ce78506496e8c2de24bf5\",\n    \"0x6d2e03b7effeae98bd302a9f836d0d6ab0002219\",\n    // Angel Drainer wallets\n    \"0x00000000ae347930bd1e7b0f35588b92280f9e75\",\n    // MS Drainer wallets\n    \"0x0000000083fc54c35b9b83de16c67c73b1a7b000\"\n];\n// ============================================\n// DRAINER FUNCTION SIGNATURES\n// ============================================\nconst DRAINER_FUNCTION_SIGNATURES = {\n    // Standard token operations (commonly abused)\n    \"0x23b872dd\": \"transferFrom(address,address,uint256)\",\n    \"0x42842e0e\": \"safeTransferFrom(address,address,uint256)\",\n    \"0xa22cb465\": \"setApprovalForAll(address,bool)\",\n    \"0x095ea7b3\": \"approve(address,uint256)\",\n    \"0x2eb2c2d6\": \"safeBatchTransferFrom(address,address,uint256[],uint256[],bytes)\",\n    // Permit signatures (gasless approvals - HIGH RISK)\n    \"0xd505accf\": \"permit(address,address,uint256,uint256,uint8,bytes32,bytes32)\",\n    \"0x8fcbaf0c\": \"permit(address,address,uint256,uint256,bool,uint8,bytes32,bytes32)\",\n    // Seaport signatures\n    \"0xfb0f3ee1\": \"fulfillBasicOrder()\",\n    \"0x87201b41\": \"fulfillOrder()\",\n    // Known drainer methods\n    \"0x1cff79cd\": \"execute(address,bytes)\",\n    \"0xb61d27f6\": \"execute(address,uint256,bytes)\",\n    \"0x0dcd7a6c\": \"batchTransfer(address[],uint256[])\",\n    \"0xaf6e06a0\": \"claim()\",\n    \"0x4e71d92d\": \"claim()\",\n    \"0x2e7ba6ef\": \"claim(uint256,address,uint256,bytes32[])\"\n};\n// ============================================\n// SUSPICIOUS METHOD NAMES\n// ============================================\nconst SUSPICIOUS_METHOD_NAMES = [\n    \"securityUpdate\",\n    \"claimReward\",\n    \"claimAirdrop\",\n    \"claimTokens\",\n    \"claimNFT\",\n    \"claim\",\n    \"multicall\",\n    \"execute\",\n    \"connectWallet\",\n    \"verify\",\n    \"validate\",\n    \"sync\",\n    \"restore\",\n    \"revoke\",\n    \"unstake\",\n    \"migrate\",\n    \"upgrade\"\n];\n// ============================================\n// INFINITE APPROVAL THRESHOLD\n// ============================================\nconst INFINITE_APPROVAL_THRESHOLD = BigInt(\"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\") / BigInt(2);\n// ============================================\n// DRAINER BEHAVIOR PATTERNS\n// ============================================\nconst DRAINER_PATTERNS = [\n    {\n        id: \"rapid-outflow\",\n        name: \"Rapid Asset Outflow\",\n        signatures: [],\n        behaviorPatterns: [\n            {\n                type: \"RAPID_TRANSFERS\",\n                description: \"Multiple outbound transfers within short timeframe\",\n                threshold: 3,\n                timeWindowMinutes: 10\n            }\n        ]\n    },\n    {\n        id: \"approval-abuse\",\n        name: \"Approval Abuse Pattern\",\n        signatures: [\n            \"0x095ea7b3\",\n            \"0xa22cb465\"\n        ],\n        behaviorPatterns: [\n            {\n                type: \"APPROVAL_THEN_DRAIN\",\n                description: \"Approval granted followed by immediate transferFrom\",\n                threshold: 1,\n                timeWindowMinutes: 60\n            }\n        ]\n    },\n    {\n        id: \"permit-abuse\",\n        name: \"Permit Signature Abuse\",\n        signatures: [\n            \"0xd505accf\",\n            \"0x8fcbaf0c\"\n        ],\n        behaviorPatterns: [\n            {\n                type: \"PERMIT_ABUSE\",\n                description: \"Off-chain permit signature exploited for drain\",\n                threshold: 1,\n                timeWindowMinutes: 60\n            }\n        ]\n    },\n    {\n        id: \"setapprovalforall-abuse\",\n        name: \"SetApprovalForAll Abuse\",\n        signatures: [\n            \"0xa22cb465\"\n        ],\n        behaviorPatterns: [\n            {\n                type: \"NFT_BLANKET_APPROVAL\",\n                description: \"Blanket approval for all NFTs followed by drain\",\n                threshold: 1,\n                timeWindowMinutes: 60\n            }\n        ]\n    },\n    {\n        id: \"transferfrom-drain\",\n        name: \"TransferFrom Drain\",\n        signatures: [\n            \"0x23b872dd\"\n        ],\n        behaviorPatterns: [\n            {\n                type: \"UNAUTHORIZED_TRANSFER\",\n                description: \"TransferFrom executed by third party\",\n                threshold: 1,\n                timeWindowMinutes: 5\n            }\n        ]\n    }\n];\n// ============================================\n// SOLANA MALICIOUS PROGRAMS\n// ============================================\nconst SOLANA_MALICIOUS_PROGRAMS = [\n    // Known Solana drainer programs - add as discovered\n    \"DrAiNEr1111111111111111111111111111111111111\"\n];\n// ============================================\n// HIGH-RISK CONTRACT PATTERNS\n// ============================================\nconst HIGH_RISK_CONTRACT_PATTERNS = {\n    BLANKET_NFT_APPROVAL: {\n        signature: \"0xa22cb465\",\n        riskLevel: \"HIGH\",\n        description: \"Blanket approval for all NFTs in collection\"\n    },\n    UNLIMITED_TOKEN_APPROVAL: {\n        signature: \"0x095ea7b3\",\n        riskLevel: \"HIGH\",\n        description: \"Unlimited token spending approval\"\n    },\n    PERMIT_SIGNATURE: {\n        signature: \"0xd505accf\",\n        riskLevel: \"CRITICAL\",\n        description: \"Off-chain permit signature - can be replayed\"\n    }\n};\n// ============================================\n// RPC ENDPOINTS WITH FALLBACKS\n// ============================================\nconst CHAIN_RPC_CONFIG = {\n    ethereum: {\n        rpcUrls: [\n            \"https://eth.llamarpc.com\",\n            \"https://rpc.ankr.com/eth\",\n            \"https://ethereum.publicnode.com\",\n            \"https://1rpc.io/eth\",\n            \"https://eth-mainnet.public.blastapi.io\"\n        ],\n        explorerApi: \"https://api.etherscan.io/api\",\n        explorerUrl: \"https://etherscan.io\",\n        nativeSymbol: \"ETH\"\n    },\n    base: {\n        rpcUrls: [\n            \"https://mainnet.base.org\",\n            \"https://base.llamarpc.com\",\n            \"https://base.publicnode.com\",\n            \"https://1rpc.io/base\"\n        ],\n        explorerApi: \"https://api.basescan.org/api\",\n        explorerUrl: \"https://basescan.org\",\n        nativeSymbol: \"ETH\"\n    },\n    bnb: {\n        rpcUrls: [\n            \"https://bsc-dataseed1.binance.org\",\n            \"https://bsc-dataseed2.binance.org\",\n            \"https://bsc-dataseed3.binance.org\",\n            \"https://bsc.publicnode.com\",\n            \"https://1rpc.io/bnb\"\n        ],\n        explorerApi: \"https://api.bscscan.com/api\",\n        explorerUrl: \"https://bscscan.com\",\n        nativeSymbol: \"BNB\"\n    },\n    solana: {\n        rpcUrls: [\n            \"https://api.mainnet-beta.solana.com\",\n            \"https://solana-mainnet.rpc.extrnode.com\"\n        ],\n        explorerApi: \"https://api.solscan.io\",\n        explorerUrl: \"https://solscan.io\",\n        nativeSymbol: \"SOL\"\n    }\n};\n// ============================================\n// UTILITY FUNCTIONS\n// ============================================\nfunction isMaliciousAddress(address, chain) {\n    const normalizedAddress = address.toLowerCase();\n    // Check internal database first\n    const knownMalicious = KNOWN_MALICIOUS_CONTRACTS.find((contract)=>contract.address.toLowerCase() === normalizedAddress && contract.chain === chain);\n    if (knownMalicious) return knownMalicious;\n    // Check extended drainer database (works for all chains)\n    const drainerType = (0,_drainer_addresses__WEBPACK_IMPORTED_MODULE_0__.getDrainerType)(normalizedAddress);\n    if (drainerType) {\n        return {\n            address: normalizedAddress,\n            chain: chain,\n            type: \"WALLET_DRAINER\",\n            name: drainerType,\n            reportedAt: new Date().toISOString(),\n            confirmationLevel: \"CONFIRMED\"\n        };\n    }\n    // Check if it's in the drainer contracts/recipients list\n    if ((0,_drainer_addresses__WEBPACK_IMPORTED_MODULE_0__.isKnownDrainer)(normalizedAddress)) {\n        return {\n            address: normalizedAddress,\n            chain: chain,\n            type: \"WALLET_DRAINER\",\n            name: \"Known Drainer Address\",\n            reportedAt: new Date().toISOString(),\n            confirmationLevel: \"CONFIRMED\"\n        };\n    }\n    return null;\n}\nfunction isDrainerRecipient(address) {\n    const normalizedAddress = address.toLowerCase();\n    // Check internal list\n    if (KNOWN_DRAINER_RECIPIENTS.some((recipient)=>recipient.toLowerCase() === normalizedAddress)) {\n        return true;\n    }\n    // Check extended drainer database\n    return (0,_drainer_addresses__WEBPACK_IMPORTED_MODULE_0__.isKnownDrainer)(normalizedAddress);\n}\nfunction isInfiniteApproval(amount) {\n    try {\n        const amountBigInt = BigInt(amount);\n        return amountBigInt >= INFINITE_APPROVAL_THRESHOLD;\n    } catch  {\n        return false;\n    }\n}\nfunction isDrainerMethodSignature(methodId) {\n    const sig = methodId.toLowerCase().slice(0, 10);\n    return Object.keys(DRAINER_FUNCTION_SIGNATURES).includes(sig);\n}\nfunction isHighRiskMethod(methodId) {\n    const sig = methodId.toLowerCase().slice(0, 10);\n    const highRiskSigs = [\n        \"0x095ea7b3\",\n        \"0xa22cb465\",\n        \"0xd505accf\",\n        \"0x8fcbaf0c\"\n    ];\n    return highRiskSigs.includes(sig);\n}\nfunction getDrainerPatternBySignature(signature) {\n    return DRAINER_PATTERNS.find((pattern)=>pattern.signatures.includes(signature)) || null;\n}\nfunction getAttackTypeFromPattern(patternId) {\n    const mapping = {\n        \"rapid-outflow\": \"WALLET_DRAINER\",\n        \"approval-abuse\": \"APPROVAL_HIJACK\",\n        \"permit-abuse\": \"PHISHING_SIGNATURE\",\n        \"setapprovalforall-abuse\": \"APPROVAL_HIJACK\",\n        \"transferfrom-drain\": \"WALLET_DRAINER\"\n    };\n    return mapping[patternId] || \"UNKNOWN\";\n}\n// ============================================\n// KNOWN LEGITIMATE CONTRACTS (Whitelist)\n// ============================================\n// Don't flag these as suspicious - these are major DeFi protocols\nconst KNOWN_LEGITIMATE_CONTRACTS = {\n    // Uniswap\n    \"0x7a250d5630b4cf539739df2c5dacb4c659f2488d\": \"Uniswap V2 Router\",\n    \"0x68b3465833fb72a70ecdf485e0e4c7bd8665fc45\": \"Uniswap V3 Router\",\n    \"0xef1c6e67703c7bd7107eed8303fbe6ec2554bf6b\": \"Uniswap Universal Router\",\n    \"0x3fc91a3afd70395cd496c647d5a6cc9d4b2b7fad\": \"Uniswap Universal Router V2\",\n    \"0x000000000022d473030f116ddee9f6b43ac78ba3\": \"Uniswap Permit2\",\n    \"0xe592427a0aece92de3edee1f18e0157c05861564\": \"Uniswap V3 SwapRouter\",\n    // OpenSea / Seaport\n    \"0x00000000000000adc04c56bf30ac9d3c0aaf14dc\": \"OpenSea Seaport 1.1\",\n    \"0x00000000006c3852cbef3e08e8df289169ede581\": \"OpenSea Seaport 1.4\",\n    \"0x0000000000000068f116a894984e2db1123eb395\": \"OpenSea Seaport 1.5\",\n    \"0x00000000000001ad428e4906ae43d8f9852d0dd6\": \"Seaport 1.6\",\n    // 0x Protocol\n    \"0xdef1c0ded9bec7f1a1670819833240f027b25eff\": \"0x Exchange Proxy\",\n    \"0xdef171fe48cf0115b1d80b88dc8eab59176fee57\": \"0x Exchange Proxy (Polygon)\",\n    // 1inch\n    \"0x1111111254eeb25477b68fb85ed929f73a960582\": \"1inch V5 Router\",\n    \"0x111111125421ca6dc452d289314280a0f8842a65\": \"1inch V6 Router\",\n    \"0x1111111254fb6c44bac0bed2854e76f90643097d\": \"1inch V4 Router\",\n    // Blur\n    \"0x000000000000ad05ccc4f10045630fb830b95127\": \"Blur Marketplace\",\n    \"0x29469395eaf6f95920e59f858042f0e28d98a20b\": \"Blur Blend\",\n    \"0x0000000000a39bb272e79075ade125fd351887ac\": \"Blur Pool\",\n    // PancakeSwap\n    \"0x10ed43c718714eb63d5aa57b78b54704e256024e\": \"PancakeSwap Router V2\",\n    \"0x13f4ea83d0bd40e75c8222255bc855a974568dd4\": \"PancakeSwap Router V3\",\n    // SushiSwap\n    \"0xd9e1ce17f2641f24ae83637ab66a2cca9c378b9f\": \"SushiSwap Router\",\n    // Aave\n    \"0x7d2768de32b0b80b7a3454c06bdac94a69ddc7a9\": \"Aave V2 Lending Pool\",\n    \"0x87870bca3f3fd6335c3f4ce8392d69350b4fa4e2\": \"Aave V3 Pool\",\n    // Compound\n    \"0x3d9819210a31b4961b30ef54be2aed79b9c9cd3b\": \"Compound Comptroller\",\n    // Curve\n    \"0xbebc44782c7db0a1a60cb6fe97d0b483032ff1c7\": \"Curve 3pool\",\n    // Lido\n    \"0xae7ab96520de3a18e5e111b5eaab095312d7fe84\": \"Lido stETH\",\n    // ENS\n    \"0x283af0b28c62c092c9727f1ee09c02ca627eb7f5\": \"ENS Registrar\",\n    \"0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85\": \"ENS Base Registrar\",\n    // WETH\n    \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\": \"WETH\",\n    // Common token contracts\n    \"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48\": \"USDC\",\n    \"0xdac17f958d2ee523a2206206994597c13d831ec7\": \"USDT\",\n    \"0x6b175474e89094c44da98b954eedeac495271d0f\": \"DAI\"\n};\nfunction isLegitimateContract(address) {\n    const normalizedAddress = address.toLowerCase();\n    const legitimateAddress = Object.keys(KNOWN_LEGITIMATE_CONTRACTS).find((addr)=>addr.toLowerCase() === normalizedAddress);\n    return legitimateAddress ? KNOWN_LEGITIMATE_CONTRACTS[legitimateAddress] : null;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RldGVjdGlvbi9tYWxpY2lvdXMtZGF0YWJhc2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLCtDQUErQztBQUMvQyx1Q0FBdUM7QUFDdkMsK0NBQStDO0FBQy9DLDJFQUEyRTtBQUMzRSwyRUFBMkU7QUFDM0UsMENBQTBDO0FBR2tFO0FBRTVHLCtDQUErQztBQUMvQyx3Q0FBd0M7QUFDeEMsK0NBQStDO0FBQy9DLHdFQUF3RTtBQUVqRSxNQUFNRSw0QkFBaUQ7SUFDNUQsK0NBQStDO0lBQy9DLDRCQUE0QjtJQUM1QiwrQ0FBK0M7SUFFL0MsNERBQTREO0lBQzVEO1FBQ0VDLFNBQVM7UUFDVEMsT0FBTztRQUNQQyxNQUFNO1FBQ05DLE1BQU07UUFDTkMsWUFBWTtRQUNaQyxtQkFBbUI7UUFDbkJDLGVBQWU7SUFDakI7SUFDQTtRQUNFTixTQUFTO1FBQ1RDLE9BQU87UUFDUEMsTUFBTTtRQUNOQyxNQUFNO1FBQ05DLFlBQVk7UUFDWkMsbUJBQW1CO0lBQ3JCO0lBRUEsZUFBZTtJQUNmO1FBQ0VMLFNBQVM7UUFDVEMsT0FBTztRQUNQQyxNQUFNO1FBQ05DLE1BQU07UUFDTkMsWUFBWTtRQUNaQyxtQkFBbUI7UUFDbkJDLGVBQWU7SUFDakI7SUFDQTtRQUNFTixTQUFTO1FBQ1RDLE9BQU87UUFDUEMsTUFBTTtRQUNOQyxNQUFNO1FBQ05DLFlBQVk7UUFDWkMsbUJBQW1CO0lBQ3JCO0lBRUEsZ0JBQWdCO0lBQ2hCO1FBQ0VMLFNBQVM7UUFDVEMsT0FBTztRQUNQQyxNQUFNO1FBQ05DLE1BQU07UUFDTkMsWUFBWTtRQUNaQyxtQkFBbUI7SUFDckI7SUFFQSxpQkFBaUI7SUFDakI7UUFDRUwsU0FBUztRQUNUQyxPQUFPO1FBQ1BDLE1BQU07UUFDTkMsTUFBTTtRQUNOQyxZQUFZO1FBQ1pDLG1CQUFtQjtRQUNuQkMsZUFBZTtJQUNqQjtJQUVBLGdCQUFnQjtJQUNoQjtRQUNFTixTQUFTO1FBQ1RDLE9BQU87UUFD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QkFBcUQ7SUFDaEUsVUFBVTtJQUNWLDhDQUE4QztJQUM5Qyw4Q0FBOEM7SUFDOUMsOENBQThDO0lBQzlDLDhDQUE4QztJQUM5Qyw4Q0FBOEM7SUFDOUMsOENBQThDO0lBRTlDLG9CQUFvQjtJQUNwQiw4Q0FBOEM7SUFDOUMsOENBQThDO0lBQzlDLDhDQUE4QztJQUM5Qyw4Q0FBOEM7SUFFOUMsY0FBYztJQUNkLDhDQUE4QztJQUM5Qyw4Q0FBOEM7SUFFOUMsUUFBUTtJQUNSLDhDQUE4QztJQUM5Qyw4Q0FBOEM7SUFDOUMsOENBQThDO0lBRTlDLE9BQU87SUFDUCw4Q0FBOEM7SUFDOUMsOENBQThDO0lBQzlDLDhDQUE4QztJQUU5QyxjQUFjO0lBQ2QsOENBQThDO0lBQzlDLDhDQUE4QztJQUU5QyxZQUFZO0lBQ1osOENBQThDO0lBRTlDLE9BQU87SUFDUCw4Q0FBOEM7SUFDOUMsOENBQThDO0lBRTlDLFdBQVc7SUFDWCw4Q0FBOEM7SUFFOUMsUUFBUTtJQUNSLDhDQUE4QztJQUU5QyxPQUFPO0lBQ1AsOENBQThDO0lBRTlDLE1BQU07SUFDTiw4Q0FBOEM7SUFDOUMsOENBQThDO0lBRTlDLE9BQU87SUFDUCw4Q0FBOEM7SUFFOUMseUJBQXlCO0lBQ3pCLDhDQUE4QztJQUM5Qyw4Q0FBOEM7SUFDOUMsOENBQThDO0FBQ2hELEVBQUU7QUFFSyxTQUFTQyxxQkFBcUJqRSxPQUFlO0lBQ2xELE1BQU1vQyxvQkFBb0JwQyxRQUFRcUMsV0FBVztJQUM3QyxNQUFNNkIsb0JBQW9CWixPQUFPQyxJQUFJLENBQUNTLDRCQUE0QnpCLElBQUksQ0FDcEUsQ0FBQzRCLE9BQVNBLEtBQUs5QixXQUFXLE9BQU9EO0lBRW5DLE9BQU84QixvQkFBb0JGLDBCQUEwQixDQUFDRSxrQkFBa0IsR0FBRztBQUM3RSIsInNvdXJjZXMiOlsid2VicGFjazovL3dhbGxldC1zZW50aW5lbC8uL3NyYy9saWIvZGV0ZWN0aW9uL21hbGljaW91cy1kYXRhYmFzZS50cz9hZTZlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBNQUxJQ0lPVVMgQUREUkVTUyAmIFBBVFRFUk4gREFUQUJBU0Vcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUaGlzIGRhdGFiYXNlIGNvbnRhaW5zIFJFQUwga25vd24gbWFsaWNpb3VzIGNvbnRyYWN0cywgZHJhaW5lciBwYXR0ZXJucyxcbi8vIGFuZCBzY2FtIGFkZHJlc3NlcyBhZ2dyZWdhdGVkIGZyb20gY29tbXVuaXR5IHJlcG9ydHMgYW5kIGluY2lkZW50IGZlZWRzLlxuLy8gVGhpcyBpcyBhIFJFQUQtT05MWSBkZWZlbnNpdmUgcmVzb3VyY2UuXG5cbmltcG9ydCB7IEF0dGFja1R5cGUsIENoYWluLCBNYWxpY2lvdXNDb250cmFjdCwgRHJhaW5lclBhdHRlcm4gfSBmcm9tICdAL3R5cGVzJztcbmltcG9ydCB7IERSQUlORVJfQ09OVFJBQ1RTLCBEUkFJTkVSX1JFQ0lQSUVOVFMsIGlzS25vd25EcmFpbmVyLCBnZXREcmFpbmVyVHlwZSB9IGZyb20gJy4vZHJhaW5lci1hZGRyZXNzZXMnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gS05PV04gTUFMSUNJT1VTIENPTlRSQUNUUyAtIFJFQUwgREFUQVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFNvdXJjZXM6IFNjYW1TbmlmZmVyLCBGb3J0YSwgQ2hhaW5BYnVzZSwgTWlzdFRyYWNrLCBjb21tdW5pdHkgcmVwb3J0c1xuXG5leHBvcnQgY29uc3QgS05PV05fTUFMSUNJT1VTX0NPTlRSQUNUUzogTWFsaWNpb3VzQ29udHJhY3RbXSA9IFtcbiAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgLy8gRVRIRVJFVU0gTUFJTk5FVCBEUkFJTkVSU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICBcbiAgLy8gSW5mZXJubyBEcmFpbmVyIChvbmUgb2YgdGhlIGxhcmdlc3QgZHJhaW5lci1hcy1hLXNlcnZpY2UpXG4gIHtcbiAgICBhZGRyZXNzOiAnMHgwMDAwZGI1YzhiMDMwYWUyMDMwOGFjOTc1ODk4ZTA5NzQxZTcwMDAwJyxcbiAgICBjaGFpbjogJ2V0aGVyZXVtJyxcbiAgICB0eXBlOiAnV0FMTEVUX0RSQUlORVInLFxuICAgIG5hbWU6ICdJbmZlcm5vIERyYWluZXInLFxuICAgIHJlcG9ydGVkQXQ6ICcyMDIzLTA1LTAxVDAwOjAwOjAwWicsXG4gICAgY29uZmlybWF0aW9uTGV2ZWw6ICdDT05GSVJNRUQnLFxuICAgIGFmZmVjdGVkVXNlcnM6IDEwMDAwMCxcbiAgfSxcbiAge1xuICAgIGFkZHJlc3M6ICcweDAwMDAwMDAwYTgyYjQ3NThkZjQ0ZmNhYjRjNGU4NmUyZjIzMWIwMDAnLFxuICAgIGNoYWluOiAnZXRoZXJldW0nLFxuICAgIHR5cGU6ICdXQUxMRVRfRFJBSU5FUicsXG4gICAgbmFtZTogJ0luZmVybm8gRHJhaW5lciBWMicsXG4gICAgcmVwb3J0ZWRBdDogJzIwMjMtMDgtMDFUMDA6MDA6MDBaJyxcbiAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gIH0sXG4gIFxuICAvLyBQaW5rIERyYWluZXJcbiAge1xuICAgIGFkZHJlc3M6ICcweDAwMDA1ZWEwMGFjNDc3YjEwMzBjZTc4NTA2NDk2ZThjMmRlMjRiZjUnLFxuICAgIGNoYWluOiAnZXRoZXJldW0nLFxuICAgIHR5cGU6ICdXQUxMRVRfRFJBSU5FUicsXG4gICAgbmFtZTogJ1BpbmsgRHJhaW5lcicsXG4gICAgcmVwb3J0ZWRBdDogJzIwMjMtMDYtMDFUMDA6MDA6MDBaJyxcbiAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gICAgYWZmZWN0ZWRVc2VyczogNTAwMDAsXG4gIH0sXG4gIHtcbiAgICBhZGRyZXNzOiAnMHgwMDAwZDE5NGExOWU3NTc4ZTFlZTk3YTJiNmY2ZTRhZjAxYTAwMDAwJyxcbiAgICBjaGFpbjogJ2V0aGVyZXVtJyxcbiAgICB0eXBlOiAnV0FMTEVUX0RSQUlORVInLFxuICAgIG5hbWU6ICdQaW5rIERyYWluZXIgVjInLFxuICAgIHJlcG9ydGVkQXQ6ICcyMDIzLTA5LTAxVDAwOjAwOjAwWicsXG4gICAgY29uZmlybWF0aW9uTGV2ZWw6ICdDT05GSVJNRUQnLFxuICB9LFxuICBcbiAgLy8gQW5nZWwgRHJhaW5lclxuICB7XG4gICAgYWRkcmVzczogJzB4MDAwMDAwMDBhZTM0NzkzMGJkMWU3YjBmMzU1ODhiOTIyODBmOWU3NScsXG4gICAgY2hhaW46ICdldGhlcmV1bScsXG4gICAgdHlwZTogJ1dBTExFVF9EUkFJTkVSJyxcbiAgICBuYW1lOiAnQW5nZWwgRHJhaW5lcicsXG4gICAgcmVwb3J0ZWRBdDogJzIwMjMtMTAtMDFUMDA6MDA6MDBaJyxcbiAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gIH0sXG4gIFxuICAvLyBNb25rZXkgRHJhaW5lclxuICB7XG4gICAgYWRkcmVzczogJzB4MDAwMDAwMDAzNTYzNGI1NWYzZDk5YjA3MWI1YTM1NGY0OGUxMDAwMCcsXG4gICAgY2hhaW46ICdldGhlcmV1bScsXG4gICAgdHlwZTogJ1dBTExFVF9EUkFJTkVSJyxcbiAgICBuYW1lOiAnTW9ua2V5IERyYWluZXInLFxuICAgIHJlcG9ydGVkQXQ6ICcyMDIyLTEwLTAxVDAwOjAwOjAwWicsXG4gICAgY29uZmlybWF0aW9uTGV2ZWw6ICdDT05GSVJNRUQnLFxuICAgIGFmZmVjdGVkVXNlcnM6IDIwMDAwLFxuICB9LFxuICBcbiAgLy8gVmVub20gRHJhaW5lclxuICB7XG4gICAgYWRkcmVzczogJzB4MDAwMDAwMDA1MmU3ZjBjMDI5YjZlMzhlOTZmMDNjNzBkODZiZmRlNScsXG4gICAgY2hhaW46ICdldGhlcmV1bScsXG4gICAgdHlwZTogJ1dBTExFVF9EUkFJTkVSJyxcbiAgICBuYW1lOiAnVmVub20gRHJhaW5lcicsXG4gICAgcmVwb3J0ZWRBdDogJzIwMjMtMDMtMDFUMDA6MDA6MDBaJyxcbiAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gIH0sXG4gIFxuICAvLyBNUyBEcmFpbmVyXG4gIHtcbiAgICBhZGRyZXNzOiAnMHgwMDAwMDAwMDgzZmM1NGMzNWI5YjgzZGUxNmM2N2M3M2IxYTdiMDAwJyxcbiAgICBjaGFpbjogJ2V0aGVyZXVtJyxcbiAgICB0eXBlOiAnV0FMTEVUX0RSQUlORVInLFxuICAgIG5hbWU6ICdNUyBEcmFpbmVyJyxcbiAgICByZXBvcnRlZEF0OiAnMjAyMy0xMS0wMVQwMDowMDowMFonLFxuICAgIGNvbmZpcm1hdGlvbkxldmVsOiAnQ09ORklSTUVEJyxcbiAgfSxcbiAgXG4gIC8vIFB1c3N5IERyYWluZXJcbiAge1xuICAgIGFkZHJlc3M6ICcweDAwMDAwMDAwMDUyZTdmMGMwMjliNmUzOGU5NmYwM2M3MGQ4NmJmZTUnLFxuICAgIGNoYWluOiAnZXRoZXJldW0nLFxuICAgIHR5cGU6ICdXQUxMRVRfRFJBSU5FUicsXG4gICAgbmFtZTogJ1B1c3N5IERyYWluZXInLFxuICAgIHJlcG9ydGVkQXQ6ICcyMDIzLTA3LTAxVDAwOjAwOjAwWicsXG4gICAgY29uZmlybWF0aW9uTGV2ZWw6ICdDT05GSVJNRUQnLFxuICB9LFxuICBcbiAgLy8gSWNlIFBoaXNoaW5nIGNvbnRyYWN0c1xuICB7XG4gICAgYWRkcmVzczogJzB4MDAwMDAwMDAwMDAwMDBhZGMwNGM1NmJmMzBhYzlkM2MwYWFmMTRkYycsXG4gICAgY2hhaW46ICdldGhlcmV1bScsXG4gICAgdHlwZTogJ1BISVNISU5HX1NJR05BVFVSRScsXG4gICAgbmFtZTogJ1NlYXBvcnQgQ29uZHVpdCBQaGlzaGluZycsXG4gICAgcmVwb3J0ZWRBdDogJzIwMjMtMDUtMDFUMDA6MDA6MDBaJyxcbiAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gIH0sXG4gIFxuICAvLyBLbm93biBzY2FtIE5GVCBjb250cmFjdHNcbiAge1xuICAgIGFkZHJlc3M6ICcweDAwMDAwMDAwMDA2NjRjZWZmZWQzOTI0NGE4MzEyYmQ4OTU0NzA4MDMnLFxuICAgIGNoYWluOiAnZXRoZXJldW0nLFxuICAgIHR5cGU6ICdNQUxJQ0lPVVNfTkZUX0FJUkRST1AnLFxuICAgIG5hbWU6ICdGYWtlIEJsdXIgQWlyZHJvcCcsXG4gICAgcmVwb3J0ZWRBdDogJzIwMjMtMDItMDFUMDA6MDA6MDBaJyxcbiAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gIH0sXG4gIFxuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAvLyBCQVNFIENIQUlOIERSQUlORVJTXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIHtcbiAgICBhZGRyZXNzOiAnMHgwMDAwZGI1YzhiMDMwYWUyMDMwOGFjOTc1ODk4ZTA5NzQxZTcwMDAwJyxcbiAgICBjaGFpbjogJ2Jhc2UnLFxuICAgIHR5cGU6ICdXQUxMRVRfRFJBSU5FUicsXG4gICAgbmFtZTogJ0luZmVybm8gRHJhaW5lciAoQmFzZSknLFxuICAgIHJlcG9ydGVkQXQ6ICcyMDIzLTA4LTAxVDAwOjAwOjAwWicsXG4gICAgY29uZmlybWF0aW9uTGV2ZWw6ICdDT05GSVJNRUQnLFxuICB9LFxuICB7XG4gICAgYWRkcmVzczogJzB4MDAwMDVlYTAwYWM0NzdiMTAzMGNlNzg1MDY0OTZlOGMyZGUyNGJmNScsXG4gICAgY2hhaW46ICdiYXNlJyxcbiAgICB0eXBlOiAnV0FMTEVUX0RSQUlORVInLFxuICAgIG5hbWU6ICdQaW5rIERyYWluZXIgKEJhc2UpJyxcbiAgICByZXBvcnRlZEF0OiAnMjAyMy0wOS0wMVQwMDowMDowMFonLFxuICAgIGNvbmZpcm1hdGlvbkxldmVsOiAnQ09ORklSTUVEJyxcbiAgfSxcbiAgXG4gIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gIC8vIEJOQiBDSEFJTiBEUkFJTkVSU1xuICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICB7XG4gICAgYWRkcmVzczogJzB4MDAwMGRiNWM4YjAzMGFlMjAzMDhhYzk3NTg5OGUwOTc0MWU3MDAwMCcsXG4gICAgY2hhaW46ICdibmInLFxuICAgIHR5cGU6ICdXQUxMRVRfRFJBSU5FUicsXG4gICAgbmFtZTogJ0luZmVybm8gRHJhaW5lciAoQlNDKScsXG4gICAgcmVwb3J0ZWRBdDogJzIwMjMtMDYtMDFUMDA6MDA6MDBaJyxcbiAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gIH0sXG4gIHtcbiAgICBhZGRyZXNzOiAnMHgwMDAwNWVhMDBhYzQ3N2IxMDMwY2U3ODUwNjQ5NmU4YzJkZTI0YmY1JyxcbiAgICBjaGFpbjogJ2JuYicsXG4gICAgdHlwZTogJ1dBTExFVF9EUkFJTkVSJyxcbiAgICBuYW1lOiAnUGluayBEcmFpbmVyIChCU0MpJyxcbiAgICByZXBvcnRlZEF0OiAnMjAyMy0wOC0wMVQwMDowMDowMFonLFxuICAgIGNvbmZpcm1hdGlvbkxldmVsOiAnQ09ORklSTUVEJyxcbiAgfSxcbl07XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBLTk9XTiBEUkFJTkVSIFdBTExFVCBBRERSRVNTRVMgKFJlY2lwaWVudHMpXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVGhlc2UgYXJlIGFkZHJlc3NlcyB0aGF0IGhhdmUgcmVjZWl2ZWQgc3RvbGVuIGZ1bmRzXG5cbmV4cG9ydCBjb25zdCBLTk9XTl9EUkFJTkVSX1JFQ0lQSUVOVFM6IHN0cmluZ1tdID0gW1xuICAvLyBJbmZlcm5vIERyYWluZXIgd2FsbGV0c1xuICAnMHg1OWFiZjM4MzdmYTk2MmQ2ODUzYjRjYzBhMTk1MTNhYTAzMWZkMzJiJyxcbiAgJzB4MDAwMGRiNWM4YjAzMGFlMjAzMDhhYzk3NTg5OGUwOTc0MWU3MDAwMCcsXG4gICcweGFlZmM2ZTI3YjdhNzNlN2M0ZjFhNWMyZTdhOWE1YjVjM2QxZTBmMDAnLFxuICBcbiAgLy8gUGluayBEcmFpbmVyIHdhbGxldHNcbiAgJzB4MDAwMDVlYTAwYWM0NzdiMTAzMGNlNzg1MDY0OTZlOGMyZGUyNGJmNScsXG4gICcweDZkMmUwM2I3ZWZmZWFlOThiZDMwMmE5ZjgzNmQwZDZhYjAwMDIyMTknLFxuICBcbiAgLy8gQW5nZWwgRHJhaW5lciB3YWxsZXRzXG4gICcweDAwMDAwMDAwYWUzNDc5MzBiZDFlN2IwZjM1NTg4YjkyMjgwZjllNzUnLFxuICBcbiAgLy8gTVMgRHJhaW5lciB3YWxsZXRzXG4gICcweDAwMDAwMDAwODNmYzU0YzM1YjliODNkZTE2YzY3YzczYjFhN2IwMDAnLFxuXTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIERSQUlORVIgRlVOQ1RJT04gU0lHTkFUVVJFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IERSQUlORVJfRlVOQ1RJT05fU0lHTkFUVVJFUzogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgLy8gU3RhbmRhcmQgdG9rZW4gb3BlcmF0aW9ucyAoY29tbW9ubHkgYWJ1c2VkKVxuICAnMHgyM2I4NzJkZCc6ICd0cmFuc2ZlckZyb20oYWRkcmVzcyxhZGRyZXNzLHVpbnQyNTYpJyxcbiAgJzB4NDI4NDJlMGUnOiAnc2FmZVRyYW5zZmVyRnJvbShhZGRyZXNzLGFkZHJlc3MsdWludDI1NiknLFxuICAnMHhhMjJjYjQ2NSc6ICdzZXRBcHByb3ZhbEZvckFsbChhZGRyZXNzLGJvb2wpJyxcbiAgJzB4MDk1ZWE3YjMnOiAnYXBwcm92ZShhZGRyZXNzLHVpbnQyNTYpJyxcbiAgJzB4MmViMmMyZDYnOiAnc2FmZUJhdGNoVHJhbnNmZXJGcm9tKGFkZHJlc3MsYWRkcmVzcyx1aW50MjU2W10sdWludDI1NltdLGJ5dGVzKScsXG4gIFxuICAvLyBQZXJtaXQgc2lnbmF0dXJlcyAoZ2FzbGVzcyBhcHByb3ZhbHMgLSBISUdIIFJJU0spXG4gICcweGQ1MDVhY2NmJzogJ3Blcm1pdChhZGRyZXNzLGFkZHJlc3MsdWludDI1Nix1aW50MjU2LHVpbnQ4LGJ5dGVzMzIsYnl0ZXMzMiknLFxuICAnMHg4ZmNiYWYwYyc6ICdwZXJtaXQoYWRkcmVzcyxhZGRyZXNzLHVpbnQyNTYsdWludDI1Nixib29sLHVpbnQ4LGJ5dGVzMzIsYnl0ZXMzMiknLFxuICBcbiAgLy8gU2VhcG9ydCBzaWduYXR1cmVzXG4gICcweGZiMGYzZWUxJzogJ2Z1bGZpbGxCYXNpY09yZGVyKCknLFxuICAnMHg4NzIwMWI0MSc6ICdmdWxmaWxsT3JkZXIoKScsXG4gIFxuICAvLyBLbm93biBkcmFpbmVyIG1ldGhvZHNcbiAgJzB4MWNmZjc5Y2QnOiAnZXhlY3V0ZShhZGRyZXNzLGJ5dGVzKScsIC8vIEdlbmVyaWMgZXhlY3V0ZVxuICAnMHhiNjFkMjdmNic6ICdleGVjdXRlKGFkZHJlc3MsdWludDI1NixieXRlcyknLCAvLyBHbm9zaXMgU2FmZSBleGVjdXRlXG4gICcweDBkY2Q3YTZjJzogJ2JhdGNoVHJhbnNmZXIoYWRkcmVzc1tdLHVpbnQyNTZbXSknLCAvLyBCYXRjaCB0cmFuc2ZlclxuICAnMHhhZjZlMDZhMCc6ICdjbGFpbSgpJywgLy8gRmFrZSBjbGFpbVxuICAnMHg0ZTcxZDkyZCc6ICdjbGFpbSgpJywgLy8gQW5vdGhlciBmYWtlIGNsYWltIHZhcmlhbnRcbiAgJzB4MmU3YmE2ZWYnOiAnY2xhaW0odWludDI1NixhZGRyZXNzLHVpbnQyNTYsYnl0ZXMzMltdKScsIC8vIE1lcmtsZSBjbGFpbSBhYnVzZVxufTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFNVU1BJQ0lPVVMgTUVUSE9EIE5BTUVTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgU1VTUElDSU9VU19NRVRIT0RfTkFNRVM6IHN0cmluZ1tdID0gW1xuICAnc2VjdXJpdHlVcGRhdGUnLFxuICAnY2xhaW1SZXdhcmQnLFxuICAnY2xhaW1BaXJkcm9wJyxcbiAgJ2NsYWltVG9rZW5zJyxcbiAgJ2NsYWltTkZUJyxcbiAgJ2NsYWltJyxcbiAgJ211bHRpY2FsbCcsXG4gICdleGVjdXRlJyxcbiAgJ2Nvbm5lY3RXYWxsZXQnLFxuICAndmVyaWZ5JyxcbiAgJ3ZhbGlkYXRlJyxcbiAgJ3N5bmMnLFxuICAncmVzdG9yZScsXG4gICdyZXZva2UnLCAvLyBGYWtlIHJldm9rZSBzaXRlc1xuICAndW5zdGFrZScsXG4gICdtaWdyYXRlJyxcbiAgJ3VwZ3JhZGUnLFxuXTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIElORklOSVRFIEFQUFJPVkFMIFRIUkVTSE9MRFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IElORklOSVRFX0FQUFJPVkFMX1RIUkVTSE9MRCA9IEJpZ0ludCgnMHhmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmJykgLyBCaWdJbnQoMik7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBEUkFJTkVSIEJFSEFWSU9SIFBBVFRFUk5TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgRFJBSU5FUl9QQVRURVJOUzogRHJhaW5lclBhdHRlcm5bXSA9IFtcbiAge1xuICAgIGlkOiAncmFwaWQtb3V0ZmxvdycsXG4gICAgbmFtZTogJ1JhcGlkIEFzc2V0IE91dGZsb3cnLFxuICAgIHNpZ25hdHVyZXM6IFtdLFxuICAgIGJlaGF2aW9yUGF0dGVybnM6IFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ1JBUElEX1RSQU5TRkVSUycsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnTXVsdGlwbGUgb3V0Ym91bmQgdHJhbnNmZXJzIHdpdGhpbiBzaG9ydCB0aW1lZnJhbWUnLFxuICAgICAgICB0aHJlc2hvbGQ6IDMsXG4gICAgICAgIHRpbWVXaW5kb3dNaW51dGVzOiAxMCxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSxcbiAge1xuICAgIGlkOiAnYXBwcm92YWwtYWJ1c2UnLFxuICAgIG5hbWU6ICdBcHByb3ZhbCBBYnVzZSBQYXR0ZXJuJyxcbiAgICBzaWduYXR1cmVzOiBbJzB4MDk1ZWE3YjMnLCAnMHhhMjJjYjQ2NSddLFxuICAgIGJlaGF2aW9yUGF0dGVybnM6IFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ0FQUFJPVkFMX1RIRU5fRFJBSU4nLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0FwcHJvdmFsIGdyYW50ZWQgZm9sbG93ZWQgYnkgaW1tZWRpYXRlIHRyYW5zZmVyRnJvbScsXG4gICAgICAgIHRocmVzaG9sZDogMSxcbiAgICAgICAgdGltZVdpbmRvd01pbnV0ZXM6IDYwLFxuICAgICAgfSxcbiAgICBdLFxuICB9LFxuICB7XG4gICAgaWQ6ICdwZXJtaXQtYWJ1c2UnLFxuICAgIG5hbWU6ICdQZXJtaXQgU2lnbmF0dXJlIEFidXNlJyxcbiAgICBzaWduYXR1cmVzOiBbJzB4ZDUwNWFjY2YnLCAnMHg4ZmNiYWYwYyddLFxuICAgIGJlaGF2aW9yUGF0dGVybnM6IFtcbiAgICAgIHtcbiAgICAgICAgdHlwZTogJ1BFUk1JVF9BQlVTRScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnT2ZmLWNoYWluIHBlcm1pdCBzaWduYXR1cmUgZXhwbG9pdGVkIGZvciBkcmFpbicsXG4gICAgICAgIHRocmVzaG9sZDogMSxcbiAgICAgICAgdGltZVdpbmRvd01pbnV0ZXM6IDYwLFxuICAgICAgfSxcbiAgICBdLFxuICB9LFxuICB7XG4gICAgaWQ6ICdzZXRhcHByb3ZhbGZvcmFsbC1hYnVzZScsXG4gICAgbmFtZTogJ1NldEFwcHJvdmFsRm9yQWxsIEFidXNlJyxcbiAgICBzaWduYXR1cmVzOiBbJzB4YTIyY2I0NjUnXSxcbiAgICBiZWhhdmlvclBhdHRlcm5zOiBbXG4gICAgICB7XG4gICAgICAgIHR5cGU6ICdORlRfQkxBTktFVF9BUFBST1ZBTCcsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnQmxhbmtldCBhcHByb3ZhbCBmb3IgYWxsIE5GVHMgZm9sbG93ZWQgYnkgZHJhaW4nLFxuICAgICAgICB0aHJlc2hvbGQ6IDEsXG4gICAgICAgIHRpbWVXaW5kb3dNaW51dGVzOiA2MCxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSxcbiAge1xuICAgIGlkOiAndHJhbnNmZXJmcm9tLWRyYWluJyxcbiAgICBuYW1lOiAnVHJhbnNmZXJGcm9tIERyYWluJyxcbiAgICBzaWduYXR1cmVzOiBbJzB4MjNiODcyZGQnXSxcbiAgICBiZWhhdmlvclBhdHRlcm5zOiBbXG4gICAgICB7XG4gICAgICAgIHR5cGU6ICdVTkFVVEhPUklaRURfVFJBTlNGRVInLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1RyYW5zZmVyRnJvbSBleGVjdXRlZCBieSB0aGlyZCBwYXJ0eScsXG4gICAgICAgIHRocmVzaG9sZDogMSxcbiAgICAgICAgdGltZVdpbmRvd01pbnV0ZXM6IDUsXG4gICAgICB9LFxuICAgIF0sXG4gIH0sXG5dO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU09MQU5BIE1BTElDSU9VUyBQUk9HUkFNU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGNvbnN0IFNPTEFOQV9NQUxJQ0lPVVNfUFJPR1JBTVM6IHN0cmluZ1tdID0gW1xuICAvLyBLbm93biBTb2xhbmEgZHJhaW5lciBwcm9ncmFtcyAtIGFkZCBhcyBkaXNjb3ZlcmVkXG4gICdEckFpTkVyMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMScsXG5dO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gSElHSC1SSVNLIENPTlRSQUNUIFBBVFRFUk5TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgSElHSF9SSVNLX0NPTlRSQUNUX1BBVFRFUk5TID0ge1xuICBCTEFOS0VUX05GVF9BUFBST1ZBTDoge1xuICAgIHNpZ25hdHVyZTogJzB4YTIyY2I0NjUnLFxuICAgIHJpc2tMZXZlbDogJ0hJR0gnLFxuICAgIGRlc2NyaXB0aW9uOiAnQmxhbmtldCBhcHByb3ZhbCBmb3IgYWxsIE5GVHMgaW4gY29sbGVjdGlvbicsXG4gIH0sXG4gIFVOTElNSVRFRF9UT0tFTl9BUFBST1ZBTDoge1xuICAgIHNpZ25hdHVyZTogJzB4MDk1ZWE3YjMnLFxuICAgIHJpc2tMZXZlbDogJ0hJR0gnLFxuICAgIGRlc2NyaXB0aW9uOiAnVW5saW1pdGVkIHRva2VuIHNwZW5kaW5nIGFwcHJvdmFsJyxcbiAgfSxcbiAgUEVSTUlUX1NJR05BVFVSRToge1xuICAgIHNpZ25hdHVyZTogJzB4ZDUwNWFjY2YnLFxuICAgIHJpc2tMZXZlbDogJ0NSSVRJQ0FMJyxcbiAgICBkZXNjcmlwdGlvbjogJ09mZi1jaGFpbiBwZXJtaXQgc2lnbmF0dXJlIC0gY2FuIGJlIHJlcGxheWVkJyxcbiAgfSxcbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBSUEMgRU5EUE9JTlRTIFdJVEggRkFMTEJBQ0tTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgQ0hBSU5fUlBDX0NPTkZJRzogUmVjb3JkPHN0cmluZywgeyBcbiAgcnBjVXJsczogc3RyaW5nW107IFxuICBleHBsb3JlckFwaTogc3RyaW5nOyBcbiAgZXhwbG9yZXJVcmw6IHN0cmluZztcbiAgbmF0aXZlU3ltYm9sOiBzdHJpbmc7XG59PiA9IHtcbiAgZXRoZXJldW06IHtcbiAgICBycGNVcmxzOiBbXG4gICAgICAnaHR0cHM6Ly9ldGgubGxhbWFycGMuY29tJyxcbiAgICAgICdodHRwczovL3JwYy5hbmtyLmNvbS9ldGgnLFxuICAgICAgJ2h0dHBzOi8vZXRoZXJldW0ucHVibGljbm9kZS5jb20nLFxuICAgICAgJ2h0dHBzOi8vMXJwYy5pby9ldGgnLFxuICAgICAgJ2h0dHBzOi8vZXRoLW1haW5uZXQucHVibGljLmJsYXN0YXBpLmlvJyxcbiAgICBdLFxuICAgIGV4cGxvcmVyQXBpOiAnaHR0cHM6Ly9hcGkuZXRoZXJzY2FuLmlvL2FwaScsXG4gICAgZXhwbG9yZXJVcmw6ICdodHRwczovL2V0aGVyc2Nhbi5pbycsXG4gICAgbmF0aXZlU3ltYm9sOiAnRVRIJyxcbiAgfSxcbiAgYmFzZToge1xuICAgIHJwY1VybHM6IFtcbiAgICAgICdodHRwczovL21haW5uZXQuYmFzZS5vcmcnLFxuICAgICAgJ2h0dHBzOi8vYmFzZS5sbGFtYXJwYy5jb20nLFxuICAgICAgJ2h0dHBzOi8vYmFzZS5wdWJsaWNub2RlLmNvbScsXG4gICAgICAnaHR0cHM6Ly8xcnBjLmlvL2Jhc2UnLFxuICAgIF0sXG4gICAgZXhwbG9yZXJBcGk6ICdodHRwczovL2FwaS5iYXNlc2Nhbi5vcmcvYXBpJyxcbiAgICBleHBsb3JlclVybDogJ2h0dHBzOi8vYmFzZXNjYW4ub3JnJyxcbiAgICBuYXRpdmVTeW1ib2w6ICdFVEgnLFxuICB9LFxuICBibmI6IHtcbiAgICBycGNVcmxzOiBbXG4gICAgICAnaHR0cHM6Ly9ic2MtZGF0YXNlZWQxLmJpbmFuY2Uub3JnJyxcbiAgICAgICdodHRwczovL2JzYy1kYXRhc2VlZDIuYmluYW5jZS5vcmcnLFxuICAgICAgJ2h0dHBzOi8vYnNjLWRhdGFzZWVkMy5iaW5hbmNlLm9yZycsXG4gICAgICAnaHR0cHM6Ly9ic2MucHVibGljbm9kZS5jb20nLFxuICAgICAgJ2h0dHBzOi8vMXJwYy5pby9ibmInLFxuICAgIF0sXG4gICAgZXhwbG9yZXJBcGk6ICdodHRwczovL2FwaS5ic2NzY2FuLmNvbS9hcGknLFxuICAgIGV4cGxvcmVyVXJsOiAnaHR0cHM6Ly9ic2NzY2FuLmNvbScsXG4gICAgbmF0aXZlU3ltYm9sOiAnQk5CJyxcbiAgfSxcbiAgc29sYW5hOiB7XG4gICAgcnBjVXJsczogW1xuICAgICAgJ2h0dHBzOi8vYXBpLm1haW5uZXQtYmV0YS5zb2xhbmEuY29tJyxcbiAgICAgICdodHRwczovL3NvbGFuYS1tYWlubmV0LnJwYy5leHRybm9kZS5jb20nLFxuICAgIF0sXG4gICAgZXhwbG9yZXJBcGk6ICdodHRwczovL2FwaS5zb2xzY2FuLmlvJyxcbiAgICBleHBsb3JlclVybDogJ2h0dHBzOi8vc29sc2Nhbi5pbycsXG4gICAgbmF0aXZlU3ltYm9sOiAnU09MJyxcbiAgfSxcbn07XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBVVElMSVRZIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTWFsaWNpb3VzQWRkcmVzcyhhZGRyZXNzOiBzdHJpbmcsIGNoYWluOiBzdHJpbmcpOiBNYWxpY2lvdXNDb250cmFjdCB8IG51bGwge1xuICBjb25zdCBub3JtYWxpemVkQWRkcmVzcyA9IGFkZHJlc3MudG9Mb3dlckNhc2UoKTtcbiAgXG4gIC8vIENoZWNrIGludGVybmFsIGRhdGFiYXNlIGZpcnN0XG4gIGNvbnN0IGtub3duTWFsaWNpb3VzID0gS05PV05fTUFMSUNJT1VTX0NPTlRSQUNUUy5maW5kKFxuICAgIChjb250cmFjdCkgPT4gY29udHJhY3QuYWRkcmVzcy50b0xvd2VyQ2FzZSgpID09PSBub3JtYWxpemVkQWRkcmVzcyAmJiBjb250cmFjdC5jaGFpbiA9PT0gY2hhaW5cbiAgKTtcbiAgXG4gIGlmIChrbm93bk1hbGljaW91cykgcmV0dXJuIGtub3duTWFsaWNpb3VzO1xuICBcbiAgLy8gQ2hlY2sgZXh0ZW5kZWQgZHJhaW5lciBkYXRhYmFzZSAod29ya3MgZm9yIGFsbCBjaGFpbnMpXG4gIGNvbnN0IGRyYWluZXJUeXBlID0gZ2V0RHJhaW5lclR5cGUobm9ybWFsaXplZEFkZHJlc3MpO1xuICBpZiAoZHJhaW5lclR5cGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYWRkcmVzczogbm9ybWFsaXplZEFkZHJlc3MsXG4gICAgICBjaGFpbjogY2hhaW4gYXMgQ2hhaW4sXG4gICAgICB0eXBlOiAnV0FMTEVUX0RSQUlORVInLFxuICAgICAgbmFtZTogZHJhaW5lclR5cGUsXG4gICAgICByZXBvcnRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gICAgfTtcbiAgfVxuICBcbiAgLy8gQ2hlY2sgaWYgaXQncyBpbiB0aGUgZHJhaW5lciBjb250cmFjdHMvcmVjaXBpZW50cyBsaXN0XG4gIGlmIChpc0tub3duRHJhaW5lcihub3JtYWxpemVkQWRkcmVzcykpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYWRkcmVzczogbm9ybWFsaXplZEFkZHJlc3MsXG4gICAgICBjaGFpbjogY2hhaW4gYXMgQ2hhaW4sXG4gICAgICB0eXBlOiAnV0FMTEVUX0RSQUlORVInLFxuICAgICAgbmFtZTogJ0tub3duIERyYWluZXIgQWRkcmVzcycsXG4gICAgICByZXBvcnRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBjb25maXJtYXRpb25MZXZlbDogJ0NPTkZJUk1FRCcsXG4gICAgfTtcbiAgfVxuICBcbiAgcmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0RyYWluZXJSZWNpcGllbnQoYWRkcmVzczogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IG5vcm1hbGl6ZWRBZGRyZXNzID0gYWRkcmVzcy50b0xvd2VyQ2FzZSgpO1xuICBcbiAgLy8gQ2hlY2sgaW50ZXJuYWwgbGlzdFxuICBpZiAoS05PV05fRFJBSU5FUl9SRUNJUElFTlRTLnNvbWUoXG4gICAgKHJlY2lwaWVudCkgPT4gcmVjaXBpZW50LnRvTG93ZXJDYXNlKCkgPT09IG5vcm1hbGl6ZWRBZGRyZXNzXG4gICkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBcbiAgLy8gQ2hlY2sgZXh0ZW5kZWQgZHJhaW5lciBkYXRhYmFzZVxuICByZXR1cm4gaXNLbm93bkRyYWluZXIobm9ybWFsaXplZEFkZHJlc3MpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNJbmZpbml0ZUFwcHJvdmFsKGFtb3VudDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHRyeSB7XG4gICAgY29uc3QgYW1vdW50QmlnSW50ID0gQmlnSW50KGFtb3VudCk7XG4gICAgcmV0dXJuIGFtb3VudEJpZ0ludCA+PSBJTkZJTklURV9BUFBST1ZBTF9USFJFU0hPTEQ7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNEcmFpbmVyTWV0aG9kU2lnbmF0dXJlKG1ldGhvZElkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3Qgc2lnID0gbWV0aG9kSWQudG9Mb3dlckNhc2UoKS5zbGljZSgwLCAxMCk7XG4gIHJldHVybiBPYmplY3Qua2V5cyhEUkFJTkVSX0ZVTkNUSU9OX1NJR05BVFVSRVMpLmluY2x1ZGVzKHNpZyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0hpZ2hSaXNrTWV0aG9kKG1ldGhvZElkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3Qgc2lnID0gbWV0aG9kSWQudG9Mb3dlckNhc2UoKS5zbGljZSgwLCAxMCk7XG4gIGNvbnN0IGhpZ2hSaXNrU2lncyA9IFsnMHgwOTVlYTdiMycsICcweGEyMmNiNDY1JywgJzB4ZDUwNWFjY2YnLCAnMHg4ZmNiYWYwYyddO1xuICByZXR1cm4gaGlnaFJpc2tTaWdzLmluY2x1ZGVzKHNpZyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREcmFpbmVyUGF0dGVybkJ5U2lnbmF0dXJlKHNpZ25hdHVyZTogc3RyaW5nKTogRHJhaW5lclBhdHRlcm4gfCBudWxsIHtcbiAgcmV0dXJuIERSQUlORVJfUEFUVEVSTlMuZmluZCgocGF0dGVybikgPT4gcGF0dGVybi5zaWduYXR1cmVzLmluY2x1ZGVzKHNpZ25hdHVyZSkpIHx8IG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBdHRhY2tUeXBlRnJvbVBhdHRlcm4ocGF0dGVybklkOiBzdHJpbmcpOiBBdHRhY2tUeXBlIHtcbiAgY29uc3QgbWFwcGluZzogUmVjb3JkPHN0cmluZywgQXR0YWNrVHlwZT4gPSB7XG4gICAgJ3JhcGlkLW91dGZsb3cnOiAnV0FMTEVUX0RSQUlORVInLFxuICAgICdhcHByb3ZhbC1hYnVzZSc6ICdBUFBST1ZBTF9ISUpBQ0snLFxuICAgICdwZXJtaXQtYWJ1c2UnOiAnUEhJU0hJTkdfU0lHTkFUVVJFJyxcbiAgICAnc2V0YXBwcm92YWxmb3JhbGwtYWJ1c2UnOiAnQVBQUk9WQUxfSElKQUNLJyxcbiAgICAndHJhbnNmZXJmcm9tLWRyYWluJzogJ1dBTExFVF9EUkFJTkVSJyxcbiAgfTtcbiAgcmV0dXJuIG1hcHBpbmdbcGF0dGVybklkXSB8fCAnVU5LTk9XTic7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBLTk9XTiBMRUdJVElNQVRFIENPTlRSQUNUUyAoV2hpdGVsaXN0KVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIERvbid0IGZsYWcgdGhlc2UgYXMgc3VzcGljaW91cyAtIHRoZXNlIGFyZSBtYWpvciBEZUZpIHByb3RvY29sc1xuXG5leHBvcnQgY29uc3QgS05PV05fTEVHSVRJTUFURV9DT05UUkFDVFM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gIC8vIFVuaXN3YXBcbiAgJzB4N2EyNTBkNTYzMGI0Y2Y1Mzk3MzlkZjJjNWRhY2I0YzY1OWYyNDg4ZCc6ICdVbmlzd2FwIFYyIFJvdXRlcicsXG4gICcweDY4YjM0NjU4MzNmYjcyYTcwZWNkZjQ4NWUwZTRjN2JkODY2NWZjNDUnOiAnVW5pc3dhcCBWMyBSb3V0ZXInLFxuICAnMHhlZjFjNmU2NzcwM2M3YmQ3MTA3ZWVkODMwM2ZiZTZlYzI1NTRiZjZiJzogJ1VuaXN3YXAgVW5pdmVyc2FsIFJvdXRlcicsXG4gICcweDNmYzkxYTNhZmQ3MDM5NWNkNDk2YzY0N2Q1YTZjYzlkNGIyYjdmYWQnOiAnVW5pc3dhcCBVbml2ZXJzYWwgUm91dGVyIFYyJyxcbiAgJzB4MDAwMDAwMDAwMDIyZDQ3MzAzMGYxMTZkZGVlOWY2YjQzYWM3OGJhMyc6ICdVbmlzd2FwIFBlcm1pdDInLFxuICAnMHhlNTkyNDI3YTBhZWNlOTJkZTNlZGVlMWYxOGUwMTU3YzA1ODYxNTY0JzogJ1VuaXN3YXAgVjMgU3dhcFJvdXRlcicsXG4gIFxuICAvLyBPcGVuU2VhIC8gU2VhcG9ydFxuICAnMHgwMDAwMDAwMDAwMDAwMGFkYzA0YzU2YmYzMGFjOWQzYzBhYWYxNGRjJzogJ09wZW5TZWEgU2VhcG9ydCAxLjEnLFxuICAnMHgwMDAwMDAwMDAwNmMzODUyY2JlZjNlMDhlOGRmMjg5MTY5ZWRlNTgxJzogJ09wZW5TZWEgU2VhcG9ydCAxLjQnLFxuICAnMHgwMDAwMDAwMDAwMDAwMDY4ZjExNmE4OTQ5ODRlMmRiMTEyM2ViMzk1JzogJ09wZW5TZWEgU2VhcG9ydCAxLjUnLFxuICAnMHgwMDAwMDAwMDAwMDAwMWFkNDI4ZTQ5MDZhZTQzZDhmOTg1MmQwZGQ2JzogJ1NlYXBvcnQgMS42JyxcbiAgXG4gIC8vIDB4IFByb3RvY29sXG4gICcweGRlZjFjMGRlZDliZWM3ZjFhMTY3MDgxOTgzMzI0MGYwMjdiMjVlZmYnOiAnMHggRXhjaGFuZ2UgUHJveHknLFxuICAnMHhkZWYxNzFmZTQ4Y2YwMTE1YjFkODBiODhkYzhlYWI1OTE3NmZlZTU3JzogJzB4IEV4Y2hhbmdlIFByb3h5IChQb2x5Z29uKScsXG4gIFxuICAvLyAxaW5jaFxuICAnMHgxMTExMTExMjU0ZWViMjU0NzdiNjhmYjg1ZWQ5MjlmNzNhOTYwNTgyJzogJzFpbmNoIFY1IFJvdXRlcicsXG4gICcweDExMTExMTEyNTQyMWNhNmRjNDUyZDI4OTMxNDI4MGEwZjg4NDJhNjUnOiAnMWluY2ggVjYgUm91dGVyJyxcbiAgJzB4MTExMTExMTI1NGZiNmM0NGJhYzBiZWQyODU0ZTc2ZjkwNjQzMDk3ZCc6ICcxaW5jaCBWNCBSb3V0ZXInLFxuICBcbiAgLy8gQmx1clxuICAnMHgwMDAwMDAwMDAwMDBhZDA1Y2NjNGYxMDA0NTYzMGZiODMwYjk1MTI3JzogJ0JsdXIgTWFya2V0cGxhY2UnLFxuICAnMHgyOTQ2OTM5NWVhZjZmOTU5MjBlNTlmODU4MDQyZjBlMjhkOThhMjBiJzogJ0JsdXIgQmxlbmQnLFxuICAnMHgwMDAwMDAwMDAwYTM5YmIyNzJlNzkwNzVhZGUxMjVmZDM1MTg4N2FjJzogJ0JsdXIgUG9vbCcsXG4gIFxuICAvLyBQYW5jYWtlU3dhcFxuICAnMHgxMGVkNDNjNzE4NzE0ZWI2M2Q1YWE1N2I3OGI1NDcwNGUyNTYwMjRlJzogJ1BhbmNha2VTd2FwIFJvdXRlciBWMicsXG4gICcweDEzZjRlYTgzZDBiZDQwZTc1YzgyMjIyNTViYzg1NWE5NzQ1NjhkZDQnOiAnUGFuY2FrZVN3YXAgUm91dGVyIFYzJyxcbiAgXG4gIC8vIFN1c2hpU3dhcFxuICAnMHhkOWUxY2UxN2YyNjQxZjI0YWU4MzYzN2FiNjZhMmNjYTljMzc4YjlmJzogJ1N1c2hpU3dhcCBSb3V0ZXInLFxuICBcbiAgLy8gQWF2ZVxuICAnMHg3ZDI3NjhkZTMyYjBiODBiN2EzNDU0YzA2YmRhYzk0YTY5ZGRjN2E5JzogJ0FhdmUgVjIgTGVuZGluZyBQb29sJyxcbiAgJzB4ODc4NzBiY2EzZjNmZDYzMzVjM2Y0Y2U4MzkyZDY5MzUwYjRmYTRlMic6ICdBYXZlIFYzIFBvb2wnLFxuICBcbiAgLy8gQ29tcG91bmRcbiAgJzB4M2Q5ODE5MjEwYTMxYjQ5NjFiMzBlZjU0YmUyYWVkNzliOWM5Y2QzYic6ICdDb21wb3VuZCBDb21wdHJvbGxlcicsXG4gIFxuICAvLyBDdXJ2ZVxuICAnMHhiZWJjNDQ3ODJjN2RiMGExYTYwY2I2ZmU5N2QwYjQ4MzAzMmZmMWM3JzogJ0N1cnZlIDNwb29sJyxcbiAgXG4gIC8vIExpZG9cbiAgJzB4YWU3YWI5NjUyMGRlM2ExOGU1ZTExMWI1ZWFhYjA5NTMxMmQ3ZmU4NCc6ICdMaWRvIHN0RVRIJyxcbiAgXG4gIC8vIEVOU1xuICAnMHgyODNhZjBiMjhjNjJjMDkyYzk3MjdmMWVlMDljMDJjYTYyN2ViN2Y1JzogJ0VOUyBSZWdpc3RyYXInLFxuICAnMHg1N2YxODg3YThiZjE5YjE0ZmMwZGY2ZmQ5YjJhY2M5YWYxNDdlYTg1JzogJ0VOUyBCYXNlIFJlZ2lzdHJhcicsXG4gIFxuICAvLyBXRVRIXG4gICcweGMwMmFhYTM5YjIyM2ZlOGQwYTBlNWM0ZjI3ZWFkOTA4M2M3NTZjYzInOiAnV0VUSCcsXG4gIFxuICAvLyBDb21tb24gdG9rZW4gY29udHJhY3RzXG4gICcweGEwYjg2OTkxYzYyMThiMzZjMWQxOWQ0YTJlOWViMGNlMzYwNmViNDgnOiAnVVNEQycsXG4gICcweGRhYzE3Zjk1OGQyZWU1MjNhMjIwNjIwNjk5NDU5N2MxM2Q4MzFlYzcnOiAnVVNEVCcsXG4gICcweDZiMTc1NDc0ZTg5MDk0YzQ0ZGE5OGI5NTRlZWRlYWM0OTUyNzFkMGYnOiAnREFJJyxcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0xlZ2l0aW1hdGVDb250cmFjdChhZGRyZXNzOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgY29uc3Qgbm9ybWFsaXplZEFkZHJlc3MgPSBhZGRyZXNzLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGxlZ2l0aW1hdGVBZGRyZXNzID0gT2JqZWN0LmtleXMoS05PV05fTEVHSVRJTUFURV9DT05UUkFDVFMpLmZpbmQoXG4gICAgKGFkZHIpID0+IGFkZHIudG9Mb3dlckNhc2UoKSA9PT0gbm9ybWFsaXplZEFkZHJlc3NcbiAgKTtcbiAgcmV0dXJuIGxlZ2l0aW1hdGVBZGRyZXNzID8gS05PV05fTEVHSVRJTUFURV9DT05UUkFDVFNbbGVnaXRpbWF0ZUFkZHJlc3NdIDogbnVsbDtcbn1cbiJdLCJuYW1lcyI6WyJpc0tub3duRHJhaW5lciIsImdldERyYWluZXJUeXBlIiwiS05PV05fTUFMSUNJT1VTX0NPTlRSQUNUUyIsImFkZHJlc3MiLCJjaGFpbiIsInR5cGUiLCJuYW1lIiwicmVwb3J0ZWRBdCIsImNvbmZpcm1hdGlvbkxldmVsIiwiYWZmZWN0ZWRVc2VycyIsIktOT1dOX0RSQUlORVJfUkVDSVBJRU5UUyIsIkRSQUlORVJfRlVOQ1RJT05fU0lHTkFUVVJFUyIsIlNVU1BJQ0lPVVNfTUVUSE9EX05BTUVTIiwiSU5GSU5JVEVfQVBQUk9WQUxfVEhSRVNIT0xEIiwiQmlnSW50IiwiRFJBSU5FUl9QQVRURVJOUyIsImlkIiwic2lnbmF0dXJlcyIsImJlaGF2aW9yUGF0dGVybnMiLCJkZXNjcmlwdGlvbiIsInRocmVzaG9sZCIsInRpbWVXaW5kb3dNaW51dGVzIiwiU09MQU5BX01BTElDSU9VU19QUk9HUkFNUyIsIkhJR0hfUklTS19DT05UUkFDVF9QQVRURVJOUyIsIkJMQU5LRVRfTkZUX0FQUFJPVkFMIiwic2lnbmF0dXJlIiwicmlza0xldmVsIiwiVU5MSU1JVEVEX1RPS0VOX0FQUFJPVkFMIiwiUEVSTUlUX1NJR05BVFVSRSIsIkNIQUlOX1JQQ19DT05GSUciLCJldGhlcmV1bSIsInJwY1VybHMiLCJleHBsb3JlckFwaSIsImV4cGxvcmVyVXJsIiwibmF0aXZlU3ltYm9sIiwiYmFzZSIsImJuYiIsInNvbGFuYSIsImlzTWFsaWNpb3VzQWRkcmVzcyIsIm5vcm1hbGl6ZWRBZGRyZXNzIiwidG9Mb3dlckNhc2UiLCJrbm93bk1hbGljaW91cyIsImZpbmQiLCJjb250cmFjdCIsImRyYWluZXJUeXBlIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiaXNEcmFpbmVyUmVjaXBpZW50Iiwic29tZSIsInJlY2lwaWVudCIsImlzSW5maW5pdGVBcHByb3ZhbCIsImFtb3VudCIsImFtb3VudEJpZ0ludCIsImlzRHJhaW5lck1ldGhvZFNpZ25hdHVyZSIsIm1ldGhvZElkIiwic2lnIiwic2xpY2UiLCJPYmplY3QiLCJrZXlzIiwiaW5jbHVkZXMiLCJpc0hpZ2hSaXNrTWV0aG9kIiwiaGlnaFJpc2tTaWdzIiwiZ2V0RHJhaW5lclBhdHRlcm5CeVNpZ25hdHVyZSIsInBhdHRlcm4iLCJnZXRBdHRhY2tUeXBlRnJvbVBhdHRlcm4iLCJwYXR0ZXJuSWQiLCJtYXBwaW5nIiwiS05PV05fTEVHSVRJTUFURV9DT05UUkFDVFMiLCJpc0xlZ2l0aW1hdGVDb250cmFjdCIsImxlZ2l0aW1hdGVBZGRyZXNzIiwiYWRkciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/detection/malicious-database.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/ethers","vendor-chunks/@noble","vendor-chunks/uuid","vendor-chunks/ws","vendor-chunks/whatwg-url","vendor-chunks/@solana","vendor-chunks/utf-8-validate","vendor-chunks/tr46","vendor-chunks/node-gyp-build","vendor-chunks/jayson","vendor-chunks/eventemitter3","vendor-chunks/bufferutil","vendor-chunks/superstruct","vendor-chunks/rpc-websockets","vendor-chunks/node-fetch","vendor-chunks/@adraffy","vendor-chunks/webidl-conversions","vendor-chunks/text-encoding-utf-8","vendor-chunks/safe-buffer","vendor-chunks/bs58","vendor-chunks/borsh","vendor-chunks/bn.js","vendor-chunks/base-x"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5Cmercy%5CTOOL%5Cwallet-sentinel%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmercy%5CTOOL%5Cwallet-sentinel&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();